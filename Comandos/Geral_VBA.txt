https://www.youtube.com/watch?v=SOxafinthys
Configurar o git

https://github.com/Rocketseat/expo-common-issues/issues/14
para entrar na virtualenv do windos:
executar o Powershell do Windows como administrador e digita 
Set-ExecutionPolicy RemoteSigned depois S



=ÍNDICE(A:A;CORRESP(J1;B:B;0))

=ÍNDICE(A:A;1) Substituir o número por corresp, que tme o número da linha procurada - AA coluna vai ser retornada
=CORRESP(J1;B:B;0) J coluna dos ítens que precisa ser encontrado e B matriz onde procurar, 0 pra vir valores exatos = isso retornará o número da linha

=ÍNDICE(MARCA!A:A;CORRESP(C2;MARCA!B:B;0))


https://bestaliproducts.com/pt/top-5-airpod-replicas-aliexpress/
Fones


Application.ScreenUpdating = False


'================================Function
Function cpf_cnpj(cpf As String)
    
    If Len(cpf) = 12 Then
    
        L_cpf = Left(cpf, 3)
        C_cpf = Left(Right(cpf, 8), 3)
        R_cpf = Left(Right(cpf, 5), 3)
        dig_cpf = Right(cpf, 2)
        
        cpf_cnpj = L_cpf & "." & C_cpf & "." & R_cpf & "-" & dig_cpf
        
    Else
    
        L_cpf = Left(cpf, 2)
        C_cpf = Left(Right(cpf, 12), 3)
        M_cpf = Left(Right(cpf, 9), 3)
        R_cpf = Left(Right(cpf, 6), 4)
        dig_cpf = Right(cpf, 2)
    
        cpf_cnpj = L_cpf & "." & C_cpf & "." & M_cpf & "/" & R_cpf & "-" & dig_cpf
        
    End If


End Function

Function cel_tel(cel As String)

        L_cel = Left(cel, 2)
        
        If Len(cel) = 10 Then
            C_cel = Left(Right(cel, 9), 4)
        Else
            C_cel = Left(Right(cel, 9), 5)
        End If
        
        dig_cel = Right(cel, 4)
    
        cel_tel = "(" & L_cel & ") " & C_cel & "-" & dig_cel

End Function


'============================
Sub Filter()

Dim list_filter As Variant
list_filter = Array("")

    Sheets("FILTER").Select
    
    last = Range("A" & Rows.Count).End(xlUp).Row
    
    cont = 0
    For i = 2 To last
        ReDim Preserve list_filter(cont)
        list_filter(cont) = Cells(i, 1).Value
        cont = cont + 1
    Next i
    
    For j = 0 To UBound(list_filter)
    
        Debug.Print list_filter(j)
    
    Next j
            
End Sub


'================================
#input VBS

diretorio = Application.InputBox(prompt:="Inserir diretório onde será impresso os templates")



' ###### Inserir linha
Sub test()
Dim j As Long, r As Range
j = InputBox("digite o número de linhas a ser inserido")

Set r = Range("A2")
Do
    Range(r.Offset(1, 0), r.Offset(j, 0)).EntireRow.Insert
    Set r = Cells(r.Row + j + 1, 1)
    'MsgBox r.Address(o apóstrofo no início desta linha torna esta linha inoperável)
    If r.Offset(1, 0) = "" Then Exit Do
Loop



'================ Email
Sub Emails_Outlook()
'Carregar e-mails do outlook para o excel
Dim appOutlook As Object
Dim olNS As Object
Dim olFolder As Object
Dim olItem As Object
Dim r As Long
On Error Resume Next
Set appOutlook = GetObject(, "Outlook.Application")
If appOutlook Is Nothing Then
Set appOutlook = CreateObject("Outlook.Application")
End If
On Error GoTo 0
Set olNS = appOutlook.GetNamespace("MAPI")
'Abaixo preencha o nome do arquivo de dados PST e a pasta.
'Neste caso o arquivo é Douglas Godoy e a pasta Caixa de Entrada.
Set olFolder = olNS.Folders("alexsandro.oliveira@icnavais.com").Folders("SIECC")
Cells.Delete
r = 3
'Cria um array montando o título das colunas no arquivo.
Range("A3:K3") = Array("Título", "Quem enviou", "Para", "Data e Hora", "Anexos", "Tamanho","Última modificação","Categoria","Nome do Remetente","Tipo de acompanhamento","Conteúdo")
For Each olItem In olFolder.Items
If TypeName(olItem) = "MailItem" Then
r = r + 1
Cells(r, "A") = olItem.Subject 'Assunto do e-mail
Cells(r, "B") = olItem.SenderEmailAddress 'E-mail do remetente
Cells(r, "C") = olItem.To 'E-mail do destinatário
Cells(r, "D") = olItem.ReceivedTime 'Data/Hora de recebimento
Cells(r, "E") = olItem.Attachments.Count 'Número de anexos
Cells(r, "F") = olItem.Size 'Tamanho da mensagem em bytes
Cells(r, "G") = olItem.LastModificationTime 'Última modificação
Cells(r, "H") = olItem.Categories 'Categoria
Cells(r, "I") = olItem.SenderName 'Nome do remetente
Cells(r, "J") = olItem.FlagRequest 'Acompanhamento
'Cells(r, "K") = olItem.Body 'Tome cuidado ao utilizar pois carrega os dados do corpo do email
Application.StatusBar = r
End If
Next olItem
Columns.AutoFit
End Sub

'================

#-------------------------
Gerar PDF


Sub listar_arquivos_e_pastas()

Application.ScreenUpdating = False
Application.StatusBar = "Expelliarmus..."

    Dim fso As Object
    Dim folder As Object
    Dim file As Object
    Dim linha As Integer
    
    Dim listaPasta As Variant
    Dim listaArq As Variant
    
    listaPasta = Array("")

    Set fso = CreateObject("Scripting.FileSystemObject")
    Set folder = fso.GetFolder(ThisWorkbook.path & "\")
    
    cont = 0
    
    For Each file In folder.SubFolders
        ReDim Preserve listaPasta(cont)
        listaPasta(UBound(listaPasta)) = file.Name
        cont = cont + 1
    Next file
    
    For Each filess In folder.Files
        
            FileTest = Right(filess, 3)
            
            If FileTest = "lsm" Or FileTest = "pdf" Then
                Debug.Print

            ElseIf FileTest = "xls" Then
                
                NewFile = Left(filess, Len(filess) - 3)
                
                ChDir folder & "\"
                
                Workbooks.Open Filename:= _
                filess _
                , ReadOnly:=False, Notify:=False, IgnoreReadOnlyRecommended:=True
                
                ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _
                    NewFile & "pdf", Quality:= _
                    xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, _
                    OpenAfterPublish:=False
                ActiveWorkbook.Save
                ActiveWindow.Close
                
            Else
            
                NewFile = Left(filess, Len(filess) - 4)
                
                ChDir folder & "\"
                
                Workbooks.Open Filename:= _
                filess _
                , ReadOnly:=False, Notify:=False, IgnoreReadOnlyRecommended:=True
                
                ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _
                    NewFile & "pdf", Quality:= _
                    xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, _
                    OpenAfterPublish:=False
                ActiveWorkbook.Save
                ActiveWindow.Close
            
            End If

        Next filess

    
    For i = 0 To UBound(listaPasta)
        Set folder = fso.GetFolder(ThisWorkbook.path & "\" & listaPasta(i) & "\")
        For Each file In folder.Files
        
            FileTest = Right(file, 3)

            If FileTest = "lsm" Or FileTest = "pdf" Then
                Debug.Print
                
            ElseIf FileTest = "xls" Or FileTest = "pdf" Then
                
                NewFile = Left(file, Len(file) - 3)
                
                ChDir folder & "\"
                
                Workbooks.Open Filename:= _
                file _
                , ReadOnly:=False, Notify:=False, IgnoreReadOnlyRecommended:=True
                
                ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _
                    NewFile & "pdf", Quality:= _
                    xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, _
                    OpenAfterPublish:=False
                ActiveWorkbook.Save
                ActiveWindow.Close
                
            Else
            
                NewFile = Left(file, Len(file) - 4)
                
                ChDir folder & "\"
                
                Workbooks.Open Filename:= _
                file _
                , ReadOnly:=False, Notify:=False, IgnoreReadOnlyRecommended:=True
                
                ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _
                    NewFile & "pdf", Quality:= _
                    xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, _
                    OpenAfterPublish:=False
                ActiveWorkbook.Save
                ActiveWindow.Close
            
            End If

        Next file
        
    Next i


    MsgBox "PDFs, Criados com Sucesso!"

     
Application.ScreenUpdating = True
Application.StatusBar = Date & "- Qualquer problema com a execução dessa macro entre em contato com o desenvolvedor"
    
End Sub

ICN - Access
https://app.icnavais.com/Citrix/ExternoWeb/


#telas

Private Sub CommandButton2_Click()
    ThisWorkbook.Save
    UserForm1.Hide
    UserForm2.Show
    
End Sub

'BLOQUEAR USERFORM
Sub UserForm_QueryClose _
   (Cancel As Integer, CloseMode As Integer)
   If CloseMode = vbFormControlMenu Then
        MsgBox "Aperte [SAIR] para que a planilha seja fechada corretamente.", vbCritical, "AVISO"
        Cancel = True
   End If
End Sub

Private Sub CommandButton1_Click()

    Call listar_arquivos_e_pastas

End Sub



#senha

Private Sub CommandButton1_Click()

    If TextBox1.Value = "adminadmin" Then
        'Application.Visible = True 'Oculta a planilha
        UserForm2.Hide
        UserForm1.Hide

    End If

End Sub

Private Sub CommandButton2_Click()

    ThisWorkbook.Save
    Windows("GerarPDF.xlsm").Activate
    ThisWorkbook.Close

End Sub





#Linha coluna
 ActiveSheet.Range(Cells(lin, col), Cells(quant, col + 2)).Select





#----------------------------------
PDF Multiplas páginas


Public FSO As New FileSystemObject
Sub BTO()

Dim SourceXLS, SourcePDF, LL As String
Dim Wb As Workbook
Dim Count1, Lin, Col As Integer
Dim WS_Count As Integer
Dim i As Integer
Dim lista As Variant

lista = Array("")
NOTAS = False
APPENDIX_1 = False
APPENDIX_2 = False
APPENDIX_3 = False
APPENDIX_4 = False
APPENDIX_5 = False
            
'----------------------------------------------------
last = 
LL = Range("A" & Rows.Count).End(xlUp).Row


Application.DisplayAlerts = False

            Range("I2").Select
            Lin = ActiveCell.Row
            Col = ActiveCell.Column
            Cells(Lin, Col).Select
            
            XX = Cells(Lin, Col)
            Debug.Print XX
            path_ = Len(XX)
            
            Debug.Print path_
            
Col = 1

For Lin = 2 To LL Step 1
    SourceXLS = Range("I2") & "\" & Cells(Lin, Col).Value
    SourcePDF = Range("I2") & "\" & Cells(Lin, Col + 2).Value
    doc_ = Cells(Lin, Col).Value
    documento_ = Left(doc_, Len(doc_) - 5)
    xtension = Right(doc_, 4)
    path_ = Range("I2")
    
    Set Wb = Workbooks.Open(SourceXLS)
    
Debug.Print SourceXLS
    
    '----------------------------------------------------
         WS_Count = ActiveWorkbook.Worksheets.Count

         For i = 1 To WS_Count

            ReDim Preserve lista(i - 1)
            lista(i - 1) = ActiveWorkbook.Worksheets(i).Name

            Next i
            
            cont = 0
            For A = 0 To UBound(lista)
            
                If lista(A) = "NOTAS" Then
                
                    NOTAS = True
                
                End If
                
                If lista(A) = "APPENDIX_1" Then
                
                    APPENDIX_1 = True
                
                End If
                
                If lista(A) = "APPENDIX_2" Then
                
                    APPENDIX_2 = True
                
                End If
                
                If lista(A) = "APPENDIX_3" Then
                
                    APPENDIX_3 = True
                
                End If
                
                If lista(A) = "APPENDIX_4" Then
                
                    APPENDIX_4 = True
                
                End If
                
                If lista(A) = "APPENDIX_5" Then
                
                    APPENDIX_5 = True
                
                End If
                
                If lista(A) = "APPENDIX_5" Then
                
                    APPENDIX_5 = True
                
                End If
   
                Debug.Print lista(A)
                cont = cont + 1

            Next A
    
   '----------------------------------------------------
   
   Debug.Print NOTAS

    If APPENDIX_1 = True And NOTAS = False Then
        Windows(documento_ & "." & xtension).Activate
        Sheets(Array("CAPA", "APPENDIX_1")).Select
    End If
    
    If APPENDIX_2 = True And NOTAS = False Then
        Windows(documento_ & "." & xtension).Activate
        Sheets(Array("CAPA", "APPENDIX_1", "APPENDIX_2")).Select
    End If
    
    If APPENDIX_3 = True And NOTAS = False Then
        Windows(documento_ & "." & xtension).Activate
        Sheets(Array("CAPA", "APPENDIX_1", "APPENDIX_2", "APPENDIX_3")).Select
    End If

    If APPENDIX_4 = True And NOTAS = False Then
        Windows(documento_ & "." & xtension).Activate
        Sheets(Array("CAPA", "APPENDIX_1", "APPENDIX_2", "APPENDIX_3", "APPENDIX_4")).Select
    End If
    
    If APPENDIX_5 = True And NOTAS = False Then
        Windows(documento_ & "." & xtension).Activate
        Sheets(Array("CAPA", "APPENDIX_1", "APPENDIX_2", "APPENDIX_3", "APPENDIX_4", "APPENDIX_5")).Select
    End If
    
    If APPENDIX_1 = True And NOTAS = True Then
        Windows(documento_ & "." & xtension).Activate
        Sheets(Array("CAPA", "NOTAS", "APPENDIX_1")).Select
    End If
    
    If APPENDIX_2 = True And NOTAS = True Then
        Windows(documento_ & "." & xtension).Activate
        Sheets(Array("CAPA", "NOTAS", "APPENDIX_1", "APPENDIX_2")).Select
    End If
    
    If APPENDIX_3 = True And NOTAS = True Then
        Windows(documento_ & "." & xtension).Activate
        Sheets(Array("CAPA", "NOTAS", "APPENDIX_1", "APPENDIX_2", "APPENDIX_3")).Select
    End If

    If APPENDIX_4 = True And NOTAS = True Then
        Windows(documento_ & "." & xtension).Activate
        Sheets(Array("CAPA", "NOTAS", "APPENDIX_1", "APPENDIX_2", "APPENDIX_3", "APPENDIX_4")).Select
    End If
    
    If APPENDIX_5 = True And NOTAS = True Then
        Windows(documento_ & "." & xtension).Activate
        Sheets(Array("CAPA", "NOTAS", "APPENDIX_1", "APPENDIX_2", "APPENDIX_3", "APPENDIX_4", "APPENDIX_5")).Select
    End If

        Sheets("CAPA").Activate
        ChDir _
            path_
            Debug.Print SourcePDF
        ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _
            SourcePDF _
            , Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _
            :=False, OpenAfterPublish:=False
        Range("A1").Select

        Windows("GerarPDFs_Multiplas_Paginas.xlsm").Activate
        
   
    Workbooks(Wb.Name).Close
    
    NOTAS = False
    APPENDIX_1 = False
    APPENDIX_2 = False
    APPENDIX_3 = False
    APPENDIX_4 = False
    APPENDIX_5 = False

Next Lin

MsgBox "Mal feito, feito!"

Application.DisplayAlerts = True

End Sub

'=======================================


Sub WorksheetLoop()

         Dim WS_Count As Integer
         Dim i As Integer
         Dim lista As Variant
         
         lista = Array("")

         WS_Count = ActiveWorkbook.Worksheets.Count

         For i = 1 To WS_Count
            Debug.Print ActiveWorkbook.Worksheets(i).Name

            ReDim Preserve lista(i - 1)
            lista(i - 1) = ActiveWorkbook.Worksheets(i).Name

            Next i

             For A = 0 To UBound(lista)

                Debug.Print lista(A)

            Next A
           
End Sub



#--------------------------------------
#Chama funções
Sub Chamar()

UserForm1.Show

End Sub

#----- Inciar macro
Private Sub Workbook_Open()

Call listagem

End Sub



#Fechar Userform
Unload 'userform'


#listbox
'Mostrar Userform
Sub ExibeFormulario()
   UserForm1.Show
End Sub

Private Sub UserForm_Initialize()
    ComboBox1.AddItem "Alexsandro M. Oliveira"
    ComboBox1.AddItem "Alberto S.Santos"
    ComboBox1.AddItem "Gabriel O. Azevedo"
    ComboBox1.AddItem "Luis A. da F. Franca"
    ComboBox1.AddItem "Melrilin V. P. Bastos"
    ComboBox1.AddItem "Paulo E. F. Madeira"
    ComboBox1.AddItem "Rodrigo R. Rosa"
    ComboBox1.AddItem "Tais D. de Assis"
End Sub

#---
Salavar e fechar planilhas
    ActiveWorkbook.Save
ThisWorkbook.Application.Quit

#---
Private Sub CommandButton1_Click()
    Sheets("Name_User").Select
    Range("A1").Select
    ActiveCell.FormulaR1C1 = ComboBox1
   
    UserForm1.Hide 'Esconder userform
End Sub

#--------------------------------------


##Comandos .bat
C:\User\Desktop\ dir /b /o /s /w >>nome_arquivo.txt


identificar diretório/;
PathOnly = Left(FilePath, Len(FilePath) - Len(FileOnly))



Sub ExtractLastValue()

Set objIE = CreateObject("InternetExplorer.Application")

objIE.Top = 0
objIE.Left = 0
objIE.Width = 800
objIE.Height = 600

objIE.Visible = True

objIE.navigate ("https://uk.investing.com/rates-bonds/financial-futures/")

Do
DoEvents
Loop Until objIE.readystate = 4

MsgBox objIE.document.getElementsByClassName("pid-8907-last")(0).innerText

End Sub


Sub get_data_web()

Dim appIE As Object
Set appIE = CreateObject("internetexplorer.application")

With appIE
    .navigate "https://finance.yahoo.com/quote/NQ%3DF/futures?p=NQ%3DF"
    .Visible = True
End With

Do While appIE.Busy
    DoEvents
Loop

Set allRowofData = appIE.document.getElementsByClassName("Ta(end) BdT Bdc($c-fuji-grey-c) H(36px)")

Dim i As Long
Dim myValue As String

Count = 1

    For Each itm In allRowofData

        For i = 0 To 4

        myValue = itm.Cells(i).innerText
        ActiveSheet.Cells(Count, i + 1).Value = myValue

        Next

        Count = Count + 1

    Next

appIE.Quit
Set appIE = Nothing


End Sub

'==================== Filtro

Sub filtro()

lin = ActiveCell.Row
col = ActiveCell.Column

Selection.End(xlDown).Select
cont = ActiveCell.Row

Range(Cells(lin, col), Cells(lin, col)).Select

    ActiveSheet.Range(Cells(lin, col), Cells(lin, cont)).AutoFilter Field:=col, Criteria1:=Array( _
        "AAA", "BBB", "CCC" _
        ), Operator:=xlFilterValues
        
End Sub

'=========================================================== Add traço - --
Sub alinha()

cont = Range("A" & Rows.Count).End(xlUp).Row

For i = 1 To cont

    Var = Range("A" & i & "").Value

    If Var = "" Then
        Range("A" & i & "") = "-"
    End If

Next i

'===========================================================

#====================== Libera comandos da tela
Sub lsLigarTelaCheia()
    'Oculta todas as guias de menu
    Application.ExecuteExcel4Macro "SHOW.TOOLBAR(""Ribbon"",False)"
    
    'Ocultar barra de fórmulas
    Application.DisplayFormulaBar = False
    
    'Ocultar barra de status, disposta ao final da planilha
    Application.DisplayStatusBar = False
    
    'Alterar o nome do Excel
    Application.Caption = "Controle de manutenção de veículos 3.0"
    
    With ActiveWindow
        'Ocultar barra horizontal
        .DisplayHorizontalScrollBar = False
        
        'Ocultar barra vertical
        .DisplayVerticalScrollBar = False
        
        'Ocultar guias das planilhas
        .DisplayWorkbookTabs = False
        
        'Oculta os títulos de linha e coluna
        .DisplayHeadings = False
        
        'Oculta valores zero na planilha
        .DisplayZeros = False
        
        'Oculta as linhas de grade da planilha
        .DisplayGridlines = False
    End With
    
    'Call AjusteTela
    
End Sub

Sub lsDesligarTelaCheia()
    'Reexibe os menus
    Application.ExecuteExcel4Macro "SHOW.TOOLBAR(""Ribbon"",True)"
    
    'Reexibir a barra de fórmulas
    Application.DisplayFormulaBar = True
    
    'Reexibir a barra de status, disposta ao final da planilha
    Application.DisplayStatusBar = True
    
    'Reexibir o cabeçalho da Pasta de trabalho
    ActiveWindow.DisplayHeadings = True
    
    'Retornar o nome do Excel
    Application.Caption = ""
    
    With ActiveWindow
        'Reexibir barra horizontal
        .DisplayHorizontalScrollBar = True
        
        'Reexibir barra vertical
        .DisplayVerticalScrollBar = True
        
        'Reexibir guias das planilhas
        .DisplayWorkbookTabs = True
        
        'Reexibir os títulos de linha e coluna
        .DisplayHeadings = True
        
        'Reexibir valores zero na planilha
        .DisplayZeros = True
        
        'Reexibir as linhas de grade da planilha
        .DisplayGridlines = True
    End With
  
End Sub

#=======================
Sub procv()

cont = Range("A" & Rows.Count).End(xlUp).Row

For a = 1 To cont
    Range("B" & a & "") = Application.VLookup(Range("A" & a & ""), Sheets("Planilha2").Range("A1:A24"), 1, 0)
    test = Range("B" & a & "").Value
    
    If VarType(test) <> 10 Then '10 = Erro | 8 = válido
        Range("C" & a & "") = "ok"
    End If
    
Next a

End Sub
#=======================

Sub lerabas()

WS_Count = ActiveWorkbook.Worksheets.Count

    For i = 1 To WS_Count
    
        Debug.Print ActiveWorkbook.Worksheets(i).Name
    
    Next i


End Sub


WEB SCRAP - acessar sites
'---------------------------------------------------

Sub AcssoSites()
    Dim ie As InternetExplorer
    Dim C
    Dim UIdent As Boolean, ieForm
    Dim MyIdent As String
redo:
    MyIdent = Application.InputBox("Por Favor entre com o código identificador", "2º VIA COPASA", Default:="123456789", Type:=2)
    
    If MyIdent = "" Then GoTo redo
    Set ie = New InternetExplorer
    ie.Visible = True
    'ie.navigate "http://www2.copasa.com.br/servicos/2avia2/msginicial.asp"
    'ie.navigate "http://udc0-sis02:8080/CadernoDeConstrucao/jsf/operacional/caderno/configurarCadernos.xhtml"
    'ie.navigate "http://udc0-sis04/CadernoDeConstrucao/login/login.xhtml"
    ie.navigate "http://udc0-sis02:8080/CadernoDeConstrucao/login/login.xhtml"
    

    Do Until ie.readyState = READYSTATE_COMPLETE
    Loop
 
    ie.Document.all("form_:usuario:inp_usuario_txt").innerText = "alexsandro.oliveira"
    ie.Document.all("form_:senha:inp_senha").innerText = MyIdent
    'ie.Document.all("visor").innerText = MyIdent
    'obtém o forma a qual o código identiicador pertence para submetê-lo
    ie.Document.all("form_:btn_login").form.all("form_:btn_login").Click
 
    'If UIdent = False Then MsgBox "Código Encontrado"
    
    ie.navigate "http://udc0-sis02:8080/CadernoDeConstrucao/jsf/operacional/caderno/configurarCadernos.xhtml"
    
    Do Until ie.readyState = READYSTATE_COMPLETE
    Loop

    ie.Document.all("form_:j_idt74").form.all("form_:j_idt74").Click

    Set ie = Nothing
 
End Sub

'==================================
Array VBA

Sub analise()

Dim lista As Variant
lista = Array("")

Sheets("Principal").Select

Position = Range("C" & Rows.Count).End(xlUp).Row

cont = 0
For i = 2 To Position
    Item = Range("C" & i & "").Value
    
    If Right(Item, 4) = ".pdf" Or Right(Item, 4) = ".PDF" Then
        ReDim Preserve lista(cont)
        lista(UBound(lista)) = Item
        
        cont = cont + 1
    End If

Next i

Sheets("List").Select
Range("B3").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.ClearContents
    

For j = 0 To UBound(lista)
    Range("B" & j + 3 & "") = lista(j)
Next j

Range("B1").Select

End Sub


Sub comparadocs()

Dim EnviarPara As String
Dim Mensagem As String
Dim lista, lido, lido_rev As Variant
Dim A As Variant, B As Long, z As Long

lista = Array("SMB-200945", "SMB-330521", "SMB-351402")
lista_rev = Array("H", "M", "A")
lido = Array("")
lido_rev = Array("")

Sheets("List").Select

qt = Range("B" & Rows.Count).End(xlUp).Row

'ReDim Preserve lido(0)
cont = 0
For i = 0 To qt - 3
    nome = Range("B" & i + 3 & "").Value
    search_ = Left(nome, Len(nome) - 6)
    r = Right(nome, 5)
    rev = Left(r, 1)
    
    ReDim Preserve lido(cont)
    ReDim Preserve lido_rev(cont)
    lido(cont) = search_
    lido_rev(cont) = rev

    cont = cont + 1
Next i

For j = 0 To UBound(lido)
    For k = 0 To UBound(lista)
        If lista(k) = lido(j) And lista_rev(k) <> lido_rev(j) Then
            Debug.Print "Alterada Revisão: " & lido(j) & "_" & lido_rev(j) & " | " & lista(k) & "_" & lista_rev(k)
        
            EnviarPara = "alexsandro.oliveira@icnavais.com"
            Mensagem = "Alterada Revisão: " & lido(j) & "_" & lido_rev(j) & " | " & lista(k) & "_" & lista_rev(k)
        
            Call Envia_Emails(EnviarPara, Mensagem)
            
        End If
    Next k
Next j

End Sub

'=======================================================

Sub AcessoWeb()
    Dim ie As InternetExplorer
    Dim C
    Dim UIdent As Boolean, ieForm
    Dim MyIdent As String
redo:
    MyIdent = Application.InputBox("Por Favor entre com o código identificador", "2º VIA COPASA", Default:="123456789", Type:=2)
    
    If MyIdent = "" Then GoTo redo
    Set ie = New InternetExplorer
    ie.Visible = True
    'ie.navigate "http://www2.copasa.com.br/servicos/2avia2/msginicial.asp"
    'ie.navigate "http://udc0-sis02:8080/CadernoDeConstrucao/jsf/operacional/caderno/configurarCadernos.xhtml"
    'ie.navigate "http://udc0-sis04/CadernoDeConstrucao/login/login.xhtml"
    ie.navigate "http://udc0-sis02:8080/CadernoDeConstrucao/login/login.xhtml"
    

    Do Until ie.readyState = READYSTATE_COMPLETE
    Loop
 
    ie.Document.all("form_:usuario:inp_usuario_txt").innerText = "alexsandro.oliveira"
    ie.Document.all("form_:senha:inp_senha").innerText = MyIdent
    ie.Document.all("form_:btn_login").form.all("form_:btn_login").Click
 
    'If UIdent = False Then MsgBox "Código Encontrado"
    
    ie.navigate "http://udc0-sis02:8080/CadernoDeConstrucao/jsf/operacional/caderno/configurarCadernos.xhtml"
    
    Do Until ie.readyState = READYSTATE_COMPLETE
    Loop

    Set ie = Nothing
    
End Sub

=======================
Pesquisar

Sub testes()

    Windows("New (1).xlsx").Activate
    Sheets("TESTE").Select
    
    Range("D1").Select
    
    cont = Range("D" & Rows.Count).End(xlUp).Row
    
    For i = 0 To cont - 1
        Windows("New (1).xlsx").Activate
        Sheets("TESTE").Select
    
        ActiveCell.Offset(1, 0).Select
        
        lin = ActiveCell.Row
        col = ActiveCell.Column
        Cells(lin, col).Select
        
        Var = Cells(lin, col)
        
        ActiveCell.Offset(0, 1).Select

        Windows("EQUIPAMENTOS_SENS.xlsx").Activate
        Sheets("EQUIPS").Select
    
        Cells.Find(What:=Var, After:=ActiveCell, LookIn:=xlFormulas, _
            LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
            MatchCase:=False, SearchFormat:=False).Activate
            
            
        ActiveCell.Offset(0, -2).Select
        
        lin = ActiveCell.Row
        col = ActiveCell.Column
        Cells(lin, col).Select
        
        Copy_Var = Cells(lin, col)
        
        Windows("New (1).xlsx").Activate
        Sheets("TESTE").Select
        
        ActiveCell.FormulaR1C1 = Copy_Var
        ActiveCell.Offset(0, -1).Select

    Next i


End Sub

===================================
'rida/rai/pr
Sub rai()

Application.ScreenUpdating = False

Dim arrItem() As String
Dim newArrItem() As String
Dim dados As String


Sheets("Trata").Select
    Range("B6").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.ClearContents
    
    Range("D2").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.ClearContents

Range("B2").Select

lin = ActiveCell.Row
col = ActiveCell.Column
Cells(lin, col).Select

dados = Cells(lin, col)

arrItem = Split(dados, " ")
ActiveCell.Offset(4, 0).Select
newArrItem = Split(dados, " ")

For i = 0 To UBound(arrItem)

    ActiveCell.FormulaR1C1 = arrItem(i)
    ActiveCell.Offset(1, 0).Select
    
    teste1 = Left(arrItem(i), 1)
    teste2 = Left(arrItem(i), 2)
    teste3 = Left(arrItem(i), 3)
    teste4 = Left(arrItem(i), 4)
    
    If teste1 = "P" Then
        ActiveCell.Offset(0, 2).Select
        ActiveCell.FormulaR1C1 = arrItem(i)
        ActiveCell.Offset(0, -2).Select
        
    ElseIf teste3 = "(P" Then
        ActiveCell.Offset(0, 2).Select
        ActiveCell.FormulaR1C1 = arrItem(i)
        ActiveCell.Offset(0, -2).Select

    ElseIf teste3 = "CTE" Then
        ActiveCell.Offset(0, 2).Select
        ActiveCell.FormulaR1C1 = arrItem(i)
        ActiveCell.Offset(0, -2).Select
        
    ElseIf teste3 = "SMB" Then
        ActiveCell.Offset(0, 2).Select
        ActiveCell.FormulaR1C1 = arrItem(i)
        ActiveCell.Offset(0, -2).Select
        
    ElseIf teste4 = "(CTE" Then
        ActiveCell.Offset(0, 2).Select
        ActiveCell.FormulaR1C1 = arrItem(i)
        ActiveCell.Offset(0, -2).Select
          
    End If
    
Next i

cont = Range("B" & Rows.Count).End(xlUp).Row

    ActiveSheet.Range("$D$1:$D$" & cont & "").RemoveDuplicates Columns:=1, Header:=xlNo
    Range("B2").Select

Application.ScreenUpdating = True

End Sub

=========================
Sub OpenUp(ConferePasta, pasta)

Debug.Print (ConferePasta)
 Workbooks.Open (ConferePasta)
End Sub


Sub CriaIndividualTemplate(ConferePasta, diretorio, INSP_Avalible, SBR, pasta, directory, IM_pasta)

        'testar se diretório existe
        If Dir(ConferePasta, vbDirectory) = "" Then

            MkDir ConferePasta

        End If
        
        
        If Dir(ConferePasta & pasta, vbDirectory) = "" Then
     
            MkDir ConferePasta & "\" & pasta
        
        End If

        Set ws = Application.Workbooks.Add
        ActiveWorkbook.SaveAs Filename:= _
        ConferePasta & "\" & pasta & "\" & SBR & "_" & INSP_Avalible & ".xlsx", _
        ReadOnlyRecommended:=False, CreateBackup:=False
  
End Sub


Sub FechaTemplate(SBR, INSP_Avalible, pasta)

'Call imprimir(pasta)

    Windows(SBR & "_" & INSP_Avalible & ".xlsx").Activate
    
    Call imprimir(pasta)
    
        Sheets("Planilha1").Select
        Range("A1").Select
        ActiveWorkbook.Save
        ActiveWindow.Close
            
End Sub

#====================
Templates MS0

Sub GeraTemplate()

Application.ScreenUpdating = False
Application.StatusBar = "Expelliarmus..."

Dim ws As Workbook
Dim arrItem() As String
Dim dados As String

'diretorio = "C:\Users\00400889\Desktop\gerarMS"

'diretorio = TextBox1
diretorio = Application.InputBox(prompt:="Inserir diretório onde será impresso os templates")

Debug.Print diretorio

If diretorio = False Then
    result = MsgBox("Não foi encontrado o local onde gerar os templates! Favor especificar diretório.", vbCritical, "Atenção!")
Else

Call MostraCTE

directory = diretorio

'------------

Sheets("TEMPLATE").Select
Range("A1").Select

Num_Prod = Range("A" & Rows.Count).End(xlUp).Row

Range("A1").Select

For CARGA = 1 To Num_Prod - 1

Call clearTemplates
' -----------------------------
    Sheets("TEMPLATE").Select

    ActiveCell.Offset(1, 0).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    IM = Cells(lin, col)

    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    PM = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    comp = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    COS_ = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    REV_ = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    TIPO = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    CTC = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    CTE_1 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    CTE_2 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    '------------------------------
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    p1 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MN1 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    TM1 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MAX1 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MIN1 = Cells(lin, col)
   
    ActiveCell.Offset(0, 1).Select
    
    '------------------------------
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    p2 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MN2 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    TM2 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MAX2 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MIN2 = Cells(lin, col)
    
    '------------------------------
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
   
    P3 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MN3 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    TM3 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MAX3 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MIN3 = Cells(lin, col)
   
    '------------------------------
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    P4 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MN4 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    TM4 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MAX4 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MIN4 = Cells(lin, col)
   
    '------------------------------
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    P5 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MN5 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    TM5 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MAX5 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MIN5 = Cells(lin, col)
   
    '------------------------------
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    P6 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MN6 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    TM6 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MAX6 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MIN6 = Cells(lin, col)
   
    '------------------------------
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    P7 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MN7 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    TM7 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MAX7 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MIN7 = Cells(lin, col)
   
    '------------------------------
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    P8 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MN8 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    TM8 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MAX8 = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    MIN8 = Cells(lin, col)

    ActiveCell.Offset(0, 1).Select
    
    '---------------------------------
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select

    head = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    h_braking_type = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    h_torque = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    h_Coeff_frict = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    h_Prec_class = Cells(lin, col)
    
    '---------------------------------
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    foot = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    f_braking_type = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    f_torque = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    f_Coeff_frict = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    f_Prec_class = Cells(lin, col)
    
    '---------------------------------
    ActiveCell.Offset(0, 1).Select

    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    CC = Cells(lin, col)
    
    ActiveCell.Offset(0, 2).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    nota = Cells(lin, col)
    
    ActiveCell.Offset(0, 2).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    user_ = Cells(lin, col)
    
    ActiveCell.Offset(0, -63).Select
    
    SBR = Right(Left(CC, 18), 2)
    
    If SBR = 11 Then
        SBR = "53A"
    ElseIf SBR = 12 Then
        SBR = "53B"
    ElseIf SBR = 13 Then
        SBR = "53C"
    ElseIf SBR = 14 Then
        SBR = "53D"
    End If

If TIPO = "MS02" Then

    Sheets("MS02").Select
    Application.StatusBar = "Accio... (MS02)"
    
    Range("AQ1").Select
    ActiveCell.FormulaR1C1 = CTC
    
    Range("A14").Select
    ActiveCell.FormulaR1C1 = SBR

    Range("W14").Select
    ActiveCell.FormulaR1C1 = COS_ & "_" & REV_
    
    Range("AD18").Select
    ActiveCell.FormulaR1C1 = CC
    
    Range("X31").Select
    ActiveCell.FormulaR1C1 = CTE_1

    Range("X34").Select
    ActiveCell.FormulaR1C1 = CTE_2

    Range("A69").Select
    ActiveCell.FormulaR1C1 = user_
    
    Range("A76").Select
    ActiveCell.FormulaR1C1 = SBR & "-" & IM
        
    IM_pasta = IM
    INSP_Avalible = CTC
    pasta = "MS02"
    
    '-----------------------------------------------------------
    ConferePasta = diretorio & "\" & IM_pasta
    Call CriaIndividualTemplate(ConferePasta, diretorio, INSP_Avalible, SBR, pasta, directory, IM_pasta)
    '-----------------------------------------------------------
    
    Windows("Macro_Template_MS.xlsm").Activate
    Sheets("MS02").Select
    Cells.Select
    Selection.Copy
    
    Windows(SBR & "_" & INSP_Avalible & ".xlsx").Activate
    Cells.Select
    ActiveSheet.Paste
    
    '-----------------------------------------------------------
    Call FechaTemplate(SBR, INSP_Avalible, pasta)
    '-----------------------------------------------------------
    
    '==========================================================================================
    
    Windows("Macro_Template_MS.xlsm").Activate

    Sheets("MS02_1").Select
    Application.StatusBar = "Accio... (MS02_1)"
    
    Range("AQ1").Select
    ActiveCell.FormulaR1C1 = CTC
    
    Range("A14").Select
    ActiveCell.FormulaR1C1 = SBR

    Range("W14").Select
    ActiveCell.FormulaR1C1 = COS_ & "_" & REV_
    
    Range("AQ12").Select
    ActiveCell.FormulaR1C1 = CC
    
    Range("X31").Select
    ActiveCell.FormulaR1C1 = nota

    Range("Y48").Select
    ActiveCell.FormulaR1C1 = CTE_1

    Range("A48").Select
    ActiveCell.FormulaR1C1 = SBR & "-" & IM
    
    '------------------ MN ----------------
    Range("M155").Select
    ActiveCell.FormulaR1C1 = MN1
    
    Range("U155").Select
    ActiveCell.FormulaR1C1 = MN2
    
    Range("AC155").Select
    ActiveCell.FormulaR1C1 = MN3
    
    Range("AK155").Select
    ActiveCell.FormulaR1C1 = MN4
    
    Range("M166").Select
    ActiveCell.FormulaR1C1 = MN5
    
    Range("U166").Select
    ActiveCell.FormulaR1C1 = MN6
    
    Range("AC166").Select
    ActiveCell.FormulaR1C1 = MN7
    
    Range("AK166").Select
    ActiveCell.FormulaR1C1 = MN8
    
    '------------------ position ----------------
    
    Range("M159").Select
    ActiveCell.FormulaR1C1 = p1
    
    Range("U159").Select
    ActiveCell.FormulaR1C1 = p2
    
    Range("AC159").Select
    ActiveCell.FormulaR1C1 = P3
    
    Range("AK159").Select
    ActiveCell.FormulaR1C1 = P4
    
    Range("M170").Select
    ActiveCell.FormulaR1C1 = P5
    
    Range("U170").Select
    ActiveCell.FormulaR1C1 = P6
    
    Range("AC170").Select
    ActiveCell.FormulaR1C1 = P7
    
    Range("AK170").Select
    ActiveCell.FormulaR1C1 = P8
    
    '------------------ mountaing ----------------

    If TM1 = "W" Then
        Range("P145").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM1 = "Z" Then
        Range("P143").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
        
    If TM2 = "W" Then
        Range("X145").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM2 = "Z" Then
        Range("X143").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM3 = "W" Then
        Range("AF145").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM3 = "Z" Then
        Range("AF143").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM4 = "W" Then
        Range("AN145").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM4 = "Z" Then
        Range("AN143").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    
    '------------------------------
    If TM5 = "W" Then
        Range("P184").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM5 = "Z" Then
        Range("P182").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM6 = "W" Then
        Range("X184").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM6 = "Z" Then
        Range("X182").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
   If TM7 = "W" Then
        Range("AF184").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM7 = "Z" Then
        Range("AF182").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM8 = "W" Then
        Range("AN184").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM8 = "Z" Then
        Range("AN182").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    '------------------ record sheet ----------------
    
    arrItem_head = Split(head, "/")
    arrItem_h_braking_type = Split(h_braking_type, "/")
    arrItem_h_torque = Split(h_torque, "/")
    arrItem_h_Coeff_frict = Split(h_Coeff_frict, "/")
    arrItem_h_Prec_class = Split(h_Prec_class, "/")
    
    'record 1
    If arrItem_head(0) <> "x" Then
        Range("I218").Select
        ActiveCell.FormulaR1C1 = arrItem_head(0)
        Range("Q218").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(0)
        Range("Y218").Select
        If arrItem_h_torque(0) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(0)
        End If
        Range("AG218").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(0)
        Range("AO218").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(0)
    End If
    
    'record 2
    If arrItem_head(1) <> "x" Then
        Range("I226").Select
        ActiveCell.FormulaR1C1 = arrItem_head(1)
        Range("Q226").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(1)
        Range("Y226").Select
        If arrItem_h_torque(1) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(1)
        End If
        Range("AG226").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(1)
        Range("AO226").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(1)
    End If
    
    'record 3
    If arrItem_head(2) <> "x" Then
        Range("I234").Select
        ActiveCell.FormulaR1C1 = arrItem_head(2)
        Range("Q234").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(2)
        Range("Y234").Select
        If arrItem_h_torque(2) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(2)
        End If
        Range("AG234").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(2)
        Range("AO234").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(2)
    End If
    
    'record 4
    If arrItem_head(3) <> "x" Then
        Range("I242").Select
        ActiveCell.FormulaR1C1 = arrItem_head(3)
        Range("Q242").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(3)
        Range("Y242").Select
        If arrItem_h_torque(3) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(3)
        End If
        Range("AG242").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(3)
        Range("AO242").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(3)
    End If

    'record 5
    If arrItem_head(4) <> "x" Then
        Range("I250").Select
        ActiveCell.FormulaR1C1 = arrItem_head(4)
        Range("Q250").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(4)
        Range("Y250").Select
        If arrItem_h_torque(4) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(4)
        End If
        Range("AG250").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(4)
        Range("AO250").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(4)
    End If
    
    'record 6
    If arrItem_head(5) <> "x" Then
        Range("I258").Select
        ActiveCell.FormulaR1C1 = arrItem_head(5)
        Range("Q258").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(5)
        Range("Y258").Select
        If arrItem_h_torque(5) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(5)
        End If
        Range("AG258").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(5)
        Range("AO258").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(5)
    End If
    
    'record 7
    If arrItem_head(6) <> "x" Then
        Range("I266").Select
        ActiveCell.FormulaR1C1 = arrItem_head(6)
        Range("Q266").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(6)
        Range("Y266").Select
        If arrItem_h_torque(6) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(6)
        End If
        Range("AG266").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(6)
        Range("AO266").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(6)
    End If
    
    'record 8
    If arrItem_head(7) <> "x" Then
        Range("I274").Select
        ActiveCell.FormulaR1C1 = arrItem_head(7)
        Range("Q274").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(7)
        Range("Y274").Select
        If arrItem_h_torque(7) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(7)
        End If
        Range("AG274").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(7)
        Range("AO274").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(7)
    End If

    IM_pasta = IM
    INSP_Avalible = CTE_1
    pasta = "MS02_1"
    
    '-----------------------------------------------------------
    ConferePasta = diretorio & "\" & IM_pasta
    Call CriaIndividualTemplate(ConferePasta, diretorio, INSP_Avalible, SBR, pasta, directory, IM_pasta)
    '-----------------------------------------------------------
    
    Windows("Macro_Template_MS.xlsm").Activate
    Sheets("MS02_1").Select
    Cells.Select
    Selection.Copy
    
    Windows(SBR & "_" & INSP_Avalible & ".xlsx").Activate
    Cells.Select
    ActiveSheet.Paste
    
    '-----------------------------------------------------------
    Call FechaTemplate(SBR, INSP_Avalible, pasta)
    '-----------------------------------------------------------
    '=======================================================================================================
    
    Windows("Macro_Template_MS.xlsm").Activate

    Sheets("MS02_2").Select
    Application.StatusBar = "Accio... (MS02_2)"
    
    Range("AI1").Select
    ActiveCell.FormulaR1C1 = CTC
    
    Range("A13").Select
    ActiveCell.FormulaR1C1 = SBR

    Range("T13").Select
    ActiveCell.FormulaR1C1 = COS_ & "_" & REV_
    
    Range("AQ13").Select
    ActiveCell.FormulaR1C1 = CC
    
    Range("L32").Select
    ActiveCell.FormulaR1C1 = nota

    Range("Y49").Select
    ActiveCell.FormulaR1C1 = CTE_1

    Range("A49").Select
    ActiveCell.FormulaR1C1 = SBR & "-" & IM
    
    
    '------------------ Dados ----------------
    Range("W225").Select
    ActiveCell.FormulaR1C1 = PM
    
    Range("AS225").Select
    ActiveCell.FormulaR1C1 = comp
    

    '------------------ MN ----------------
    Range("T258").Select
    ActiveCell.FormulaR1C1 = MN1
    
    Range("AA258").Select
    ActiveCell.FormulaR1C1 = MN2
    
    Range("AH258").Select
    ActiveCell.FormulaR1C1 = MN3
    
    Range("AO258").Select
    ActiveCell.FormulaR1C1 = MN4
    
    Range("T283").Select
    ActiveCell.FormulaR1C1 = MN5
    
    Range("AA283").Select
    ActiveCell.FormulaR1C1 = MN6
    
    Range("AH283").Select
    ActiveCell.FormulaR1C1 = MN7
    
    Range("AO283").Select
    ActiveCell.FormulaR1C1 = MN8
    
    '------------------ position ----------------
    
    Range("T262").Select
    ActiveCell.FormulaR1C1 = p1
    
    Range("AA262").Select
    ActiveCell.FormulaR1C1 = p2
    
    Range("AH262").Select
    ActiveCell.FormulaR1C1 = P3
    
    Range("AO262").Select
    ActiveCell.FormulaR1C1 = P4
    
    Range("T287").Select
    ActiveCell.FormulaR1C1 = P5
    
    Range("AA287").Select
    ActiveCell.FormulaR1C1 = P6
    
    Range("AH287").Select
    ActiveCell.FormulaR1C1 = P7
    
    Range("AO287").Select
    ActiveCell.FormulaR1C1 = P8
    
    '------------------ mountaing ----------------

    If TM1 = "W" Then
        Range("T253").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM1 = "Z" Then
        Range("W249").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
        
    If TM2 = "W" Then
        Range("AA253").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM2 = "Z" Then
        Range("AD249").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM3 = "W" Then
        Range("AK253").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM3 = "Z" Then
        Range("AK249").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM4 = "W" Then
        Range("AR253").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM4 = "Z" Then
        Range("AR249").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    '------------------------------
    If TM5 = "W" Then
        Range("W278").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM5 = "Z" Then
        Range("W274").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM6 = "W" Then
        Range("AD278").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM6 = "Z" Then
        Range("AD278").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM7 = "W" Then
        Range("AK278").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM7 = "Z" Then
        Range("AK278").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM8 = "W" Then
        Range("AR278").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM8 = "Z" Then
        Range("AR278").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    '------------------ max & min ----------------
    
    Range("T265").Select
    If MIN1 <> "" Then
        ActiveCell.FormulaR1C1 = MIN1 & "/" & MAX1
    End If
    Range("AA265").Select
    If MIN2 <> "" Then
        ActiveCell.FormulaR1C1 = MIN2 & "/" & MAX2
    End If
    Range("AH265").Select
    If MIN3 <> "" Then
        ActiveCell.FormulaR1C1 = MIN3 & "/" & MAX3
    End If
    Range("AO265").Select
    If MIN4 <> "" Then
        ActiveCell.FormulaR1C1 = MIN4 & "/" & MAX4
    End If
    
    Range("T290").Select
    If MIN5 <> "" Then
        ActiveCell.FormulaR1C1 = MIN5 & "/" & MAX5
    End If
    Range("AA290").Select
    If MIN6 <> "" Then
        ActiveCell.FormulaR1C1 = MIN6 & "/" & MAX6
    End If
    Range("AH290").Select
    If MIN7 <> "" Then
        ActiveCell.FormulaR1C1 = MIN7 & "/" & MAX7
    End If
    Range("AO290").Select
    If MIN8 <> "" Then
        ActiveCell.FormulaR1C1 = MIN8 & "/" & MAX8
    End If
    
    IM_pasta = IM
    INSP_Avalible = CTE_2
    pasta = "MS02_2"
    

    '-----------------------------------------------------------
    ConferePasta = diretorio & "\" & IM_pasta
    Call CriaIndividualTemplate(ConferePasta, diretorio, INSP_Avalible, SBR, pasta, directory, IM_pasta)
    '-----------------------------------------------------------
    
    Windows("Macro_Template_MS.xlsm").Activate
    Sheets("MS02_2").Select
    Cells.Select
    Selection.Copy
    
    Windows(SBR & "_" & INSP_Avalible & ".xlsx").Activate
    Cells.Select
    ActiveSheet.Paste
    
    '-----------------------------------------------------------
    Call FechaTemplate(SBR, INSP_Avalible, pasta)
    '-----------------------------------------------------------
End If
    
'================================================ MS01 ===================================================
   
If TIPO = "MS01" Then

    Sheets("MS01").Select
    Application.StatusBar = "Accio... (MS01)"
    
    Range("AQ1").Select
    ActiveCell.FormulaR1C1 = CTC
    
    Range("A14").Select
    ActiveCell.FormulaR1C1 = SBR

    Range("W14").Select
    ActiveCell.FormulaR1C1 = COS_ & "_" & REV_
    
    Range("AD18").Select
    ActiveCell.FormulaR1C1 = CC
    
    Range("X31").Select
    ActiveCell.FormulaR1C1 = CTE_1

    Range("X34").Select
    ActiveCell.FormulaR1C1 = CTE_2

    Range("A69").Select
    ActiveCell.FormulaR1C1 = user_
    
    Range("A76").Select
    ActiveCell.FormulaR1C1 = SBR & "-" & IM
        
    IM_pasta = IM
    INSP_Avalible = CTC
    pasta = "MS01"
    
    '-----------------------------------------------------------
    ConferePasta = diretorio & "\" & IM_pasta
    Call CriaIndividualTemplate(ConferePasta, diretorio, INSP_Avalible, SBR, pasta, directory, IM_pasta)
    '-----------------------------------------------------------
    
    Windows("Macro_Template_MS.xlsm").Activate
    Sheets("MS01").Select
    Cells.Select
    Selection.Copy
    
    Windows(SBR & "_" & INSP_Avalible & ".xlsx").Activate
    Cells.Select
    ActiveSheet.Paste
    
    '-----------------------------------------------------------
    Call FechaTemplate(SBR, INSP_Avalible, pasta)
    '-----------------------------------------------------------
    
    '==========================================================================================
    
    Windows("Macro_Template_MS.xlsm").Activate

    Sheets("MS01_2").Select
    Application.StatusBar = "Accio... (MS01_2)"
    
    Range("AQ1").Select
    ActiveCell.FormulaR1C1 = CTC
    
    Range("A14").Select
    ActiveCell.FormulaR1C1 = SBR

    Range("W14").Select
    ActiveCell.FormulaR1C1 = COS_ & "_" & REV_
    
    Range("AQ13").Select
    ActiveCell.FormulaR1C1 = CC
    
    Range("L32").Select
    ActiveCell.FormulaR1C1 = nota

    Range("Y49").Select
    ActiveCell.FormulaR1C1 = CTE_2

    Range("A49").Select
    ActiveCell.FormulaR1C1 = SBR & "-" & IM
    
    '------------------ MN ----------------
    Range("M155").Select
    ActiveCell.FormulaR1C1 = MN1
    
    Range("U155").Select
    ActiveCell.FormulaR1C1 = MN2
    
    Range("AC155").Select
    ActiveCell.FormulaR1C1 = MN3
    
    Range("AK155").Select
    ActiveCell.FormulaR1C1 = MN4
    
    Range("M166").Select
    ActiveCell.FormulaR1C1 = MN5
    
    Range("U166").Select
    ActiveCell.FormulaR1C1 = MN6
    
    Range("AC166").Select
    ActiveCell.FormulaR1C1 = MN7
    
    Range("AK166").Select
    ActiveCell.FormulaR1C1 = MN8
    
    '------------------ position ----------------
    
    Range("M159").Select
    ActiveCell.FormulaR1C1 = p1
    
    Range("U159").Select
    ActiveCell.FormulaR1C1 = p2
    
    Range("AC159").Select
    ActiveCell.FormulaR1C1 = P3
    
    Range("AK159").Select
    ActiveCell.FormulaR1C1 = P4
    
    Range("M170").Select
    ActiveCell.FormulaR1C1 = P5
    
    Range("U170").Select
    ActiveCell.FormulaR1C1 = P6
    
    Range("AC170").Select
    ActiveCell.FormulaR1C1 = P7
    
    Range("AK170").Select
    ActiveCell.FormulaR1C1 = P8
    
    '------------------ mountaing ----------------

    If TM1 = "W" Then
        Range("P145").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM1 = "Z" Then
        Range("P143").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
        
    If TM2 = "W" Then
        Range("X145").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM2 = "Z" Then
        Range("X143").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM3 = "W" Then
        Range("AF145").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM3 = "Z" Then
        Range("AF143").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM4 = "W" Then
        Range("AN145").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM4 = "Z" Then
        Range("AN143").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    
    '------------------------------
    If TM5 = "W" Then
        Range("P184").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM5 = "Z" Then
        Range("P182").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM6 = "W" Then
        Range("X184").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM6 = "Z" Then
        Range("X182").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
   If TM7 = "W" Then
        Range("AF184").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM7 = "Z" Then
        Range("AF182").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM8 = "W" Then
        Range("AN184").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM8 = "Z" Then
        Range("AN182").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    '------------------ record sheet ----------------
    
    arrItem_head = Split(head, "/")
    arrItem_h_braking_type = Split(h_braking_type, "/")
    arrItem_h_torque = Split(h_torque, "/")
    arrItem_h_Coeff_frict = Split(h_Coeff_frict, "/")
    arrItem_h_Prec_class = Split(h_Prec_class, "/")
    
    arrItem_foot = Split(foot, "/")
    arrItem_f_braking_type = Split(f_braking_type, "/")
    arrItem_f_torque = Split(f_torque, "/")
    arrItem_f_Coeff_frict = Split(f_Coeff_frict, "/")
    arrItem_f_Prec_class = Split(f_Prec_class, "/")
    
    'record 1
    If arrItem_head(0) <> "x" Then
        Range("I219").Select
        ActiveCell.FormulaR1C1 = arrItem_head(0)
        Range("Q219").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(0)
        Range("Y219").Select
        If arrItem_h_torque(0) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(0)
        End If
        Range("AG219").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(0)
        Range("AO219").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(0)
    End If
    
    If arrItem_foot(0) <> "x" Then
        Range("I223").Select
        ActiveCell.FormulaR1C1 = arrItem_foot(0)
        Range("Q223").Select
        ActiveCell.FormulaR1C1 = arrItem_f_braking_type(0)
        Range("Y223").Select
        If arrItem_f_torque(0) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_f_torque(0)
        End If
        Range("AG223").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Coeff_frict(0)
        Range("AO223").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Prec_class(0)
    End If
    
    'record 2
    If arrItem_head(1) <> "x" Then
        Range("I227").Select
        ActiveCell.FormulaR1C1 = arrItem_head(1)
        Range("Q227").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(1)
        Range("Y227").Select
        If arrItem_h_torque(1) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(1)
        End If
        Range("AG227").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(1)
        Range("AO227").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(1)
    End If
    
    If arrItem_foot(1) <> "x" Then
        Range("I231").Select
        ActiveCell.FormulaR1C1 = arrItem_foot(1)
        Range("Q231").Select
        ActiveCell.FormulaR1C1 = arrItem_f_braking_type(1)
        Range("Y231").Select
        If arrItem_h_torque(1) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_f_torque(1)
        End If
        Range("AG231").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Coeff_frict(1)
        Range("AO231").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Prec_class(1)
    End If
    
    'record 3
    If arrItem_head(2) <> "x" Then
        Range("I235").Select
        ActiveCell.FormulaR1C1 = arrItem_head(2)
        Range("Q235").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(2)
        Range("Y235").Select
        If arrItem_h_torque(2) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(2)
        End If
        Range("AG235").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(2)
        Range("AO235").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(2)
    End If
    
    If arrItem_foot(2) <> "x" Then
        Range("I239").Select
        ActiveCell.FormulaR1C1 = arrItem_foot(2)
        Range("Q239").Select
        ActiveCell.FormulaR1C1 = arrItem_f_braking_type(2)
        Range("Y239").Select
        If arrItem_h_torque(2) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_f_torque(2)
        End If
        Range("AG239").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Coeff_frict(2)
        Range("AO239").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Prec_class(2)
    End If
    
    'record 4
    If arrItem_head(3) <> "x" Then
        Range("I243").Select
        ActiveCell.FormulaR1C1 = arrItem_head(3)
        Range("Q243").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(3)
        Range("Y243").Select
        If arrItem_h_torque(3) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(3)
        End If
        Range("AG243").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(3)
        Range("AO243").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(3)
    End If
    If arrItem_foot(3) <> "x" Then
        Range("I247").Select
        ActiveCell.FormulaR1C1 = arrItem_foot(3)
        Range("Q247").Select
        ActiveCell.FormulaR1C1 = arrItem_f_braking_type(3)
        Range("Y247").Select
        If arrItem_h_torque(3) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_f_torque(3)
        End If
        Range("AG247").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Coeff_frict(3)
        Range("AO247").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Prec_class(3)
    End If
    
    'record 5
    If arrItem_head(4) <> "x" Then
        Range("I251").Select
        ActiveCell.FormulaR1C1 = arrItem_head(4)
        Range("Q251").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(4)
        Range("Y251").Select
        If arrItem_h_torque(4) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(4)
        End If
        Range("AG251").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(4)
        Range("AO251").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(4)
    End If
    If arrItem_foot(4) <> "x" Then
        Range("I255").Select
        ActiveCell.FormulaR1C1 = arrItem_foot(4)
        Range("Q255").Select
        ActiveCell.FormulaR1C1 = arrItem_f_braking_type(4)
        Range("Y255").Select
        If arrItem_h_torque(4) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_f_torque(4)
        End If
        Range("AG255").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Coeff_frict(4)
        Range("AO255").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Prec_class(4)
    End If
    
    'record 6
    If arrItem_head(5) <> "x" Then
        Range("I259").Select
        ActiveCell.FormulaR1C1 = arrItem_head(5)
        Range("Q259").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(5)
        Range("Y259").Select
        If arrItem_h_torque(5) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(5)
        End If
        Range("AG259").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(5)
        Range("AO259").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(5)
    End If
    If arrItem_foot(5) <> "x" Then
        Range("I263").Select
        ActiveCell.FormulaR1C1 = arrItem_foot(5)
        Range("Q263").Select
        ActiveCell.FormulaR1C1 = arrItem_f_braking_type(5)
        Range("Y263").Select
        If arrItem_h_torque(5) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_f_torque(5)
        End If
        Range("AG263").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Coeff_frict(5)
        Range("AO263").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Prec_class(5)
    End If
    
    'record 7
    If arrItem_head(6) <> "x" Then
        Range("I267").Select
        ActiveCell.FormulaR1C1 = arrItem_head(6)
        Range("Q267").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(6)
        Range("Y267").Select
        If arrItem_h_torque(6) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(6)
        End If
        Range("AG267").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(6)
        Range("AO267").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(6)
    End If
    If arrItem_foot(6) <> "x" Then
        Range("I271").Select
        ActiveCell.FormulaR1C1 = arrItem_foot(6)
        Range("Q271").Select
        ActiveCell.FormulaR1C1 = arrItem_f_braking_type(6)
        Range("Y271").Select
        If arrItem_h_torque(6) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_f_torque(6)
        End If
        Range("AG271").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Coeff_frict(6)
        Range("AO271").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Prec_class(6)
    End If
    
    'record 8
    If arrItem_head(7) <> "x" Then
        Range("I275").Select
        ActiveCell.FormulaR1C1 = arrItem_head(7)
        Range("Q275").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(7)
        Range("Y275").Select
        If arrItem_h_torque(7) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(7)
        End If
        Range("AG275").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(7)
        Range("AO275").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(7)
    End If

    If arrItem_foot(7) <> "x" Then
        Range("I279").Select
        ActiveCell.FormulaR1C1 = arrItem_foot(7)
        Range("Q279").Select
        ActiveCell.FormulaR1C1 = arrItem_f_braking_type(7)
        Range("Y279").Select
        If arrItem_h_torque(7) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_f_torque(7)
        End If
        Range("AG279").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Coeff_frict(7)
        Range("AO279").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Prec_class(7)
    End If

    IM_pasta = IM
    INSP_Avalible = CTE_2
    pasta = "MS01_2"
    
    '-----------------------------------------------------------
    ConferePasta = diretorio & "\" & IM_pasta
    Call CriaIndividualTemplate(ConferePasta, diretorio, INSP_Avalible, SBR, pasta, directory, IM_pasta)
    '-----------------------------------------------------------
    
    Windows("Macro_Template_MS.xlsm").Activate
    Sheets("MS01_2").Select
    Cells.Select
    Selection.Copy
    
    Windows(SBR & "_" & INSP_Avalible & ".xlsx").Activate
    Cells.Select
    ActiveSheet.Paste
    
    '-----------------------------------------------------------
    Call FechaTemplate(SBR, INSP_Avalible, pasta)
    '-----------------------------------------------------------
    '=======================================================================================================
    
    Windows("Macro_Template_MS.xlsm").Activate

    Sheets("MS01_1").Select
    Application.StatusBar = "Accio... (MS02_1)"
    
    Range("AI1").Select
    ActiveCell.FormulaR1C1 = CTC
    
    Range("A13").Select
    ActiveCell.FormulaR1C1 = SBR

    Range("T13").Select
    ActiveCell.FormulaR1C1 = COS_ & "_" & REV_
    
    Range("AQ13").Select
    ActiveCell.FormulaR1C1 = CC
    
    Range("L32").Select
    ActiveCell.FormulaR1C1 = nota

    Range("Y49").Select
    ActiveCell.FormulaR1C1 = CTE_1

    Range("A49").Select
    ActiveCell.FormulaR1C1 = SBR & "-" & IM
    
    
    '------------------ Dados ----------------
    Range("W225").Select
    ActiveCell.FormulaR1C1 = PM
    
    Range("AS225").Select
    ActiveCell.FormulaR1C1 = comp
    

    '------------------ MN ----------------
    Range("T256").Select
    ActiveCell.FormulaR1C1 = MN1
    
    Range("AA256").Select
    ActiveCell.FormulaR1C1 = MN2
    
    Range("AH256").Select
    ActiveCell.FormulaR1C1 = MN3
    
    Range("AO256").Select
    ActiveCell.FormulaR1C1 = MN4
    
    Range("T289").Select
    ActiveCell.FormulaR1C1 = MN5
    
    Range("AA289").Select
    ActiveCell.FormulaR1C1 = MN6
    
    Range("AH289").Select
    ActiveCell.FormulaR1C1 = MN7
    
    Range("AO289").Select
    ActiveCell.FormulaR1C1 = MN8
    
    '------------------ position ----------------
    
    Range("T262").Select
    ActiveCell.FormulaR1C1 = p1
    
    Range("AA262").Select
    ActiveCell.FormulaR1C1 = p2
    
    Range("AH262").Select
    ActiveCell.FormulaR1C1 = P3
    
    Range("AO262").Select
    ActiveCell.FormulaR1C1 = P4
    
    Range("T293").Select
    ActiveCell.FormulaR1C1 = P5
    
    Range("AA293").Select
    ActiveCell.FormulaR1C1 = P6
    
    Range("AH293").Select
    ActiveCell.FormulaR1C1 = P7
    
    Range("AO293").Select
    ActiveCell.FormulaR1C1 = P8
    
    '------------------ mountaing ----------------

    If TM1 = "W" Then
        Range("T253").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM1 = "Z" Then
        Range("W249").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
        
    If TM2 = "W" Then
        Range("AA253").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM2 = "Z" Then
        Range("AD249").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM3 = "W" Then
        Range("AK253").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM3 = "Z" Then
        Range("AK249").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM4 = "W" Then
        Range("AR253").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM4 = "Z" Then
        Range("AR249").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    '------------------------------
    If TM5 = "W" Then
        Range("W284").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM5 = "Z" Then
        Range("W280").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM6 = "W" Then
        Range("AD284").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM6 = "Z" Then
        Range("AD280").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM7 = "W" Then
        Range("AK284").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM7 = "Z" Then
        Range("AK280").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM8 = "W" Then
        Range("AR284").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM8 = "Z" Then
        Range("AR280").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    '------------------ max & min ----------------
    
    arrItem_max1 = Split(MAX1, "/")
    arrItem_max2 = Split(MAX2, "/")
    arrItem_max3 = Split(MAX3, "/")
    arrItem_max4 = Split(MAX4, "/")
    arrItem_max5 = Split(MAX5, "/")
    arrItem_max6 = Split(MAX6, "/")
    arrItem_max7 = Split(MAX7, "/")
    arrItem_max8 = Split(MAX8, "/")
    
    
    Range("T269").Select
    If MIN1 <> "" Then
        ActiveCell.FormulaR1C1 = arrItem_max1(0)
        Range("T272").Select
        ActiveCell.FormulaR1C1 = MIN1
        Range("T263").Select
        If arrItem_max1(1) <> "x" Then
            ActiveCell.FormulaR1C1 = arrItem_max1(1)
        End If
    End If
    Range("AA269").Select
    If MIN2 <> "" Then
        ActiveCell.FormulaR1C1 = arrItem_max2(0)
        Range("AA272").Select
        ActiveCell.FormulaR1C1 = MIN2
        Range("AA263").Select
        If arrItem_max2(1) <> "x" Then
            ActiveCell.FormulaR1C1 = arrItem_max2(1)
        End If
    End If
    Range("AH269").Select
    If MIN3 <> "" Then
        ActiveCell.FormulaR1C1 = arrItem_max3(0)
        Range("AH272").Select
        ActiveCell.FormulaR1C1 = MIN3
        Range("AH263").Select
        If arrItem_max3(1) <> "x" Then
            ActiveCell.FormulaR1C1 = arrItem_max3(1)
        End If
    End If
    Range("AO269").Select
    If MIN4 <> "" Then
        ActiveCell.FormulaR1C1 = arrItem_max4(0)
        Range("AO272").Select
        ActiveCell.FormulaR1C1 = MIN4
        Range("AO263").Select
        If arrItem_max4(1) <> "x" Then
            ActiveCell.FormulaR1C1 = arrItem_max4(1)
        End If
    End If
    
    Range("T302").Select
    If MIN5 <> "" Then
        ActiveCell.FormulaR1C1 = arrItem_max5(0)
        Range("T305").Select
        ActiveCell.FormulaR1C1 = MIN5
        Range("T296").Select
        If arrItem_max5(1) <> "x" Then
            ActiveCell.FormulaR1C1 = arrItem_max5(1)
        End If
    End If
    Range("AA302").Select
    If MIN6 <> "" Then
        ActiveCell.FormulaR1C1 = arrItem_max6(0)
        Range("AA305").Select
        ActiveCell.FormulaR1C1 = MIN6
        Range("AA296").Select
        If arrItem_max6(1) <> "x" Then
            ActiveCell.FormulaR1C1 = arrItem_max6(1)
        End If
    End If
    Range("AH302").Select
    If MIN7 <> "" Then
        ActiveCell.FormulaR1C1 = arrItem_max7(0)
        Range("AH305").Select
        ActiveCell.FormulaR1C1 = MIN7
        Range("AH296").Select
        If arrItem_max7(1) <> "x" Then
            ActiveCell.FormulaR1C1 = arrItem_max7(1)
        End If
    End If
    Range("AO302").Select
    If MIN8 <> "" Then
        ActiveCell.FormulaR1C1 = arrItem_max8(0)
        Range("AO305").Select
        ActiveCell.FormulaR1C1 = MIN8
        Range("AO296").Select
        If arrItem_max8(1) <> "x" Then
            ActiveCell.FormulaR1C1 = arrItem_max8(1)
        End If
    End If
    
    IM_pasta = IM
    INSP_Avalible = CTE_1
    pasta = "MS01_1"
    

    '-----------------------------------------------------------
    ConferePasta = diretorio & "\" & IM_pasta
    Call CriaIndividualTemplate(ConferePasta, diretorio, INSP_Avalible, SBR, pasta, directory, IM_pasta)
    '-----------------------------------------------------------
    
    Windows("Macro_Template_MS.xlsm").Activate
    Sheets("MS01_1").Select
    Cells.Select
    Selection.Copy
    
    Windows(SBR & "_" & INSP_Avalible & ".xlsx").Activate
    Cells.Select
    ActiveSheet.Paste
    
    '-----------------------------------------------------------
    Call FechaTemplate(SBR, INSP_Avalible, pasta)
    '-----------------------------------------------------------
    
End If
      
      
Next CARGA
 
Call EscondeCTE

'UserForm1.Hide

MsgBox "Tarefa Realizada Com Sucesso!"

End If

Sheets("TEMPLATE").Select
Range("A1").Select

Application.ScreenUpdating = True

End Sub

Private Sub CommandButton6_Click()

Call Clear

End Sub


Private Sub Label7_Click()

MsgBox "ATENÇÃO! Antes de tranferir arquivos certifique-se que a PLANILHA_IMPORTACAO_CTE e PLANILHA_IMPORTACAO_PRODUTO, ferente ao seu caderno, estão abertas."

End Sub

Private Sub TextBox1_Change()

End Sub

========================
'Ajusta = copia linha e replica onde estiver vazio
Sub ajusta()

Sheets("Plan4").Select
LL = Range("A" & Rows.Count).End(xlUp).Row
'Plan8.Range("A10:A499").Rows.Count

Range("A1").Select

ActiveCell.Offset(1, 0).Select

For a = 1 To LL

lin = ActiveCell.Row
col = ActiveCell.Column
Cells(lin, col).Select

TESTA = Cells(lin, col)

ActiveCell.Offset(1, 0).Select

lin = ActiveCell.Row
col = ActiveCell.Column
Cells(lin, col).Select

COMPARA = Cells(lin, col)

Do While COMPARA = Empty

ActiveCell.FormulaR1C1 = TESTA

    ActiveCell.Offset(1, 0).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    COMPARA = Cells(lin, col)
    
'    If TESTA <> COMPARA Then
'
'        ActiveCell.FormulaR1C1 = TESTA
'
'    End If
    

Loop

Next a

End Sub

===========






========================

Z:\01_DOCUMENTOS_DE_REFERENCIA\04_DOCS_DCNS\TDP IS

C:\Users\00400889

C:\User\ cd Desktop

==========================


for c in LMA_Construction['Number(Item).1']:
  new_df = LMA_Construction[LMA_Construction['Number(Related product lot(s))'] != '-']
  print(new_df)




=================================

java

document.getElementByClassName()

https://pt.stackoverflow.com/questions/197703/como-verificar-se-uma-div-tem-um-id

http://respostas.guj.com.br/24922-capturar-varios-ids-de-elementos-que-tenham-a-mesma-classe-em-javascript

https://developer.mozilla.org/pt-BR/docs/Web/API/Document/getElementsByClassName

https://forum.imasters.com.br/topic/380561-resolvido%C2%A0pegar-o-id-do-elemento-clicado-com-jquery/



<input type="text" class="form-control ng-pristine ng-valid ng-empty ng-touched" placeholder="Username" ng-model="credentials.username">


SQL:


select  EQP_A_CC_MONTAGEM, sum(EQP_A_CMD_TIPE) as conta from  IMZ_SBR1 group by EQP_A_CC_MONTAGEM = (soma curinga)

select EQP_A_CC_MONTAGEM, Count(EQP_A_CC_MONTAGEM) from  IMZ_SBR1
group by EQP_A_CC_MONTAGEM
having Count(EQP_A_CC_MONTAGEM) > 1




==========================================================================


WebDriver driver = new ChromeDriver();

WebDriver driver = new FirefoxDriver();



'pause system
Application.Wait TimeSerial(0, 0, 1)**

Application.Wait "18:23:00"    'Este exemplo pausa uma macro em execução até às 18:23 de hoje.

newHour = Hour(Now())
newMinute = Minute(Now())
newSecond = Second(Now()) + 10
waitTime = TimeSerial(newHour, newMinute, newSecond)
Application.Wait waitTime    'Este exemplo para uma macro em execução por aproximadamente 10 segundos.



If Application.Wait(Now + TimeValue("0:00:10")) Then
 MsgBox "Time expired"
End If            'Este exemplo exibe uma mensagem indicando se os 10 segundos passaram.

'------------------

============

Sub alinha()

    Dim contadorB(100) As String
    Dim arrX(100) As Variant
    Dim iArq As Long
    
    Range("D2:W30").Select
    Selection.ClearContents
    
    Sheets("Alinhamento").Select
    
    
    cont = Range("B" & Rows.Count).End(xlUp).Row
    

    Range("B2").Select
    
    For a = 1 To cont - 1
    
        ActiveCell.Offset(1, 0).Select
        
        lin = ActiveCell.Row
        col = ActiveCell.Column
        Cells(lin, col).Select
        
        dados = Cells(lin, col)
        
        contadorB(a) = dados
        arrX(50) = contadorB()
        
    Next a
    
    Var = ""
    
    For b = 1 To cont - 1
    
        Var = Var & arrX(50)(b) & ", "

    Next b
    


Range("D3").Select
ActiveCell.FormulaR1C1 = Var

'
'iArq = FreeFile
'
'Open "C:\Users\00400889\Downloads\alinhamento.txt" For Output As iArq
'
'Print #iArq, Var
'
'Close #iArq


End Sub




============
replica cálula
atualizar célula


Sub Macro1()

Application.ScreenUpdating = False


Range("A1").Select
Selection.End(xlDown).Select

    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    Cont = lin
  
Range("B1").Select

For a = 1 To Cont - 1

ActiveCell.Offset(1, 0).Select

    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    Var = Cells(lin, col)


    ActiveCell.FormulaR1C1 = Var
    
Next a
    
    Application.ScreenUpdating = True

End Sub

===================


Sub rida()

Dim arrItem() As String
Dim dados As String


    ActiveSheet.Range(Cells(lin, col), Cells(quant, col + 2)).Select


LL = Range("A" & Rows.Count).End(xlUp).Row
Debug.Print LL

'Debug.Prin  Wb.Name

Sheets("ANALIZE").Select
Range("J1").Select
ActiveCell.Offset(1, 0).Select

--------------

lin = ActiveCell.Row
col = ActiveCell.Column
Cells(lin, col).Select

dados = Cells(lin, col)

arrItem = Split(dados, " ")

Debug.Print dados

Debug.Print UBound(arrItem)



For i = 0 To UBound(arrItem)

Debug.Print arrItem(i)

If arrItem(i) = "RM00001" Then
    Debug.Print "OK"
End If

Next i

End Sub

=========================

Sub ConexaoDBView()

Application.ScreenUpdating = False

'Sheets("CONTROLE").Visible = True
'Sheets("VISAO_GERAL").Visible = True
'Sheets("CONFLITOS_1").Visible = True
    
Dim cnn As ADODB.Connection
Dim cmd As ADODB.Command
Dim rs As ADODB.Recordset
Dim strDbPath As String

'---------------


Sheets("VISAO_GERAL").Select
    Range("B2").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.ClearContents
    Range("A1").Select

'---------------
Sheets("Plan1").Select
Range("B1").Select

For a = 1 To 123
Sheets("Plan1").Select
    ActiveCell.Offset(1, 0).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    Note = "'" & Cells(lin, col) & "'"
        
        Set cnn = New ADODB.Connection
        Set cmd = New ADODB.Command
        Set rs = New ADODB.Recordset
        
        strDbPath = "W:\DIN\GD\INT\02_INTERNO\Taís\TESTS_PLAN1.accdb"
        cnn.ConnectionString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" & strDbPath
        cnn.Open
        
        Selection0 = "SELECT CC, IM_PAI, IM_FILHO, CMX, QUANTIDADE FROM LMA where CC = " & Note & ";"
        Selection1 = "SELECT CC, IM_PAI, IM_FILHO, CMX, QUANTIDADE FROM CC_LMA where CC = " & Note & ";"
   
        Sheets("VISAO_GERAL").Select

        Set cmd.ActiveConnection = cnn
        cmd.CommandText = Selection0
        Set rs = cmd.Execute
        Set qt = ActiveSheet.QueryTables.Add(Connection:=rs, Destination:=ActiveSheet.Range("B2"))
        qt.Refresh
        
'        Set cmd.ActiveConnection = cnn
'        cmd.CommandText = Selection1 '
'        Set rs = cmd.Execute
'        Set qt = ActiveSheet.QueryTables.Add(Connection:=rs, Destination:=ActiveSheet.Range("H2"))
'        qt.Refresh
        
        Sheets("VISAO_GERAL").Select
        Range("B2").Select
        Range(Selection, Selection.End(xlToRight)).Select
        Range(Selection, Selection.End(xlDown)).Select
        Selection.Copy
        
        Sheets("FILTRO").Select
        Range("B1").Select
        Selection.End(xlDown).Select
        ActiveCell.Offset(1, 0).Select
        ActiveSheet.Paste

    
        'ActiveSheet.Range(Cells(lin, col), Cells(lin, col + 1)).Select
        
    Sheets("VISAO_GERAL").Select
    Range("B2").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.ClearContents
    Range("A1").Select
        
    
    rs.Close
    cnn.Close
    
    Set rs = Nothing
    Set cnn = Nothing

Next a

    Range("H2").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Style = "Cálculo"
    With Selection.Font
        .ColorIndex = xlAutomatic
        .TintAndShade = 0
    End With
    Selection.Font.Bold = False
    Range("B2").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Selection.Font.Bold = True
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = -0.249977111117893
        .PatternTintAndShade = 0
    End With
    Range("DA1").Select

Application.ScreenUpdating = True

End Sub


'================

Carregar elementos das caixas na PL (Bira, Rodrigo, Carlos)
Carregar novas inspeções 


https://www.guiadoexcel.com.br/filtro-automatico-em-tabela-dinamica-excel/
Planilha dinâmica - VBA


Python-Web
============================
import lxml
import requests
from bs4 import BeautifulSoup

r = requests.get('http://www.reddit.com/r/programming/')
print(r.text)

print("\n" * 10)

soup = BeautifulSoup(r.text, 'lxml')
tag = soup.find_all('p')

print("TAG")
print(tag)

print("\n" * 10)

for a in range(0, len(tag)):
  lista_tag = soup.find_all('p')[a].get_text()
  print("LISTA_TAG")
  print(lista_tag)

print("\n" * 10)

break_lista = lista_tag.split()
print("BREAK_LISTA")
print(break_lista)

print("\n" * 10)

for b in break_lista:
  print(b)
  print('\n')


=================

diretorio = TextBox1

If diretorio = "" Then
    result = MsgBox("Não foi encontrado o local onde gerar os templates! Favor especificar diretório.", vbCritical, "Atenção!")
Else


        Windows("Macro_CTE_Template.xlsm").Activate
        Sheets("Instrução").Select
        Sheets("Instrução").Copy After:=Workbooks(TEMPLATE & ".xls").Sheets(1)

        Windows(TEMPLATE & ".xls").Activate
        Sheets("Plan1").Select
        Range("A1").Select
        ActiveWorkbook.Save
        ActiveWindow.Close

Dim resultado As VbMsgBoxResult


        ConferePasta = diretorio & "\" & INSP_Avalible
        
        If Dir(ConferePasta, vbDirectory) = "" Then
     
        MkDir ConferePasta
        
        End If
        
        Set ws = Application.Workbooks.Add
        ActiveWorkbook.SaveAs Filename:= _
        directory & "\" & INSP_Avalible & "\" & CTE_Rec & ".xls", _
        FileFormat:=xlNormal, Password:="", WriteResPassword:="", _
        ReadOnlyRecommended:=False, CreateBackup:=False
'-----------------------------------------------------------
        Windows("Macro_CTE_Template.xlsm").Activate


        Windows(TEMPLATE & ".xls").Activate
        Sheets("Plan1").Select
        Range("A1").Select
        ActiveWorkbook.Save
        ActiveWindow.Close

tipo = Application.InputBox("Texto Atual", "Alterações Aplicáveis", Default:="Digite a Alteração", Type:=3)

Workbooks.Open Filename:= _
                path_ & nome _
                , ReadOnly:=True
                
            Windows(nome).Activate
            Sheets("CAPA").Select
            
            Cells.Replace What:=Atual1, Replacement:=Change1, LookAt:=xlPart, _
                SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
                ReplaceFormat:=False
                
            Windows(nome).Activate
            Sheets("CAPA").Select
            Cells.Replace What:=Atual2, Replacement:=Change2, LookAt:=xlPart, _
                SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
                ReplaceFormat:=False
                
            Windows(nome).Activate
            Sheets("CAPA").Select
            Cells.Replace What:=Atual3, Replacement:=Change3, LookAt:=xlPart, _
                SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
                ReplaceFormat:=False
                
'            MsgBox path_ & "Nova\"
'            MsgBox nome

            Windows(nome).Activate
    
            ActiveWorkbook.SaveAs Filename:= _
                path_ & "Nova\" & nome, _
                FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False
        
            ActiveWindow.Close
    
    Windows("Atualiza_DOCS.xlsm").Activate




Range(Selection, Selection.End(xlDown)).Select





Para as pessas de passagens AC30101, AC30102, AC30103, AC30104, AC30105 e AC30106 na inspection request foram encontrados os COS-SMB-200569 e o COS-SMB-321709 para cada equipamento, referente a inspeção B05. Para o eração dos templates qual considerar?

For the TLT passage AC30101, AC30102, AC30103, AC30104, AC30105 and AC30106, in the inspection request the COS-SMB-200569 and COS-SMB-321709 were found for each equipment, referring to inspection B05. For the generation of the templates, what to consider?


+++++++++++++++++++++ Find - Search




Sub sbxbuscatexto()

    Sheets("SEARCH").Select
    LL = Range("B" & Rows.Count).End(xlUp).Row
    
    Sheets("SEARCH").Select
    Range("B2").Select
    
    For A = 1 To LL - 2

     Sheets("SEARCH").Select

        ActiveCell.Offset(1, 0).Select
        
        lin = ActiveCell.Row
        col = ActiveCell.Column
        Cells(lin, col).Select
        
        equip = Cells(lin, col)
        Debug.Print equip
        
        Sheets("GERAL").Select

'On Error GoTo mensagem
Set wFnd = Range("E:E").Find(equip)

'Debug.Print wFnd

If wFnd = False Then
    Debug.Print "N"
End If


If wFnd = "" Then
    Debug.Print wFnd
End If

'mensagem:
    'Debug.Print "Nada!!!"


Next A

End Sub


Sub Pesquisar()

Application.ScreenUpdating = False

Sheets("GERAL").Visible = True
    
Dim arrItem() As String
Dim dados As String

Sheets("GERAL").Select

LB = Range("B" & Rows.Count).End(xlUp).Row

Sheets("SEARCH").Select
Range("B2").Select

LL = Range("B" & Rows.Count).End(xlUp).Row

For A = 1 To LL - 2
Sheets("SEARCH").Select

    ActiveCell.Offset(1, 0).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    equip = Cells(lin, col)
    
    Sheets("GERAL").Select
    Range("E2").Select

    pulo = 0
'SeachString = "HL24000"

    Set Intervalo = [E3:E5000]
    conta = 0
    For Each Célula In Intervalo
        Compara = Célula Like "*" & equip & "*"
        'Compara = Célula Like "*" & SeachString & "*"
        'ActiveCell.Offset(0, 1).Select
        
        conta = conta + 1
        'Debug.Print conta
        If Compara Then
        
            pulo = pulo + 1
        
            'Debug.Print pulo
            ActiveCell.Offset(conta, -3).Select
        
            lin = ActiveCell.Row
            col = ActiveCell.Column
            Cells(lin, col).Select
            
            coment = Cells(lin, col)
            'Debug.Print coment
            
            Texto = Texto & "-" & Célula.Value
            
            Sheets("SEARCH").Select
            ActiveCell.Offset(0, pulo + 1).Select
            ActiveCell.FormulaR1C1 = coment
            ActiveCell.Offset(0, -(pulo + 1)).Select
            
            Sheets("GERAL").Select
            
            ActiveCell.Offset(0, 3).Select
             
        End If
    
    Next Célula

Next A

End Sub

++++++++++++++++++++++++

'=====

Sub ajustaDuplicidade()

Sheets("Plan1").Select
Range("A1").Select

ActiveCell.Offset(1, 0).Select

For a = 1 To 12

    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    TESTA = Cells(lin, col)
    
    ActiveCell.Offset(1, 0).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    COMPARA = Cells(lin, col)
    
    Do While COMPARA = TESTA
    
        ActiveCell.FormulaR1C1 = "-"
    
        ActiveCell.Offset(1, 0).Select
        
        lin = ActiveCell.Row
        col = ActiveCell.Column
        Cells(lin, col).Select
        
        COMPARA = Cells(lin, col)
        
    '    If TESTA <> COMPARA Then
    '
    '        ActiveCell.FormulaR1C1 = TESTA
    '
    '    End If
        
    Loop

Next a



========================

On Error GoTo mensagem

Cells.Find(what:="texto").Activate



mensagem:
MsgBox "nome não existente!!!"




Exit Do


Application.StatusBar = "Expecto Patronum..."

'=================================================================

alterar nome de uma planilha

 Workbooks.Open FileName:="arquivolegendas.xls"
    Sheets("Legendas").Move After:=Workbooks("Lista de Cobrança").Sheets("Nome da planilha")


Sub programation()

Application.ScreenUpdating = False

Sheets("CATALOG").Select
Range("A1").Select

Selection.End(xlDown).Select

lin = ActiveCell.Row
col = ActiveCell.Column
Cells(lin, col).Select

cont = lin

Range("A1").Select

For a = 1 To cont

    ActiveCell.Offset(1, 4).Select
    
    For b = 1 To 4

    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    LOCAL_VERIFY = Cells(lin, col)

    If LOCAL_VERIFY = "" Then
    
        ActiveCell.FormulaR1C1 = "null"
    
    End If
    
    ActiveCell.Offset(0, 1).Select
    
    Next b
    
    
    
    Selection.End(xlToLeft).Select
    Selection.End(xlToLeft).Select
    Selection.End(xlToLeft).Select
    Selection.End(xlToLeft).Select
    Selection.End(xlToLeft).Select
    

Next a

Application.ScreenUpdating = True

End Sub























Sub actionPai()

Sheets("CONSOLIDATED_LIST").Select
Range("A1").Select

Selection.End(xlDown).Select

lin = ActiveCell.Row
col = ActiveCell.Column
Cells(lin, col).Select

cont = lin

Range("A1").Select

For a = 1 To cont

    ActiveCell.Offset(1, 1).Select

    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    IM_PAI = Cells(lin, col)
    'AC41017
    ActiveCell.Offset(0, 4).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    IM_SON = Cells(lin, col)
    
    If IM_PAI = IM_SON Then
    
        With Selection.Font
            .ThemeColor = xlThemeColorDark2
            .TintAndShade = -9.99786370433668E-02
        End With

    
    End If
    
    Selection.End(xlToLeft).Select
    Selection.End(xlToLeft).Select
    Selection.End(xlToLeft).Select
    Selection.End(xlToLeft).Select
    Selection.End(xlToLeft).Select
    

Next a



End Sub


Sub actionFilho()

Sheets("CONSOLIDATED_LIST").Select
Range("A1").Select

Selection.End(xlDown).Select

lin = ActiveCell.Row
col = ActiveCell.Column
Cells(lin, col).Select

cont = lin

Range("A1").Select

For a = 1 To cont

    ActiveCell.Offset(1, 7).Select

    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    IM_PAI = Cells(lin, col)
    'AC41017

    
    If IM_PAI <> "null" Then
        ActiveSheet.Range(Cells(lin, col), Cells(lin, col + 1)).Select
        With Selection.Font
            .Color = -16776961
            .TintAndShade = 0
        End With

    End If
    
    Selection.End(xlToLeft).Select
    Selection.End(xlToLeft).Select
    Selection.End(xlToLeft).Select
    Selection.End(xlToLeft).Select
    Selection.End(xlToLeft).Select
    Selection.End(xlToLeft).Select
    Selection.End(xlToLeft).Select
    Selection.End(xlToLeft).Select
    Selection.End(xlToLeft).Select
    

Next a


End Sub















Sub Filtro()

Application.ScreenUpdating = False

    Sheets("Route_Treatment").Visible = True

Sheets("Filter").Select
Range("A1").Select

Sheets("Cable_Route").Select
Range("A1").Select

Sheets("Route_Treatment").Select
    Rows("3:3").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.ClearContents
    Range("A1").Select
Range("A1").Select

Sheets("Rota de Cabos").Select
    Columns("D:AK").Select
    Selection.FormatConditions.Delete
    Range("A1").Select
    
    Rows("3:3").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.ClearContents

Range("A2").Select

Sheets("Filter").Select
Range("BC2").Select

lin = ActiveCell.Row
col = ActiveCell.Column
Cells(lin, col).Select

Status = Cells(lin, col)

Range("B4").Select

If Status = 5 Then
    Range("G2").Select
    MsgBox "Escolha o tipo de filtro a ser realizado.", vbCritical, "Atenção!"
    
    Sheets("Filter").Select
    Range("G2").Select
    
End If

If Status = 1 Or Status = 2 Or Status = 3 Then

    Do While ActiveCell <> Empty
        Sheets("Filter").Select
    
        ActiveCell.Offset(1, 0).Select
        
        lin = ActiveCell.Row
        col = ActiveCell.Column
        Cells(lin, col).Select
        
        Var = Cells(lin, col)
   
        If Var <> "" Then
        
            Sheets("Cable_Route").Select
            ActiveSheet.Range("$A$2:$DC$3800").AutoFilter Field:=Status + 3, Criteria1:= _
                Var
            
            Range("A1").Select
            
            Selection.End(xlDown).Select
            
            lin = ActiveCell.Row
            col = ActiveCell.Column
            Cells(lin, col).Select
            
            If lin = 2 Then
            
                Sheets("Cable_Route").Select
                ActiveSheet.ShowAllData
            
            End If
            
            If lin <> 2 Then

                Rows("2:2").Select
                Range(Selection, Selection.End(xlDown)).Select
                Selection.Copy
                
                Sheets("Route_Treatment").Select
                Rows("2:2").Select
                ActiveSheet.Paste
                Application.CutCopyMode = False
                
                Rows("3:3").Select
                Range(Selection, Selection.End(xlDown)).Select
                Selection.Copy
            
                Sheets("Rota de Cabos").Select
                Range("A1").Select
                
                Selection.End(xlDown).Select
                ActiveCell.Offset(1, 0).Select
                ActiveSheet.Paste
                
                Sheets("Route_Treatment").Select
                Rows("3:3").Select
                Range(Selection, Selection.End(xlDown)).Select
                Selection.ClearContents
            
                Sheets("Cable_Route").Select
                ActiveSheet.ShowAllData
                
            End If

            Sheets("Cable_Route").Select
            ActiveSheet.Range("$A$2:$DC$3800").AutoFilter Field:=Status + 6, Criteria1:= _
                Var
            Range("A1").Select
            
            Selection.End(xlDown).Select
            
            lin = ActiveCell.Row
            col = ActiveCell.Column
            Cells(lin, col).Select
            
            If lin = 2 Then
            
                Sheets("Cable_Route").Select
                ActiveSheet.ShowAllData
            
            End If
                
            If lin <> 2 Then
    
                Rows("2:2").Select
                Range(Selection, Selection.End(xlDown)).Select
                Selection.Copy
                
                Sheets("Route_Treatment").Select
                Rows("2:2").Select
                ActiveSheet.Paste
                Application.CutCopyMode = False
                
                Range("A4").Select
                
                lin = ActiveCell.Row
                col = ActiveCell.Column
                Cells(lin, col).Select
                
                test = Cells(lin, col)
                
                If test = "" Then
        
                    Rows("3:3").Select
                    Selection.Copy
                    
                Else
                
                    Rows("3:3").Select
                    Range(Selection, Selection.End(xlDown)).Select
                    Selection.Copy
                
                End If
           
                Sheets("Rota de Cabos").Select
                Range("A1").Select
                
                Selection.End(xlDown).Select
                ActiveCell.Offset(1, 0).Select
                Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
                :=False, Transpose:=False
                
                Sheets("Cable_Route").Select
                ActiveSheet.ShowAllData
    
            End If
            
        End If
    Loop
    
        Sheets("Filter").Select

        Range("B4").Select
        
        Do While ActiveCell <> Empty
            Sheets("Filter").Select
            ActiveCell.Offset(1, 0).Select
            
            lin = ActiveCell.Row
            col = ActiveCell.Column
            Cells(lin, col).Select
            
            Var = Cells(lin, col)
        
            If Var <> "" Then
            
                Sheets("Rota de Cabos").Select
            
                Columns("D:I").Select
                Selection.FormatConditions.Add Type:=xlTextString, String:=Var & "*", _
                    TextOperator:=xlContains
                Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
                With Selection.FormatConditions(1).Font
                    .Color = -16383844
                    .TintAndShade = 0
                End With
                With Selection.FormatConditions(1).Interior
                    .PatternColorIndex = xlAutomatic
                    .Color = 13551615
                    .TintAndShade = 0
                End With
                Selection.FormatConditions(1).StopIfTrue = False
                Range("AN8").Select
            
            End If
    
        Loop
    
    
    

End If

'--------------------------------------

If Status = 4 Then

    Do While ActiveCell <> Empty
        Sheets("Filter").Select
    
        ActiveCell.Offset(1, 0).Select
        
        lin = ActiveCell.Row
        col = ActiveCell.Column
        Cells(lin, col).Select
        
        Var = Cells(lin, col)

        For a = 1 To 27
   
            If Var <> "" Then

                Sheets("Cable_Route").Select
                ActiveSheet.Range("$A$2:$DC$3800").AutoFilter Field:=a + 10, Criteria1:= _
                    Var & "*"
                
                Range("A1").Select
                
                Selection.End(xlDown).Select
                
                lin = ActiveCell.Row
                col = ActiveCell.Column
                Cells(lin, col).Select
                
                If lin = 2 Then
                
                    Sheets("Cable_Route").Select
                    ActiveSheet.ShowAllData
                
                End If
                
                If lin <> 2 Then
    
                    Rows("2:2").Select
                    Range(Selection, Selection.End(xlDown)).Select
                    Selection.Copy
                    
                    Sheets("Route_Treatment").Select
                    Rows("2:2").Select
                    ActiveSheet.Paste
                    Application.CutCopyMode = False

                    Range("A4").Select
                
                    lin = ActiveCell.Row
                    col = ActiveCell.Column
                    Cells(lin, col).Select
                    
                    test = Cells(lin, col)
                    
                    If test = "" Then
            
                        Rows("3:3").Select
                        Selection.Copy
                        
                    Else
                    
                        Rows("3:3").Select
                        Range(Selection, Selection.End(xlDown)).Select
                        Selection.Copy
                    
                    End If
 
                    Sheets("Rota de Cabos").Select
                    Range("A1").Select
                    
                    Selection.End(xlDown).Select
                    ActiveCell.Offset(1, 0).Select
                    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
                    :=False, Transpose:=False
                    
                    Sheets("Route_Treatment").Select
                    Rows("3:3").Select
                    Range(Selection, Selection.End(xlDown)).Select
                    Selection.ClearContents
                
                    Sheets("Cable_Route").Select
                    ActiveSheet.ShowAllData
                    
                End If
            End If
        Next a
    Loop

        Sheets("Filter").Select

        Range("B4").Select
        
        Do While ActiveCell <> Empty
            Sheets("Filter").Select
            ActiveCell.Offset(1, 0).Select
            
            lin = ActiveCell.Row
            col = ActiveCell.Column
            Cells(lin, col).Select
            
            Var = Cells(lin, col)
        
            If Var <> "" Then
            
                Sheets("Rota de Cabos").Select
            
                Columns("K:AK").Select
                Selection.FormatConditions.Add Type:=xlTextString, String:=Var & "*", _
                    TextOperator:=xlContains
                Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
                With Selection.FormatConditions(1).Font
                    .Color = -16383844
                    .TintAndShade = 0
                End With
                With Selection.FormatConditions(1).Interior
                    .PatternColorIndex = xlAutomatic
                    .Color = 13551615
                    .TintAndShade = 0
                End With
                Selection.FormatConditions(1).StopIfTrue = False
                Range("AN8").Select
            
            End If
    
        Loop

End If

'----------------------------------------

    If Status = 1 Or Status = 2 Or Status = 3 Then
    
    Sheets("Rota de Cabos").Select
    Range("A1").Select
    
        MsgBox "Processo Realizado!"
        
    End If
    
    If Status = 4 Then
    
    Sheets("Rota de Cabos").Select
    Range("K2").Select
    
        MsgBox "Processo Realizado!"
        
    End If
    
    Sheets("Route_Treatment").Select
    ActiveWindow.SelectedSheets.Visible = False
    
    Application.ScreenUpdating = True
    
    
End Sub


Sub lipa()

Application.ScreenUpdating = False

    Sheets("Rota de Cabos").Select
    Rows("3:3").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.ClearContents
    Range("A1").Select
    Cells.FormatConditions.Delete
    Range("A1").Select

    Sheets("Filter").Select
    Range("B5").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.ClearContents
    Range("G2").Select
    
    Application.ScreenUpdating = True
    
End Sub




Solicitação de Férias

22/10/2018 = 26/10/2018
25/03/2019 = 08/04/2019
24/06/2019 = 03/07/2019




'=================================================================

    Do While ActiveCell <> Empty
    ActiveCell.Offset(1, 0).Select
    Loop
    


=============================

Sub Esconde()

    Sheets("Meta_Filtro").Select
    ActiveWindow.SelectedSheets.Visible = False
    
    Sheets("General_PL").Select
    ActiveWindow.SelectedSheets.Visible = False
    
    Sheets("General_IR").Select
    ActiveWindow.SelectedSheets.Visible = False
    
    Sheets("General_PL_Trata").Select
    ActiveWindow.SelectedSheets.Visible = False
    
    Sheets("General_IR_Trata").Select
    ActiveWindow.SelectedSheets.Visible = False
    
    Sheets("General_IR_Trata_CTC").Select
    ActiveWindow.SelectedSheets.Visible = False
    
    Sheets("List").Select
    ActiveWindow.SelectedSheets.Visible = False
    
    Sheets("Cabo_Pago").Select
    ActiveWindow.SelectedSheets.Visible = False
    
    Sheets("Consolidado").Select
    ActiveWindow.SelectedSheets.Visible = False
    
    Sheets("Index").Select
    ActiveWindow.SelectedSheets.Visible = False
    
    Sheets("Matrice_Catalogue").Select
    ActiveWindow.SelectedSheets.Visible = False
    
    Sheets("Catalog_Trata1").Select
    ActiveWindow.SelectedSheets.Visible = False
    
    Sheets("Matrice_Trata").Select
    ActiveWindow.SelectedSheets.Visible = False

End Sub

Sub Mostra()

    Sheets("Meta_Filtro").Visible = True
    
    Sheets("General_PL").Visible = True
    
    Sheets("General_IR").Visible = True
    
    Sheets("General_PL_Trata").Visible = True
    
    Sheets("General_IR_Trata").Visible = True
    
    Sheets("General_IR_Trata_CTC").Visible = True
    
    Sheets("List").Visible = True
    
    Sheets("Cabo_Pago").Visible = True

    Sheets("Consolidado").Visible = True

    Sheets("Index").Visible = True
 
    Sheets("Matrice_Catalogue").Visible = True
    
    Sheets("Catalog_Trata1").Visible = True
    
     Sheets("Matrice_Trata").Visible = True

End Sub

=======================================

Sub GerarListaPL()

'Application.ScreenUpdating = False

Call Mostra

Dim IM_0 As Integer
Dim IM_H As Integer
Dim IM_HH As Integer
Dim IM_S As Integer
Dim Qt_Equipament As Integer


Sheets("CTE_IMPORT").Select
Range("A1").Select

Sheets("PRODUCT_IMPORT").Select
Range("A1").Select
ActiveCell.Offset(1, 0).Select

' Trata meta --------------------------------------------
Sheets("Meta").Select

Rows("1:1").Select
Range(Selection, Selection.End(xlDown)).Select
Selection.Copy

Sheets("Meta_Filtro").Select
Rows("1:1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
   
'Conta Colunas -------------------------------------------
Range("A1").Select
Selection.End(xlDown).Select

lin = ActiveCell.Row
col = ActiveCell.Column
Cells(lin, col).Select

Num_Prod = lin

Range("B1").Select
'------------------------------------
'Levanta dados ----------------------

For CARGA = 1 To Num_Prod - 1
' ------------------------------------------------------------
    Sheets("Meta_Filtro").Select
    
    ActiveCell.Offset(1, 0).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    IM = Cells(lin, col)
    
    ActiveCell.Offset(0, 1).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    PM = Cells(lin, col)
    
    ActiveCell.Offset(0, 5).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    SBR = Cells(lin, col)
    
    ActiveCell.Offset(0, -6).Select
    
    Sheets("General_PL").Select

    Selection.End(xlDown).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    cont = lin
        
    Selection.End(xlUp).Select
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select

    ActiveSheet.Range(Cells(lin, col), Cells(cont, col)).AutoFilter Field:=4, Criteria1:= _
        "LPR-" & IM

    Rows("1:1").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Copy
    Sheets("General_PL_Trata").Select
    Rows("1:1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        
    ActiveWorkbook.Worksheets("General_PL_Trata").AutoFilter.Sort.SortFields.Add _
    Key:=Range("I1"), SortOn:=xlSortOnValues, Order:=xlAscending, _
    DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("General_PL_Trata").AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With

        '------------------------------------------------------------------------------------------
    
varColuna = 1 ' Coluna que será verificado
varLinha = 1 ' Linha inicial que será verificado
varConteudo = 1

Do While varConteudo <> Empty 'continua a verificar se conteudo for diferente de vazio
   varLinha = varLinha + 1 'contador de linha
   varConteudo = Cells(varLinha, varColuna).Value 'grava o valor da celula
Loop


Linha_Contada = CStr(varLinha - 1)
 
    With Sheets("General_PL_Trata")
        MyVarIM = WorksheetFunction.CountIf(.Range("I:I"), IM) 'Conte SE
    End With
    
    With Sheets("General_PL_Trata")
        MyVarIMH = WorksheetFunction.CountIf(.Range("I:I"), IM & "H")
    End With
    
    With Sheets("General_PL_Trata")
        MyVarIMHH = WorksheetFunction.CountIf(.Range("I:I"), IM & "HH")
    End With
    
    With Sheets("General_PL_Trata")
        MyVarIMS = WorksheetFunction.CountIf(.Range("I:I"), IM & "S")
    End With
    
    Qt_Equipament = MyVarIM + MyVarIMH + MyVarIMHH + MyVarIMS
    
    If MyVarIM <> False Then
        IM_0 = "1"
    End If
    
    If MyVarIMH <> False Then
        IM_H = "1"
    End If
    
    If MyVarIMHH <> False Then
        IM_HH = "1"
    End If
    
    If MyVarIMS <> False Then
        IM_S = "1"
    End If
 

    Qt_Equipament = IM_0 + IM_H + IM_HH + IM_S

    Qt_Total = MyVarIM + MyVarIMH + MyVarIMHH + MyVarIMS

    Qt_Soma = (Linha_Contada - 1) - Qt_Total

    Qt_Variable = Qt_Soma + Qt_Equipament

    Sheets("General_PL_Trata").Select
    Range("I1").Select
    
    For Varre = 1 To Qt_Variable
    
            Sheets("General_PL_Trata").Select
            
            ActiveCell.Offset(1, 0).Select
            
            lin = ActiveCell.Row
            col = ActiveCell.Column
            Cells(lin, col).Select
            
            Test_Empty = Cells(lin, col)
            
            If Test_Empty <> 0 Then

                lin = ActiveCell.Row
                col = ActiveCell.Column
                Cells(lin, col).Select
                
                IM = Cells(lin, col)
                IM_Test = Right(IM, 2)
                
                IM_Test_OK = Left(IM_Test, 1)
    
                Selection.End(xlToLeft).Select
                Selection.End(xlToLeft).Select
                Selection.End(xlToLeft).Select
                Selection.End(xlToLeft).Select
                
                ActiveCell.Offset(0, 3).Select
            
                lin = ActiveCell.Row
                col = ActiveCell.Column
                Cells(lin, col).Select
                
                IM_LPR = Cells(lin, col)
                IM_LPR_NUM = Right(IM_LPR, 1)
    
                ActiveCell.Offset(0, 5).Select
                
                
                'MsgBox IM_Test & "/" & IM_Test_OK & "/" & IM_LPR_NUM

                'If IM_Test = IM_Test_OK & IM_LPR_NUM Then
                If IM_Test <> "" Then

                    With Sheets("General_PL_Trata")
                        MyVar = WorksheetFunction.CountIf(.Range("I:I"), IM)
                    End With

                    lin = ActiveCell.Row
                    col = ActiveCell.Column
                    Cells(lin, col).Select
                    
                    IM_PAI = Cells(lin, col)
                    
                    ActiveCell.Offset(0, -3).Select
                    
                    lin = ActiveCell.Row
                    col = ActiveCell.Column
                    Cells(lin, col).Select
                    
                    RP_FILHO_1 = Cells(lin, col)
                    
                    RP_FILHO_LIMPA = Left(RP_FILHO_1, 12)
                    RP_FILHO = Right(RP_FILHO_LIMPA, 8)
        
                    ActiveCell.Offset(0, 1).Select
                    
                    lin = ActiveCell.Row
                    col = ActiveCell.Column
                    Cells(lin, col).Select
        
                    TEXTO = Cells(lin, col)
                    
                    ActiveCell.Offset(0, 3).Select
                    
                    lin = ActiveCell.Row
                    col = ActiveCell.Column
                    Cells(lin, col).Select
        
                    CMX = Cells(lin, col)
                    
                    ActiveCell.Offset(0, 7).Select
                    
                    lin = ActiveCell.Row
                    col = ActiveCell.Column
                    Cells(lin, col).Select
        
                    UN = Cells(lin, col)
                    
                    ActiveCell.Offset(0, 4).Select
                    
                    lin = ActiveCell.Row
                    col = ActiveCell.Column
                    Cells(lin, col).Select
        
                    MAS = Cells(lin, col)
                    
                    ActiveCell.Offset(0, 2).Select
                    
                    lin = ActiveCell.Row
                    col = ActiveCell.Column
                    Cells(lin, col).Select
        
                    DES = Cells(lin, col)
                    
                    Selection.End(xlToLeft).Select
                    Selection.End(xlToLeft).Select
                    Selection.End(xlToLeft).Select
                    Selection.End(xlToLeft).Select
                    Selection.End(xlToLeft).Select
                    Selection.End(xlToLeft).Select
                    Selection.End(xlToLeft).Select
                    
                    Sheets("PRODUCT_IMPORT").Select

                    ActiveCell.FormulaR1C1 = IM_LPR
                    ActiveCell.Offset(0, 1).Select
                    ActiveCell.FormulaR1C1 = SBR & IM_PAI
                    ActiveCell.Offset(0, 1).Select
                    ActiveCell.FormulaR1C1 = SBR & RP_FILHO
                    ActiveCell.Offset(0, 1).Select
                    ActiveCell.FormulaR1C1 = CMX
                    ActiveCell.Offset(0, 1).Select
                    ActiveCell.FormulaR1C1 = "1"
                    ActiveCell.Offset(0, 1).Select
                    ActiveCell.FormulaR1C1 = TEXTO
                    ActiveCell.Offset(0, 1).Select
                    ActiveCell.FormulaR1C1 = "-"
                    ActiveCell.Offset(0, 1).Select
                    ActiveCell.FormulaR1C1 = "-"
                    ActiveCell.Offset(0, 1).Select
                    ActiveCell.FormulaR1C1 = "I"
                    ActiveCell.Offset(0, 1).Select
                    ActiveCell.FormulaR1C1 = UN
                    ActiveCell.Offset(0, 9).Select
                    ActiveCell.FormulaR1C1 = MAS
                    ActiveCell.Offset(0, 1).Select
                    ActiveCell.FormulaR1C1 = DES
                    
                    Selection.End(xlToLeft).Select
                    Selection.End(xlToLeft).Select
                    Selection.End(xlToLeft).Select
                    Selection.End(xlToLeft).Select
                    Selection.End(xlToLeft).Select
                    Selection.End(xlToLeft).Select
                    Selection.End(xlToLeft).Select
                    Selection.End(xlToLeft).Select
                    Selection.End(xlToLeft).Select
                    Selection.End(xlToLeft).Select
                    Selection.End(xlToLeft).Select
                    
                    ActiveCell.Offset(1, 0).Select
        
                    Sheets("General_PL_Trata").Select
                    
                    Selection.End(xlToLeft).Select
                    
                    ActiveCell.Offset(-1, 0).Select
                    ' ---------------------------------------------
                    For Replay = 1 To MyVar
                    
                        Sheets("General_PL_Trata").Select
                
                        ActiveCell.Offset(1, 15).Select
                        'ActiveCell.Offset(Replay - 1, 15).Select
                        
                        lin = ActiveCell.Row
                        col = ActiveCell.Column
                        Cells(lin, col).Select
                        
                        qt = Cells(lin, col)
                        
                        ActiveCell.Offset(0, 1).Select
                        
                        lin = ActiveCell.Row
                        col = ActiveCell.Column
                        Cells(lin, col).Select
                        
                        EA = Cells(lin, col)
                        
                        ActiveCell.Offset(0, 2).Select
                        
                        lin = ActiveCell.Row
                        col = ActiveCell.Column
                        Cells(lin, col).Select
                        
                        CMX_FILHO = Cells(lin, col)
                        
                        ActiveCell.Offset(0, 1).Select
                        
                        lin = ActiveCell.Row
                        col = ActiveCell.Column
                        Cells(lin, col).Select
                        
                        Designation = Cells(lin, col)

                        ActiveCell.Offset(0, 2).Select
                        
                        lin = ActiveCell.Row
                        col = ActiveCell.Column
                        Cells(lin, col).Select
            
                        DES = Cells(lin, col)
    
                        Selection.End(xlToLeft).Select
                        Selection.End(xlToLeft).Select
                        Selection.End(xlToLeft).Select
                        Selection.End(xlToLeft).Select
                        Selection.End(xlToLeft).Select
                        Selection.End(xlToLeft).Select
                        Selection.End(xlToLeft).Select
                        Selection.End(xlToLeft).Select
                        Selection.End(xlToLeft).Select
                        Selection.End(xlToLeft).Select
                        
                        Sheets("PRODUCT_IMPORT").Select
                
                        ActiveCell.FormulaR1C1 = IM_LPR
                        ActiveCell.Offset(0, 1).Select
                        ActiveCell.FormulaR1C1 = "-"
                        ActiveCell.Offset(0, 1).Select
                        ActiveCell.FormulaR1C1 = "-"
                        ActiveCell.Offset(0, 1).Select
                        ActiveCell.FormulaR1C1 = CMX_FILHO
                        ActiveCell.Offset(0, 1).Select
                        ActiveCell.FormulaR1C1 = qt
                        ActiveCell.Offset(0, 1).Select
                        ActiveCell.FormulaR1C1 = Designation
                        ActiveCell.Offset(0, 1).Select
                        ActiveCell.FormulaR1C1 = "-"
                        ActiveCell.Offset(0, 1).Select
                        ActiveCell.FormulaR1C1 = "-"
                        ActiveCell.Offset(0, 1).Select
                        ActiveCell.FormulaR1C1 = "I"
                        ActiveCell.Offset(0, 1).Select
                        ActiveCell.FormulaR1C1 = EA
                        ActiveCell.Offset(0, 9).Select
                        ActiveCell.FormulaR1C1 = MAS
                        ActiveCell.Offset(0, 1).Select
                        ActiveCell.FormulaR1C1 = DES
                        
                        Selection.End(xlToLeft).Select
                        Selection.End(xlToLeft).Select
                        Selection.End(xlToLeft).Select
                        Selection.End(xlToLeft).Select
                        Selection.End(xlToLeft).Select
                        Selection.End(xlToLeft).Select
                        Selection.End(xlToLeft).Select
                        
                        ActiveCell.Offset(1, 0).Select
                        
                        '---------------------------------
                    
                    Next Replay
        
                    Sheets("General_PL_Trata").Select
                    
                    ActiveCell.Offset(0, 8).Select
                
                End If
            '====================================================

            End If

        Next Varre

        Sheets("General_PL_Trata").Select
        Rows("2:2").Select
        Range(Selection, Selection.End(xlDown)).Select
        Application.CutCopyMode = False
        Selection.ClearContents
        Range("A1").Select
        
        Sheets("General_PL").Select
        ActiveSheet.Range(Cells(lin, col), Cells(cont, col)).AutoFilter Field:=4
        Range("A1").Select
        
    Next CARGA
    
    Call GerarListaIR
        
    Call Esconde
    
    Sheets("PRODUCT_IMPORT").Select
    Range("A1").Select
    
    Cells.Replace What:="LPR-", Replacement:=SBR, LookAt:=xlPart, _
    SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
    ReplaceFormat:=False
    
    Range("A1").Select
    
    Call VerificaLMA
    
    Range("A1").Select
    
    'MsgBox "Tarefa Realizada Com Sucesso!"
    
    Application.ScreenUpdating = True

End Sub

Sub VerificaLMA()

    Sheets("PRODUCT_IMPORT").Select
    Range("L2").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RIGHT(LEFT(RC[-8],8),1)=""A"",""Atenção, verificar procedimento de decomposição de CMX"",IF(RIGHT(LEFT(RC[-8],8),1)=""F"",""Atenção, verificar procedimento de decomposição de CMX"",""""))"
    Selection.AutoFill Destination:=Range("L2:L120")

End Sub


Sub ClearPL()
'
' Limpa Tudo
'
    Call Mostra
    
    Sheets("Meta_Filtro").Select
    Rows("2:2").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.ClearContents
    Range("A1").Select
    
    Sheets("General_PL").Select
    ActiveSheet.Rows("2:2").AutoFilter Field:=4
    Range("A1").Select
    
    Sheets("General_PL_Trata").Select
    Rows("2:2").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.ClearContents
    Range("A1").Select
    
    Sheets("PRODUCT_IMPORT").Select
    Rows("2:2").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.ClearContents
    Range("A1").Select
    
    Call ClearIR
    
    Call Esconde
    
    Sheets("Meta").Select
    Range("A1").Select

End Sub

Sub Chamar()

UserForm1.Show

End Sub

Sub PartListIMZ()

    'Call Mostra
    
    Sheets("General_PL").Select
    Cells.Select
    Selection.ClearContents
    
    Windows("PartListGeralIMZ.csv").Activate
    Cells.Select
    Selection.Copy
    
    Windows("Carga_IMZ_Beta004.xlsm").Activate
    Cells.Select
    ActiveSheet.Paste
    Cells.Select
    Cells.EntireColumn.AutoFit
    Rows("1:1").Select
    Application.CutCopyMode = False
    Selection.AutoFilter
    Range("A1").Select
    
    Windows("PartListGeralIMZ.csv").Activate
    ActiveWindow.Close

    'Call Esconde
    
    Sheets("Meta").Select
    Range("A1").Select
    
    
 
End Sub


Sub InspIMZ()

    'Call Mostra
    
    Sheets("General_IR").Select
    Cells.Select
    Selection.ClearContents
    
    Windows("Insp request B26.CSV").Activate
    Cells.Select
    Selection.Copy
    
    Windows("Carga_IMZ_Beta004.xlsm").Activate
    Cells.Select
    ActiveSheet.Paste
    Cells.Select
    Cells.EntireColumn.AutoFit
    Rows("1:1").Select
    Application.CutCopyMode = False
    Selection.AutoFilter
    Range("A1").Select
    
    Windows("Insp request B26.CSV").Activate
    ActiveWindow.Close
    
    
    'Call Esconde
    
    Sheets("Meta").Select
    Range("A1").Select
    
    
End Sub







=================



















======================================


Sub testeArquivoAbrir()

Dim strPDF_File_Name As String
strPDF_File_Name = "W:\DIN\GD\INT\02_INTERNO\alexsandro.oliveira\My_Notebooks\CC-200526-30700-11-011_0\12 - Templates de Inspeções\E01\CTE00773586.pdf"

'strPDF_File_Name = Application.GetOpenFilename(". . Arquivos PDF *, pdf , todos os arquivos * * ", 1, " Open File ", False)

ActiveWorkbook.FollowHyperlink strPDF_File_Name


==============
    Selection.End(xlDown).Select
    Selection.End(xlUp).Select
    Selection.End(xlToRight).Select
    Selection.End(xlToLeft).Select


    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlUp)).Select
    Range(Selection, Selection.End(xlToRight)).Select
    Range(Selection, Selection.End(xlToLeft)).Select



=============




Private Sub CommandButton1_Click()
    VET = ComboBox4
    Sheets("CADASTRO").Select
    Cells.Find(what:=VET).Activate
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    nome = Cells(lin, col)
    
    Sheets("DIETA").Select
    
    Range("B2").Select
    ActiveCell.FormulaR1C1 = "NOME: " & nome
    
    Range("B7").Select
    ActiveCell.FormulaR1C1 = TextBox17.Text
    
    Range("C7").Select
    ActiveCell.FormulaR1C1 = TextBox18.Text
    
    Range("D7").Select
    ActiveCell.FormulaR1C1 = TextBox19.Text
    
    Range("B13").Select
    ActiveCell.FormulaR1C1 = TextBox20.Text
    
    Range("C13").Select
    ActiveCell.FormulaR1C1 = TextBox21.Text
    
    Range("D13").Select
    ActiveCell.FormulaR1C1 = TextBox22.Text
    
    Range("B16").Select
    ActiveCell.FormulaR1C1 = TextBox23.Text
    
    Range("C16").Select
    ActiveCell.FormulaR1C1 = TextBox24.Text
    
    Range("D16").Select
    ActiveCell.FormulaR1C1 = TextBox25.Text
    
    Range("B24").Select
    ActiveCell.FormulaR1C1 = TextBox26.Text
    
    Range("C24").Select
    ActiveCell.FormulaR1C1 = TextBox27.Text
    
    Range("D24").Select
    ActiveCell.FormulaR1C1 = TextBox28.Text
    
    Range("B29").Select
    ActiveCell.FormulaR1C1 = TextBox29.Text
    
    Range("C29").Select
    ActiveCell.FormulaR1C1 = TextBox30.Text
    
    Range("D29").Select
    ActiveCell.FormulaR1C1 = TextBox21.Text
    
    Range("B36").Select
    ActiveCell.FormulaR1C1 = TextBox32.Text
    
    Range("C36").Select
    ActiveCell.FormulaR1C1 = TextBox33.Text
    
    Range("D36").Select
    ActiveCell.FormulaR1C1 = TextBox34.Text
    
    Range("F1").Select
    Data = Range("F1")

    Range("G1").Select
    ActiveCell.FormulaR1C1 = "DATA: " & Data
    
    Application.CutCopyMode = False
    Range("H1").Select
    
    ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _
    IgnorePrintAreas:=False


End Sub

Private Sub CommandButton2_Click()
    
    TextBox17.Text = ""
    TextBox18.Text = ""
    TextBox19.Text = ""
    TextBox20.Text = ""
    TextBox21.Text = ""
    TextBox22.Text = ""
    TextBox23.Text = ""
    TextBox24.Text = ""
    TextBox25.Text = ""
    TextBox26.Text = ""
    TextBox27.Text = ""
    TextBox28.Text = ""
    TextBox29.Text = ""
    TextBox30.Text = ""
    TextBox31.Text = ""
    TextBox32.Text = ""
    TextBox33.Text = ""
    TextBox34.Text = ""
    
    Sheets("DIETA").Select
    
    Range("B2").Select
    ActiveCell.FormulaR1C1 = "NOME: " & nome
    
    Range("B7").Select
    ActiveCell.FormulaR1C1 = TextBox17.Text
    
    Range("C7").Select
    ActiveCell.FormulaR1C1 = TextBox18.Text
    
    Range("D7").Select
    ActiveCell.FormulaR1C1 = TextBox19.Text
    
    Range("B13").Select
    ActiveCell.FormulaR1C1 = TextBox20.Text
    
    Range("C13").Select
    ActiveCell.FormulaR1C1 = TextBox21.Text
    
    Range("D13").Select
    ActiveCell.FormulaR1C1 = TextBox22.Text
    
    Range("B16").Select
    ActiveCell.FormulaR1C1 = TextBox23.Text
    
    Range("C16").Select
    ActiveCell.FormulaR1C1 = TextBox24.Text
    
    Range("D16").Select
    ActiveCell.FormulaR1C1 = TextBox25.Text
    
    Range("B24").Select
    ActiveCell.FormulaR1C1 = TextBox26.Text
    
    Range("C24").Select
    ActiveCell.FormulaR1C1 = TextBox27.Text
    
    Range("D24").Select
    ActiveCell.FormulaR1C1 = TextBox28.Text
    
    Range("B29").Select
    ActiveCell.FormulaR1C1 = TextBox29.Text
    
    Range("C29").Select
    ActiveCell.FormulaR1C1 = TextBox30.Text
    
    Range("D29").Select
    ActiveCell.FormulaR1C1 = TextBox21.Text
    
    Range("B36").Select
    ActiveCell.FormulaR1C1 = TextBox32.Text
    
    Range("C36").Select
    ActiveCell.FormulaR1C1 = TextBox33.Text
    
    Range("D36").Select
    ActiveCell.FormulaR1C1 = TextBox34.Text
    
    Range("F1").Select
    Data = Range("F1")

    Range("G1").Select
    ActiveCell.FormulaR1C1 = "DATA: " & Data
    
    Application.CutCopyMode = False
    Range("H1").Select
    
End Sub


Private Sub CommandButton3_Click()
UserForm1.Show
End Sub

Private Sub CommandButton4_Click()
Application.Visible = True
End Sub

Private Sub CommandButton5_Click() ' fecha tudo
    
    Application.DisplayAlerts = True
    ActiveWorkbook.Close Savechanges:=True
    Application.DisplayAlerts = True
    Application.Quit
    
End Sub

Private Sub ToggleButton1_Click() ' Selecionar Alimentos
    Sheets("RELATÓRIO").Select
    Range("A2:C2").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.ClearContents
    Application.CutCopyMode = False
    
    VET = Label98.Caption

    Cells.Find(what:=VET).Activate
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    ActiveCell.Offset(-1, 1).Select
    
    Do While ActiveCell <> Empty
    ActiveCell.Offset(1, 0).Select
    Loop
    
    ActiveCell.Offset(-1, 0).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    quant = lin
    
    Selection.End(xlUp).Select
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    ActiveSheet.Range(Cells(lin, col), Cells(quant, col + 2)).Select
    Selection.Copy
    
    Range("A1").Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Range("A1").Select
    
    ' -----------------------------

    If (ComboBox1 <> "" And TextBox1 <> "") Then
        valorAL = ComboBox1
        valorQT = TextBox1
        Range("B1").Select
        
        Do While ActiveCell <> Empty
        ActiveCell.Offset(1, 0).Select
        Loop
        
        ActiveCell.FormulaR1C1 = valorAL
        
        Range("C1").Select
        
        Do While ActiveCell <> Empty
        ActiveCell.Offset(1, 0).Select
        Loop
        
        ActiveCell.FormulaR1C1 = valorQT

        Range("B1").Select
        Selection.End(xlDown).Select
          
        lin = ActiveCell.Row
        col = ActiveCell.Column
        Cells(lin, col).Select
        
        quant = lin - 1
    
        Range("A2").Select
        For cont = 1 To quant
            ActiveCell.Value = cont
            ActiveCell.Offset(1, 0).Select
        Next cont
        
    End If
    ' ------------ seleciona alimentos para por no ListBox2
    
    Call ListaAlimentos
    
    ComboBox1.Clear
    
    linha = 2
    Do Until Planilha2.Cells(linha, 2) = ""
    ComboBox1.AddItem Planilha2.Cells(linha, 2)
    linha = linha + 1
    Loop

End Sub

Private Sub ListaAlimentos()

    Do While ActiveCell <> Empty
    ActiveCell.Offset(1, 0).Select
    Loop
    
    ActiveCell.Offset(-1, 0).Select
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select

    quant = lin

    Selection.End(xlUp).Select

    With ThisWorkbook.Worksheets("RELATÓRIO")
        lin = ActiveCell.Row
        col = ActiveCell.Column
        Cells(lin, col).Select
        ActiveSheet.Range(Cells(lin, col), Cells(quant, col + 2)).Select

        Set ali = .Range(Cells(lin, col), Cells(lin + quant, col + 2))
        Me.ListBox2.ColumnCount = ali.Columns.Count
        Me.ListBox2.RowSource = ali.Address(, , , True, ali.Parent.Range("A1"))
        Me.ListBox2.TextAlign = fmTextAlignCenter
        Me.ListBox2.ColumnWidths = "35;140;25"
        Me.ListBox2.Font.Size = 10
        Me.ListBox2.Font.Name = "Verdana"
        Me.ListBox2.BoundColumn = 10

    End With

    Range("A1").Select
    Application.CutCopyMode = False
    
End Sub

Private Sub ToggleButton10_Click() 'alterar cadastro

        Sheets("CADASTRO").Select
        val_nome = TextBox10
        val_altura = TextBox11
        val_peso = TextBox12
        val_idade = TextBox13
        val_sexo = ComboBox6
        
        If (TextBox10 <> "") Then
            Range("B2").Select
            ActiveCell.FormulaR1C1 = val_nome
        End If
        
        If (TextBox11 <> "") Then
            Range("B3").Select
            ActiveCell.FormulaR1C1 = val_altura
        End If
        
        If (TextBox12 <> "") Then
            Range("B4").Select
            ActiveCell.FormulaR1C1 = val_peso
        End If
        
        If (TextBox13 <> "") Then
            Range("B5").Select
            ActiveCell.FormulaR1C1 = val_idade
        End If
        
        If (ComboBox6 <> "") Then
            Range("B6").Select
            ActiveCell.FormulaR1C1 = val_sexo
        End If
        
val_alturacm = val_altura * 100
val_IMC = val_peso / (val_altura * val_altura)
val_Ideal1 = (val_altura * val_altura) * 18.5
val_Ideal2 = (val_altura * val_altura) * 24.9

    If (ComboBox5 = "Sedentário" And ComboBox6 = "M") Then
        val_atividade = 1.2
        val_SexoM = 66.5 + (13.75 * peso) + (5 * val_alturacm) - (6.7 * val_idade)
        val_result = val_SexoM * val_atividade
        val_id1 = Format(val_Ideal1, "0.0")
        val_id2 = Format(val_Ideal2, "0.0")
        sexo_val = val_SexoM
    End If
        
    If (ComboBox5 = "Sedentário" And ComboBox6 = "F") Then
        val_atividade = 1.2
        val_SexoF = 655.1 + (9.6 * val_peso) + (1.85 * val_alturacm) - (4.7 * val_idade)
        val_result = val_SexoF * val_atividade
        val_id1 = Format(val_Ideal1, "0.0")
        val_id2 = Format(val_Ideal2, "0.0")
        sexo_val = val_SexoF
    End If
    '-------------------------------------
    
    If (ComboBox5 = "Exercícios Leves" And ComboBox6 = "M") Then
        val_atividade = 1.375
        val_SexoM = 66.5 + (13.75 * peso) + (5 * val_alturacm) - (6.7 * val_idade)
        val_result = val_SexoM * val_atividade
        val_id1 = Format(val_Ideal1, "0.0")
        val_id2 = Format(val_Ideal2, "0.0")
        sexo_val = val_SexoM
    End If
    
    If (ComboBox5 = "Exercícios Leves" And ComboBox6 = "F") Then
        val_atividade = 1.375
        val_SexoF = 655.1 + (9.6 * val_peso) + (1.85 * val_alturacm) - (4.7 * val_idade)
        val_result = val_SexoF * val_atividade
        val_id1 = Format(val_Ideal1, "0.0")
        val_id2 = Format(val_Ideal2, "0.0")
        sexo_val = val_SexoF
    End If
    '-------------------------------------
    
    If (ComboBox5 = "Exercícios Moderados" And ComboBox6 = "M") Then
        val_atividade = 1.55
        val_SexoM = 66.5 + (13.75 * peso) + (5 * val_alturacm) - (6.7 * val_idade)
        val_result = val_SexoM * val_atividade
        val_id1 = Format(val_Ideal1, "0.0")
        val_id2 = Format(val_Ideal2, "0.0")
        sexo_val = val_SexoM
    End If
        
    If (ComboBox5 = "Exercícios Moderados" And ComboBox6 = "F") Then
        val_atividade = 1.55
        val_SexoF = 655.1 + (9.6 * val_peso) + (1.85 * val_alturacm) - (4.7 * val_idade)
        val_result = val_SexoF * val_atividade
        val_id1 = Format(val_Ideal1, "0.0")
        val_id2 = Format(val_Ideal2, "0.0")
        sexo_val = val_SexoF
    End If
    '-------------------------------------
    
    If (ComboBox5 = "Exercícios Pesados" And ComboBox6 = "M") Then
        val_atividade = 1.725
        val_SexoM = 66.5 + (13.75 * peso) + (5 * val_alturacm) - (6.7 * val_idade)
        val_result = val_SexoM * val_atividade
        val_id1 = Format(val_Ideal1, "0.0")
        val_id2 = Format(val_Ideal2, "0.0")
        sexo_val = val_SexoM
    End If
        
    If (ComboBox5 = "Exercícios Pesados" And ComboBox6 = "F") Then
        val_atividade = 1.725
        val_SexoF = 655.1 + (9.6 * val_peso) + (1.85 * val_alturacm) - (4.7 * val_idade)
        val_result = val_SexoF * val_atividade
        val_id1 = Format(val_Ideal1, "0.0")
        val_id2 = Format(val_Ideal2, "0.0")
        sexo_val = val_SexoF
    End If
    '-------------------------------------
    If (ComboBox5 = "Exercícios Muito Pesados" And ComboBox6 = "M") Then
        val_atividade = 1.9
        val_SexoM = 66.5 + (13.75 * peso) + (5 * val_alturacm) - (6.7 * val_idade)
        val_result = val_SexoM * val_atividade
        val_id1 = Format(val_Ideal1, "0.0")
        val_id2 = Format(val_Ideal2, "0.0")
        sexo_val = val_SexoM
    End If
        
    If (ComboBox5 = "Exercícios Muito Pesados" And ComboBox6 = "F") Then
        val_atividade = 1.9
        val_SexoF = 655.1 + (9.6 * val_peso) + (1.85 * val_alturacm) - (4.7 * val_idade)
        val_result = val_SexoF * val_atividade
        val_id1 = Format(val_Ideal1, "0.0")
        val_id2 = Format(val_Ideal2, "0.0")
        sexo_val = val_SexoF
    End If
    '-------------------------------------

        Range("B8").Select
        ActiveCell.FormulaR1C1 = val_IMC
        
        Range("B9").Select
        ActiveCell.FormulaR1C1 = sexo_val 'TMB
        
        Range("B10").Select
        ActiveCell.FormulaR1C1 = val_result 'GET
        
        Range("B11").Select
        ActiveCell.FormulaR1C1 = "(" & val_id1 & " - " & val_id2 & ")" ' P.Ideal

  '1.375 / 1.55 / 1.725 / 1.9

        '---------------------------- Copia e cola em ComboBox
        Range("B2").Select
        Selection.Copy
        
        cliente = Label128.Caption
        
        Cells.Find(what:=cliente).Activate
        lin = ActiveCell.Row
        col = ActiveCell.Column
        Cells(lin, col).Select
        
        ActiveCell.Offset(0, 0).Select
        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        Application.CutCopyMode = False
        Range("A1").Select
        '------------------------ Copia e cola em relatório
        
        Sheets("CADASTRO").Select
        Range("B2").Select
        Selection.Copy
        
        cliente = ComboBox4
        Sheets("RELATÓRIO").Select
        Cells.Find(what:=cliente).Activate
        lin = ActiveCell.Row
        col = ActiveCell.Column
        Cells(lin, col).Select
        
        ActiveCell.Offset(0, 0).Select
        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        Application.CutCopyMode = False
        Range("A1").Select

        '----------------------- Copia e cola em registro
        
        Sheets("CADASTRO").Select
        Range("B2:B11").Select
        Selection.Copy
        
        cliente = Label128.Caption
        Sheets("REGISTRO").Select
        Cells.Find(what:=cliente).Activate
        lin = ActiveCell.Row
        col = ActiveCell.Column
        Cells(lin, col).Select
        
        ActiveCell.Offset(0, 0).Select
        ActiveSheet.Paste
        Application.CutCopyMode = False
        Range("A1").Select
        '-------------------------------------------
        
        ComboBox4.Clear
        
        linha = 1
        Do Until Planilha51.Cells(linha, 15) = ""
        ComboBox4.AddItem Planilha51.Cells(linha, 15)
        linha = linha + 1
        Loop
        
        Frame1.Visible = True
        
        MsgBox "CADASTRO ALTERADO COM SUCESSO!"

End Sub

Private Sub ToggleButton11_Click()
Frame1.Visible = False
Frame3.Visible = False
Frame4.Visible = True
End Sub

Private Sub ToggleButton13_Click() ' Chama aba de cadastramento

Frame3.Visible = True
Frame1.Visible = False
Frame4.Visible = False

End Sub


Private Sub ToggleButton3_Click()
'
'Cadastro de pacientes

    Sheets("CADASTRO").Select ' Limpa área de cadastro pra se escrver outra
    Range("B2:C11").Select
    Selection.ClearContents
    Range("A1").Select
    Application.CutCopyMode = False
   

altura = TextBox3
peso = TextBox4
idade = TextBox5
alturacm = altura * 100
IMC = peso / (altura * altura)
Ideal1 = (altura * altura) * 18.5
Ideal2 = (altura * altura) * 24.9

    If (ComboBox2 = "Sedentário") Then
        atividade = 1.2
        If (ComboBox3 = "M") Then
            SexoM = 66.5 + (13.75 * peso) + (5 * alturacm) - (6.7 * idade)
            result = SexoM * atividade
            id1 = Format(Ideal1, "0.0")
            id2 = Format(Ideal2, "0.0")
            
            Label92.Caption = IMC
            Label93.Caption = SexoM
            Label94.Caption = result
            Label95.Caption = "(" & id1 & " - " & id2 & ")"
            
            val_nome = TextBox2
    
            Sheets("CADASTRO").Select
            Range("B2").Select
            ActiveCell.FormulaR1C1 = val_nome
            
            Range("B3").Select
            ActiveCell.FormulaR1C1 = altura
            
            Range("B4").Select
            ActiveCell.FormulaR1C1 = peso
            
            Range("B5").Select
            ActiveCell.FormulaR1C1 = idade
            
            Range("B6").Select
            ActiveCell.FormulaR1C1 = "M"
            
            Range("B7").Select
            ActiveCell.FormulaR1C1 = "'--"
            
            Range("B8").Select
            ActiveCell.FormulaR1C1 = IMC
            
            Range("B9").Select
            ActiveCell.FormulaR1C1 = SexoM
            
            Range("B10").Select
            ActiveCell.FormulaR1C1 = result
            
            Range("B11").Select
            ActiveCell.FormulaR1C1 = "(" & id1 & " - " & id2 & ")"
            
        End If
 
        If (ComboBox3 = "F") Then
            SexoF = 655.1 + (9.6 * peso) + (1.85 * alturacm) - (4.7 * idade)
            result = SexoF * atividade
            id1 = Format(Ideal1, "0.0")
            id2 = Format(Ideal2, "0.0")
            
            Label92.Caption = IMC
            Label93.Caption = SexoF
            Label94.Caption = result
            Label95.Caption = "(" & id1 & " - " & id2 & ")"
        
            val_nome = TextBox2
    
            Sheets("CADASTRO").Select
            Range("B2").Select
            ActiveCell.FormulaR1C1 = val_nome
            
            Range("B3").Select
            ActiveCell.FormulaR1C1 = altura
            
            Range("B4").Select
            ActiveCell.FormulaR1C1 = peso
            
            Range("B5").Select
            ActiveCell.FormulaR1C1 = idade
            
            Range("B6").Select
            ActiveCell.FormulaR1C1 = "F"
            
            Range("B7").Select
            ActiveCell.FormulaR1C1 = "'--"
            
            Range("B8").Select
            ActiveCell.FormulaR1C1 = IMC
            
            Range("B9").Select
            ActiveCell.FormulaR1C1 = SexoF
            
            Range("B10").Select
            ActiveCell.FormulaR1C1 = result
            
            Range("B11").Select
            ActiveCell.FormulaR1C1 = "(" & id1 & " - " & id2 & ")"
        
        End If
    End If
'------------------------------------------------------

If (ComboBox2 = "Exercícios Leves") Then
    atividade = 1.375
        If (ComboBox3 = "M") Then
            SexoM = 66.5 + (13.75 * peso) + (5 * alturacm) - (6.7 * idade)
            result = SexoM * atividade
            id1 = Format(Ideal1, "0.0")
            id2 = Format(Ideal2, "0.0")
            
            Label92.Caption = IMC
            Label93.Caption = SexoM
            Label94.Caption = result
            Label95.Caption = "(" & id1 & " - " & id2 & ")"
            
            val_nome = TextBox2
    
            Sheets("CADASTRO").Select
            Range("B2").Select
            ActiveCell.FormulaR1C1 = val_nome
            
            Range("B3").Select
            ActiveCell.FormulaR1C1 = altura
            
            Range("B4").Select
            ActiveCell.FormulaR1C1 = peso
            
            Range("B5").Select
            ActiveCell.FormulaR1C1 = idade
            
            Range("B6").Select
            ActiveCell.FormulaR1C1 = "M"
            
            Range("B7").Select
            ActiveCell.FormulaR1C1 = "'--"
            
            Range("B8").Select
            ActiveCell.FormulaR1C1 = IMC
            
            Range("B9").Select
            ActiveCell.FormulaR1C1 = SexoM
            
            Range("B10").Select
            ActiveCell.FormulaR1C1 = result
            
            Range("B11").Select
            ActiveCell.FormulaR1C1 = "(" & id1 & " - " & id2 & ")"
            
        End If
 
        If (ComboBox3 = "F") Then
            SexoF = 655.1 + (9.6 * peso) + (1.85 * alturacm) - (4.7 * idade)
            result = SexoF * atividade
            id1 = Format(Ideal1, "0.0")
            id2 = Format(Ideal2, "0.0")
            
            Label92.Caption = IMC
            Label93.Caption = SexoF
            Label94.Caption = result
            Label95.Caption = "(" & id1 & " - " & id2 & ")"
        
            val_nome = TextBox2
    
            Sheets("CADASTRO").Select
            Range("B2").Select
            ActiveCell.FormulaR1C1 = val_nome
            
            Range("B3").Select
            ActiveCell.FormulaR1C1 = altura
            
            Range("B4").Select
            ActiveCell.FormulaR1C1 = peso
            
            Range("B5").Select
            ActiveCell.FormulaR1C1 = idade
            
            Range("B6").Select
            ActiveCell.FormulaR1C1 = "F"
            
            Range("B7").Select
            ActiveCell.FormulaR1C1 = "'--"
            
            Range("B8").Select
            ActiveCell.FormulaR1C1 = IMC
            
            Range("B9").Select
            ActiveCell.FormulaR1C1 = SexoF
            
            Range("B10").Select
            ActiveCell.FormulaR1C1 = result
            
            Range("B11").Select
            ActiveCell.FormulaR1C1 = "(" & id1 & " - " & id2 & ")"
        
        End If
    End If

'------------------------------------------------------

If (ComboBox2 = "Exercícios Moderados") Then
    atividade = 1.55
        If (ComboBox3 = "M") Then
            SexoM = 66.5 + (13.75 * peso) + (5 * alturacm) - (6.7 * idade)
            result = SexoM * atividade
            id1 = Format(Ideal1, "0.0")
            id2 = Format(Ideal2, "0.0")
            
            Label92.Caption = IMC
            Label93.Caption = SexoM
            Label94.Caption = result
            Label95.Caption = "(" & id1 & " - " & id2 & ")"
            
            val_nome = TextBox2
    
            Sheets("CADASTRO").Select
            Range("B2").Select
            ActiveCell.FormulaR1C1 = val_nome
            
            Range("B3").Select
            ActiveCell.FormulaR1C1 = altura
            
            Range("B4").Select
            ActiveCell.FormulaR1C1 = peso
            
            Range("B5").Select
            ActiveCell.FormulaR1C1 = idade
            
            Range("B6").Select
            ActiveCell.FormulaR1C1 = "M"
            
            Range("B7").Select
            ActiveCell.FormulaR1C1 = "'--"
            
            Range("B8").Select
            ActiveCell.FormulaR1C1 = IMC
            
            Range("B9").Select
            ActiveCell.FormulaR1C1 = SexoM
            
            Range("B10").Select
            ActiveCell.FormulaR1C1 = result
            
            Range("B11").Select
            ActiveCell.FormulaR1C1 = "(" & id1 & " - " & id2 & ")"
            
        End If
 
        If (ComboBox3 = "F") Then
            SexoF = 655.1 + (9.6 * peso) + (1.85 * alturacm) - (4.7 * idade)
            result = SexoF * atividade
            id1 = Format(Ideal1, "0.0")
            id2 = Format(Ideal2, "0.0")
            
            Label92.Caption = IMC
            Label93.Caption = SexoF
            Label94.Caption = result
            Label95.Caption = "(" & id1 & " - " & id2 & ")"
        
            val_nome = TextBox2
    
            Sheets("CADASTRO").Select
            Range("B2").Select
            ActiveCell.FormulaR1C1 = val_nome
            
            Range("B3").Select
            ActiveCell.FormulaR1C1 = altura
            
            Range("B4").Select
            ActiveCell.FormulaR1C1 = peso
            
            Range("B5").Select
            ActiveCell.FormulaR1C1 = idade
            
            Range("B6").Select
            ActiveCell.FormulaR1C1 = "F"
            
            Range("B7").Select
            ActiveCell.FormulaR1C1 = "'--"
            
            Range("B8").Select
            ActiveCell.FormulaR1C1 = IMC
            
            Range("B9").Select
            ActiveCell.FormulaR1C1 = SexoF
            
            Range("B10").Select
            ActiveCell.FormulaR1C1 = result
            
            Range("B11").Select
            ActiveCell.FormulaR1C1 = "(" & id1 & " - " & id2 & ")"
        
        End If
    End If
'------------------------------------------------------

If (ComboBox2 = "Exercícios Pesados") Then
    atividade = 1.725
        If (ComboBox3 = "M") Then
            SexoM = 66.5 + (13.75 * peso) + (5 * alturacm) - (6.7 * idade)
            result = SexoM * atividade
            id1 = Format(Ideal1, "0.0")
            id2 = Format(Ideal2, "0.0")
            
            Label92.Caption = IMC
            Label93.Caption = SexoM
            Label94.Caption = result
            Label95.Caption = "(" & id1 & " - " & id2 & ")"
            
            val_nome = TextBox2
    
            Sheets("CADASTRO").Select
            Range("B2").Select
            ActiveCell.FormulaR1C1 = val_nome
            
            Range("B3").Select
            ActiveCell.FormulaR1C1 = altura
            
            Range("B4").Select
            ActiveCell.FormulaR1C1 = peso
            
            Range("B5").Select
            ActiveCell.FormulaR1C1 = idade
            
            Range("B6").Select
            ActiveCell.FormulaR1C1 = "M"
            
            Range("B7").Select
            ActiveCell.FormulaR1C1 = "'--"
            
            Range("B8").Select
            ActiveCell.FormulaR1C1 = IMC
            
            Range("B9").Select
            ActiveCell.FormulaR1C1 = SexoM
            
            Range("B10").Select
            ActiveCell.FormulaR1C1 = result
            
            Range("B11").Select
            ActiveCell.FormulaR1C1 = "(" & id1 & " - " & id2 & ")"
            
        End If
 
        If (ComboBox3 = "F") Then
            SexoF = 655.1 + (9.6 * peso) + (1.85 * alturacm) - (4.7 * idade)
            result = SexoF * atividade
            id1 = Format(Ideal1, "0.0")
            id2 = Format(Ideal2, "0.0")
            
            Label92.Caption = IMC
            Label93.Caption = SexoF
            Label94.Caption = result
            Label95.Caption = "(" & id1 & " - " & id2 & ")"
        
            val_nome = TextBox2
    
            Sheets("CADASTRO").Select
            Range("B2").Select
            ActiveCell.FormulaR1C1 = val_nome
            
            Range("B3").Select
            ActiveCell.FormulaR1C1 = altura
            
            Range("B4").Select
            ActiveCell.FormulaR1C1 = peso
            
            Range("B5").Select
            ActiveCell.FormulaR1C1 = idade
            
            Range("B6").Select
            ActiveCell.FormulaR1C1 = "F"
            
            Range("B7").Select
            ActiveCell.FormulaR1C1 = "'--"
            
            Range("B8").Select
            ActiveCell.FormulaR1C1 = IMC
            
            Range("B9").Select
            ActiveCell.FormulaR1C1 = SexoF
            
            Range("B10").Select
            ActiveCell.FormulaR1C1 = result
            
            Range("B11").Select
            ActiveCell.FormulaR1C1 = "(" & id1 & " - " & id2 & ")"
        
        End If
    End If
  
'------------------------------------------------------

If (ComboBox2 = "Exercícios muito Pesado") Then
    atividade = 1.9
        If (ComboBox3 = "M") Then
            SexoM = 66.5 + (13.75 * peso) + (5 * alturacm) - (6.7 * idade)
            result = SexoM * atividade
            id1 = Format(Ideal1, "0.0")
            id2 = Format(Ideal2, "0.0")
            
            Label92.Caption = IMC
            Label93.Caption = SexoM
            Label94.Caption = result
            Label95.Caption = "(" & id1 & " - " & id2 & ")"
            
            val_nome = TextBox2
    
            Sheets("CADASTRO").Select
            Range("B2").Select
            ActiveCell.FormulaR1C1 = val_nome
            
            Range("B3").Select
            ActiveCell.FormulaR1C1 = altura
            
            Range("B4").Select
            ActiveCell.FormulaR1C1 = peso
            
            Range("B5").Select
            ActiveCell.FormulaR1C1 = idade
            
            Range("B6").Select
            ActiveCell.FormulaR1C1 = "M"
            
            Range("B7").Select
            ActiveCell.FormulaR1C1 = "'--"
            
            Range("B8").Select
            ActiveCell.FormulaR1C1 = IMC
            
            Range("B9").Select
            ActiveCell.FormulaR1C1 = SexoM
            
            Range("B10").Select
            ActiveCell.FormulaR1C1 = result
            
            Range("B11").Select
            ActiveCell.FormulaR1C1 = "(" & id1 & " - " & id2 & ")"
            
        End If
 
        If (ComboBox3 = "F") Then
            SexoF = 655.1 + (9.6 * peso) + (1.85 * alturacm) - (4.7 * idade)
            result = SexoF * atividade
            id1 = Format(Ideal1, "0.0")
            id2 = Format(Ideal2, "0.0")
            
            Label92.Caption = IMC
            Label93.Caption = SexoF
            Label94.Caption = result
            Label95.Caption = "(" & id1 & " - " & id2 & ")"
        
            val_nome = TextBox2
    
            Sheets("CADASTRO").Select
            Range("B2").Select
            ActiveCell.FormulaR1C1 = val_nome
            
            Range("B3").Select
            ActiveCell.FormulaR1C1 = altura
            
            Range("B4").Select
            ActiveCell.FormulaR1C1 = peso
            
            Range("B5").Select
            ActiveCell.FormulaR1C1 = idade
            
            Range("B6").Select
            ActiveCell.FormulaR1C1 = "F"
            
            Range("B7").Select
            ActiveCell.FormulaR1C1 = "'--"
            
            Range("B8").Select
            ActiveCell.FormulaR1C1 = IMC
            
            Range("B9").Select
            ActiveCell.FormulaR1C1 = SexoF
            
            Range("B10").Select
            ActiveCell.FormulaR1C1 = result
            
            Range("B11").Select
            ActiveCell.FormulaR1C1 = "(" & id1 & " - " & id2 & ")"
        
        End If
    End If
'------------------------------------------------------
    Sheets("CADASTRO").Select ' Copia dados para colar em Registro
    Range("B2:C11").Select
    Selection.Copy

    Sheets("REGISTRO").Select
    Range("B1").Select
    
    Do While ActiveCell <> Empty
    ActiveCell.Offset(1, 0).Select
    Loop

    ActiveSheet.Paste
    
    Range("A1").Select
    Application.CutCopyMode = False
    '-------------------------
    Sheets("CADASTRO").Select ' Copia nome para CRIAR caixa de selação ComboBox4
    Range("B2").Select
    Selection.Copy
    
    Range("O1").Select
    Do While ActiveCell <> Empty
    ActiveCell.Offset(1, 0).Select
    Loop
    
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
 
    '-------------------------- Cria seleção
    ComboBox4.Clear
    
    linha = 1
    Do Until Planilha51.Cells(linha, 15) = ""
    ComboBox4.AddItem Planilha51.Cells(linha, 15)
    linha = linha + 1
    Loop
    
    '---------------------------- cadastra nome em alimentos
    Range("O1").Select
    
    Do While ActiveCell <> Empty
    ActiveCell.Offset(1, 0).Select
    Loop
    
    ActiveCell.Offset(-1, 0).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    nome = Cells(lin, col)

    Sheets("RELATÓRIO").Select
    Range("R2").Select

    Do While ActiveCell <> Empty
    ActiveCell.Offset(0, 4).Select
    Loop

    ActiveCell.FormulaR1C1 = nome
    
    Range("A1").Select
    Application.CutCopyMode = False

    MsgBox "CADASTRO REALIZADO COM SUCESSO!"
    
End Sub
Private Sub ToggleButton4_Click() ' Mostra análise Antropométrica
    
    Sheets("CADASTRO").Select
    vetP = TextBox6
    Range("C2").Select
    ActiveCell.FormulaR1C1 = vetP

    prot_P = TextBox7
    Range("C3").Select
    ActiveCell.FormulaR1C1 = prot_P

    glic_P = TextBox8
    Range("C4").Select
    ActiveCell.FormulaR1C1 = glic_P

    lipg_P = TextBox9
    Range("C5").Select
    ActiveCell.FormulaR1C1 = lipg_P

    '-------------------------------- grava dadaos em registro
    Range("C2:C5").Select
    Selection.Copy
    
    cliente = Label99.Caption
    
    Sheets("REGISTRO").Select
    Cells.Find(what:=cliente).Activate
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    ActiveCell.Offset(0, 1).Select
    ActiveSheet.Paste
     
    With ThisWorkbook.Worksheets("CADASTRO")
        Set cons3 = .Range("E1:L11")
        Me.ListBox3.ColumnCount = cons3.Columns.Count
        Me.ListBox3.RowSource = cons3.Address(, , , True, cons3.Parent.Range("A1"))
        'Me.ListBox3.TextAlign = fmTextAlignCenter
        Me.ListBox3.ColumnWidths = "150;60;50;35;45;30;30;20"
        Me.ListBox3.Font.Size = 10
        Me.ListBox3.Font.Name = "Verdana"
        
    End With
    
    Range("A1").Select
    
    TextBox6.Text = ""
    TextBox7.Text = ""
    TextBox8.Text = ""
    TextBox9.Text = ""
    
        
    MsgBox "DADOS CADASTRADOS COM SUCESSO!"

End Sub

Private Sub ToggleButton5_Click() ' Acessar Clientes
    
    Application.CutCopyMode = True
    Sheets("CADASTRO").Select ' Limpa área de cadastro pra se escrver outra
    Range("B2:C11").Select
    Selection.ClearContents
    Range("A1").Select
    Application.CutCopyMode = False
    
    Sheets("RELATÓRIO").Select ' Limpa área de cadastro pra se escrver outra
    Range("A2:C30").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.ClearContents
    Range("A1").Select
    Application.CutCopyMode = False

If (ComboBox4 <> "") Then
    cliente = ComboBox4
    Sheets("REGISTRO").Select ' pega informações de registro e joga em cadastro
    Cells.Find(what:=cliente).Activate
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select

    ActiveSheet.Range(Cells(lin, col), Cells(lin + 9, col + 1)).Select
    Selection.Copy

    Sheets("CADASTRO").Select
    Range("B2").Select
    ActiveSheet.Paste
    
    Range("A1").Select
    Application.CutCopyMode = False
    '----------------------------------
    
    With ThisWorkbook.Worksheets("CADASTRO") ' imprime na tela dadso cliente
        Set cli = .Range("A1:B12")
        Me.ListBox4.ColumnCount = cli.Columns.Count
        Me.ListBox4.RowSource = cli.Address(, , , True, cli.Parent.Range("A1"))
        'Me.ListBox4.TextAlign = fmTextAlignCenter
        Me.ListBox4.ColumnWidths = "80;150"
        Me.ListBox4.Font.Size = 10
        Me.ListBox4.Font.Name = "Verdana"


        'Me.ListBox1.BackColor = 250
        'Me.ListBox1.ForeColor = 350
        
    End With
    
    Sheets("RELATÓRIO").Select ' pega informações de registro e joga em cadastro
    Cells.Find(what:=cliente).Activate
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    ActiveCell.Offset(-1, 1).Select
    
    Do While ActiveCell <> Empty
    ActiveCell.Offset(1, 0).Select
    Loop
    
    ActiveCell.Offset(-1, 0).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select

    quant = lin

    Selection.End(xlUp).Select
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    ActiveSheet.Range(Cells(lin, col), Cells(quant, col + 2)).Select
    Selection.Copy

    Range("A1").Select
    ActiveSheet.Paste
    
Call Showrelatorio
End If

    Sheets("DIETA").Select
    
    Range("F1").Select
    Data = Range("F1")

    Range("G1").Select
    ActiveCell.FormulaR1C1 = "DATA: " & Data

    Range("G1").Select
    Data = Range("G1")
    Label109.Caption = Data
    Label108.Caption = "NOME: " & cliente
    
    Application.CutCopyMode = False
    Range("H1").Select

    var_global = ComboBox4
    
    Label99.Caption = var_global
    Label98.Caption = var_global
    Label128.Caption = var_global
    Label129.Caption = var_global
    
    ComboBox4.Clear
    
    linha = 1
    Do Until Planilha51.Cells(linha, 15) = ""
    ComboBox4.AddItem Planilha51.Cells(linha, 15)
    linha = linha + 1
    Loop
   
End Sub

Private Sub Showrelatorio()

Sheets("RELATÓRIO").Select
    Range("A1").Select

    Do While ActiveCell <> Empty
    ActiveCell.Offset(1, 0).Select
    Loop
    
    ActiveCell.Offset(-1, 0).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select

    quant = lin

    Selection.End(xlUp).Select

    With ThisWorkbook.Worksheets("RELATÓRIO")
        lin = ActiveCell.Row
        col = ActiveCell.Column
        Cells(lin, col).Select
        ActiveSheet.Range(Cells(lin, col), Cells(quant, col + 2)).Select

        Set ali = .Range(Cells(lin, col), Cells(lin + quant, col + 2))
        Me.ListBox5.ColumnCount = ali.Columns.Count
        Me.ListBox5.RowSource = ali.Address(, , , True, ali.Parent.Range("A1"))
        Me.ListBox5.TextAlign = fmTextAlignCenter
        Me.ListBox5.ColumnWidths = "35;140;25"
        Me.ListBox5.Font.Size = 10
        Me.ListBox5.Font.Name = "Verdana"
        
        
        Set ali2 = .Range(Cells(lin, col), Cells(lin + quant, col + 2))
        Me.ListBox2.ColumnCount = ali2.Columns.Count
        Me.ListBox2.RowSource = ali2.Address(, , , True, ali2.Parent.Range("A1"))
        Me.ListBox2.TextAlign = fmTextAlignCenter
        Me.ListBox2.ColumnWidths = "35;140;25"
        Me.ListBox2.Font.Size = 10
        Me.ListBox2.Font.Name = "Verdana"

    End With
    
        With ThisWorkbook.Worksheets("RELATÓRIO")
        lin = ActiveCell.Row
        col = ActiveCell.Column
        Cells(lin, col).Select
        ActiveSheet.Range(Cells(lin, col), Cells(quant, 15)).Select

        Set ali = .Range(Cells(lin, col), Cells(lin + quant, 15))
        Me.ListBox1.ColumnCount = ali.Columns.Count
        Me.ListBox1.RowSource = ali.Address(, , , True, ali.Parent.Range("A1"))
        Me.ListBox1.TextAlign = fmTextAlignCenter
        Me.ListBox1.ColumnWidths = "40;200;50;50;50;50;50;50;50;50;50;50;50;50;50"
        Me.ListBox1.Font.Size = 10
        Me.ListBox1.Font.Name = "Verdana"
    End With
    
    Range("A1").Select
    Application.CutCopyMode = False
    
    ListBox4.Visible = True
    Label101.Visible = True

End Sub

Private Sub ToggleButton6_Click() ' Chama aba de recadastramento

    Frame1.Visible = True
    Frame4.Visible = False
    Frame3.Visible = False
    
    MsgBox "Para que o recadastramento ocorra corretamente favor preencher todos dos campos solicitados"
    
End Sub

Private Sub ToggleButton7_Click() ' consultar dados

    With ThisWorkbook.Worksheets("CADASTRO")

        Set cons3 = .Range("E1:L11")
        Me.ListBox3.ColumnCount = cons3.Columns.Count
        Me.ListBox3.RowSource = cons3.Address(, , , True, cons3.Parent.Range("A1"))
        'Me.ListBox3.TextAlign = fmTextAlignCenter
        Me.ListBox3.ColumnWidths = "150;60;50;35;45;30;30;20"
        Me.ListBox3.Font.Size = 10
        Me.ListBox3.Font.Name = "Verdana"

    End With
    
    cliente = Label99.Caption

    Sheets("RELATÓRIO").Select
    Cells.Find(what:=cliente).Activate
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    ActiveCell.Offset(0, 1).Select
    
    Do While ActiveCell <> Empty
    ActiveCell.Offset(1, 0).Select
    Loop
    
    ActiveCell.Offset(-1, 0).Select
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    quant = lin - 1
    
    Selection.End(xlUp).Select

    With ThisWorkbook.Worksheets("RELATÓRIO")
        lin = ActiveCell.Row
        col = ActiveCell.Column
        Cells(lin, col).Select
        ActiveSheet.Range(Cells(lin, col), Cells(lin + quant, col + 2)).Select

        Set cons = .Range(Cells(lin, col), Cells(lin + quant, col + 2))
        Me.ListBox5.ColumnCount = cons.Columns.Count
        Me.ListBox5.RowSource = cons.Address(, , , True, cons.Parent.Range("A1"))
        Me.ListBox5.TextAlign = fmTextAlignCenter
        Me.ListBox5.ColumnWidths = "35;140;25"
        Me.ListBox5.Font.Size = 10
        Me.ListBox5.Font.Name = "Verdana"
        Me.ListBox5.BoundColumn = 10

    End With
    
    Range("A1").Select
    
    ListBox3.Visible = True

End Sub

Private Sub ToggleButton8_Click() ' cadastro de Alimentos

    Sheets("RELATÓRIO").Select
    Range("A1").Select
    
    Do While ActiveCell <> Empty
    ActiveCell.Offset(1, 0).Select
    Loop
    ActiveCell.Offset(-1, 0).Select
    
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    quant = lin
    
    Range("A1").Select
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    ActiveSheet.Range(Cells(lin, col), Cells(quant, col + 2)).Select
    Selection.Copy
    
    VET = Label98.Caption
    Sheets("RELATÓRIO").Select
    
    Cells.Find(what:=VET).Activate
    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin - 1, col + 1).Select

    ActiveSheet.Paste
    Application.CutCopyMode = False
    ActiveCell.Offset(1, 0).Select
    
    ' ---------------- ' printa relatórios
    With ThisWorkbook.Worksheets("RELATÓRIO")

        Range("A1").Select
        Selection.End(xlDown).Select
        lin = ActiveCell.Row
        col = ActiveCell.Column
        Cells(lin, col).Select
    
        linha = lin
    
        ActiveSheet.Range(Cells(1, 1), Cells(linha, 3)).Select
    
        Set ali = .Range(Cells(1, 1), Cells(linha, 3))
        Me.ListBox5.ColumnCount = ali.Columns.Count
        Me.ListBox5.RowSource = ali.Address(, , , True, ali.Parent.Range("A1"))
        Me.ListBox5.TextAlign = fmTextAlignCenter
        Me.ListBox5.ColumnWidths = "25;150;25"
        Me.ListBox5.Font.Size = 10
        Me.ListBox5.Font.Name = "Verdana"
        Me.ListBox5.BoundColumn = 10
    
    End With
    
        With ThisWorkbook.Worksheets("RELATÓRIO")

        Range("A1").Select
        Selection.End(xlDown).Select
        lin = ActiveCell.Row
        col = ActiveCell.Column
        Cells(lin, col).Select
    
        linha = lin
    
        ActiveSheet.Range(Cells(1, 1), Cells(linha, 15)).Select
    
        Set ali = .Range(Cells(1, 1), Cells(linha, 15))
        Me.ListBox1.ColumnCount = ali.Columns.Count
        Me.ListBox1.RowSource = ali.Address(, , , True, ali.Parent.Range("A1"))
        Me.ListBox1.TextAlign = fmTextAlignCenter
        Me.ListBox1.ColumnWidths = "50;200;50;50;50;50;50;50;50;50;50;50;50;50;50"
        Me.ListBox1.Font.Size = 10
        Me.ListBox1.Font.Name = "Verdana"
        Me.ListBox1.BoundColumn = 10
    
    End With
    
    Call ListaAlimentos

End Sub

Private Sub ToggleButton9_Click() ' Limpa campos
    TextBox2 = ""
    TextBox3 = ""
    TextBox4 = ""
    TextBox5 = ""
    Label92.Caption = ""
    Label93.Caption = ""
    Label94.Caption = ""
    Label95.Caption = ""
    
    Frame4.Visible = True
    Frame1.Visible = False
    Frame3.Visible = False
 
End Sub


Private Sub UserForm_Initialize()

Frame1.Visible = False
Frame3.Visible = False

Application.Visible = False

    ComboBox2.AddItem "Sedentário"
    ComboBox2.AddItem "Exercícios Leves"
    ComboBox2.AddItem "Exercícios Moderados"
    ComboBox2.AddItem "Exercícios Pesados"
    ComboBox2.AddItem "Exercícios muito Pesado"
    ComboBox2.AddItem ""
    ComboBox3.AddItem "M"
    ComboBox3.AddItem "F"
    ComboBox3.AddItem ""

    linha = 2
    Do Until Planilha2.Cells(linha, 2) = ""
    ComboBox1.AddItem Planilha2.Cells(linha, 2)
    linha = linha + 1
    Loop

    linha = 1
    Do Until Planilha51.Cells(linha, 15) = ""
    ComboBox4.AddItem Planilha51.Cells(linha, 15)
    linha = linha + 1
    Loop
    
    ComboBox5.AddItem "Sedentário"
    ComboBox5.AddItem "Exercícios Leves"
    ComboBox5.AddItem "Exercícios Moderados"
    ComboBox5.AddItem "Exercícios Pesados"
    ComboBox5.AddItem "Exercícios muito Pesado"
    ComboBox5.AddItem ""
    ComboBox6.AddItem "M"
    ComboBox6.AddItem "F"
    ComboBox6.AddItem ""

    ListBox4.Visible = False
    ListBox3.Visible = False

End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
If CloseMode = vbFormControlMenu Then
Cancel = True
End If
End Sub


===================================



Sub Pesquisar()

Application.ScreenUpdating = False
   
Dim arrItem() As String
Dim dados As String

Sheets("ITENS_RIDA").Select

Columns("D:D").Select
    Selection.ClearContents

Sheets("PRODUTOS_CC").Select

Columns("M:N").Select
    Selection.ClearContents

qt = Range("B" & Rows.Count).End(xlUp).Row

Sheets("ITENS_RIDA").Select
Range("B2").Select

    lin = ActiveCell.Row
    col = ActiveCell.Column
    Cells(lin, col).Select
    
    dados = Cells(lin, col)
    
    arrItem = Split(dados, " ")

    Range("D3").Select
    
    For i = 0 To UBound(arrItem)
        ActiveCell.Offset(1, 0).Select
        ActiveCell.FormulaR1C1 = arrItem(i)

    Next i
    
    Columns("D:D").Select
    Selection.Replace What:=",", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:=":", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:=")", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:=";", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="(", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="53A-", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False

    '------------------

    Columns("D:D").Select
    Selection.FormatConditions.Add Type:=xlTextString, String:="P", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 49407
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    '------------------

    Range("D1").Select
    ActiveCell.FormulaR1C1 = "Lista de Produtos"

    Columns("D:D").Select
    Selection.AutoFilter
    
    ActiveSheet.Range("D:D").AutoFilter Field:=1, Criteria1:=RGB(255, _
        192, 0), Operator:=xlFilterCellColor

    Columns("D:D").Select
    Selection.Copy
    
    Sheets("PRODUTOS_CC").Select
    Columns("M").Select
    ActiveSheet.Paste
    
    Sheets("ITENS_RIDA").Select
    Selection.AutoFilter
    Range("A1").Select
    
   '-----------------
   Sheets("PRODUTOS_CC").Select
   
    Columns("M:M").Select
    Selection.Replace What:="-A", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="-B", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="-C", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="-D", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    '--------------------
Application.ScreenUpdating = True

End Sub


Sub verifica()

Sheets("PRODUTOS_CC").Select

    col_qt = Range("M" & Rows.Count).End(xlUp).Row
    
    Range("N2").Select
    ActiveCell.FormulaR1C1 = "=IFERROR(VLOOKUP(RC[-1],C[-12],1,FALSE),""-"")"
    Range("N2").Select
    Selection.AutoFill Destination:=Range("N2:N" & col_qt & "")
    Range("N2:N419").Select
    Range("P4").Select
    


End Sub

    
'For A = 1 To qt - 1
'
'Next A


    
'For i = 0 To UBound(arrItem)
'
'    Debug.Print arrItem(i)
'
'    If arrItem(i) = "RM00001" Then
'        Debug.Print "OK"
'    End If
'
'Next i



============




Public FSO As New FileSystemObject
Sub BTO()

Dim SourceXLS, SourcePDF, LL As String
Dim Wb As Workbook
Dim Count1, Lin, Col As Integer
Dim WS_Count As Integer
Dim i As Integer
Dim lista As Variant

lista = Array("")
NOTAS = False
APPENDIX_1 = False
APPENDIX_2 = False
APPENDIX_3 = False
APPENDIX_4 = False
APPENDIX_5 = False
            
'----------------------------------------------------

LL = Range("A" & Rows.Count).End(xlUp).Row


Application.DisplayAlerts = False

            Range("I2").Select
            Lin = ActiveCell.Row
            Col = ActiveCell.Column
            Cells(Lin, Col).Select
            
            XX = Cells(Lin, Col)
            Debug.Print XX
            path_ = Len(XX)
            
            Debug.Print path_
            
Col = 1

For Lin = 2 To LL Step 1
    SourceXLS = Range("I2") & "\" & Cells(Lin, Col).Value
    SourcePDF = Range("I2") & "\" & Cells(Lin, Col + 2).Value
    doc_ = Cells(Lin, Col).Value
    documento_ = Left(doc_, Len(doc_) - 5)
    xtension = Right(doc_, 4)
    path_ = Range("I2")
    
'    Debug.Print SourceXLS
'    Debug.Print SourcePDF
'    Debug.Print doc_
'    Debug.Print documento_
'    Debug.Print xtension
'
    Set Wb = Workbooks.Open(SourceXLS)
    
Debug.Print SourceXLS
    
    '----------------------------------------------------
         WS_Count = ActiveWorkbook.Worksheets.Count

         For i = 1 To WS_Count

            ReDim Preserve lista(i - 1)
            lista(i - 1) = ActiveWorkbook.Worksheets(i).Name

            Next i
            
            cont = 0
            For A = 0 To UBound(lista)
                
                If lista(A) = "APPENDIX_1" Then
                
                    APPENDIX_1 = True
                
                End If
                
                If lista(A) = "APPENDIX_2" Then
                
                    APPENDIX_2 = True
                
                End If
                
                If lista(A) = "APPENDIX_3" Then
                
                    APPENDIX_3 = True
                
                End If
                
                If lista(A) = "APPENDIX_4" Then
                
                    APPENDIX_4 = True
                
                End If
                
                If lista(A) = "APPENDIX_5" Then
                
                    APPENDIX_5 = True
                
                End If
                
                If lista(A) = "APPENDIX_5" Then
                
                    APPENDIX_5 = True
                
                End If
                
                If lista(A) = "NOTAS" Then
                
                    NOTAS = True
                
                End If

                Debug.Print lista(A)
                cont = cont + 1

            Next A
    
   '----------------------------------------------------

    If APPENDIX_1 = True And NOTA = False Then
        Windows(documento_ & "." & xtension).Activate
        Sheets(Array("CAPA", "APPENDIX_1")).Select
    End If
    
    If APPENDIX_2 = True And NOTA = False Then
        Windows(documento_ & "." & xtension).Activate
        Sheets(Array("CAPA", "APPENDIX_1", "APPENDIX_2")).Select
    End If
    
    If APPENDIX_3 = True And NOTA = False Then
        Windows(documento_ & "." & xtension).Activate
        Sheets(Array("CAPA", "APPENDIX_1", "APPENDIX_2", "APPENDIX_3")).Select
    End If

    If APPENDIX_4 = True And NOTA = False Then
        Windows(documento_ & "." & xtension).Activate
        Sheets(Array("CAPA", "APPENDIX_1", "APPENDIX_2", "APPENDIX_3", "APPENDIX_4")).Select
    End If
    
    If APPENDIX_5 = True And NOTA = False Then
        Windows(documento_ & "." & xtension).Activate
        Sheets(Array("CAPA", "APPENDIX_1", "APPENDIX_2", "APPENDIX_3", "APPENDIX_4", "APPENDIX_5")).Select
    End If
    
    If APPENDIX_1 = True And NOTA = True Then
        Windows(documento_ & "." & xtension).Activate
        Sheets(Array("CAPA", "NOTAS", "APPENDIX_1")).Select
    End If
    
    If APPENDIX_2 = True And NOTA = True Then
        Windows(documento_ & "." & xtension).Activate
        Sheets(Array("CAPA", "NOTAS", "APPENDIX_1", "APPENDIX_2")).Select
    End If
    
    If APPENDIX_3 = True And NOTA = True Then
        Windows(documento_ & "." & xtension).Activate
        Sheets(Array("CAPA", "NOTAS", "APPENDIX_1", "APPENDIX_2", "APPENDIX_3")).Select
    End If

    If APPENDIX_4 = True And NOTA = True Then
        Windows(documento_ & "." & xtension).Activate
        Sheets(Array("CAPA", "NOTAS", "APPENDIX_1", "APPENDIX_2", "APPENDIX_3", "APPENDIX_4")).Select
    End If
    
    If APPENDIX_5 = True And NOTA = True Then
        Windows(documento_ & "." & xtension).Activate
        Sheets(Array("CAPA", "NOTAS", "APPENDIX_1", "APPENDIX_2", "APPENDIX_3", "APPENDIX_4", "APPENDIX_5")).Select
    End If

        Sheets("CAPA").Activate
        ChDir _
            path_
            Debug.Print SourcePDF
        ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _
            SourcePDF _
            , Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _
            :=False, OpenAfterPublish:=False
        Range("A1").Select

        Windows("GerarPDFs_Externo - Impressão.xlsm").Activate
        
   
    Workbooks(Wb.Name).Close
    
    NOTAS = False
    APPENDIX_1 = False
    APPENDIX_2 = False
    APPENDIX_3 = False
    APPENDIX_4 = False
    APPENDIX_5 = False

Next Lin

Application.DisplayAlerts = True

End Sub

array - listas

Sub bovo()


Dim A As Variant, B As Long, i As Long
A = Array(10, 20, 30)  ' A is a three element list by default indexed 0 to 2
B = A(2)               ' B is now 30
ReDim Preserve A(4)    ' Extend A's length to five elements
A(4) = 40              ' Set the fifth element's value
For i = LBound(A) To UBound(A)
    Debug.Print "A(" & i & ") = " & A(i)
Next i

End Sub




#-----------------------------------------
Preenche template

Sub OpenUp(ConferePasta, pasta)
 Workbooks.Open (ConferePasta)
End Sub



Sub CriaIndividualTemplate(ConferePasta, diretorio, INSP_Avalible, SBR, pasta, directory, IM_pasta, qualpasta)

        If qualpasta = 6 Then
        
            If Dir(diretorio & "\" & pasta, vbDirectory) = "" Then
    
                MkDir diretorio & "\" & pasta
    
            End If
            
            Set ws = Application.Workbooks.Add
            ActiveWorkbook.SaveAs Filename:= _
            diretorio & "\" & pasta & "\" & SBR & "_" & INSP_Avalible & ".xlsx", _
            ReadOnlyRecommended:=False, CreateBackup:=False
            
            
        Else
        
            If Dir(ConferePasta, vbDirectory) = "" Then
    
                MkDir ConferePasta
    
            End If
            
            
            If Dir(ConferePasta & pasta, vbDirectory) = "" Then
         
                MkDir ConferePasta & "\" & pasta
            
            End If
    
            Set ws = Application.Workbooks.Add
            ActiveWorkbook.SaveAs Filename:= _
            ConferePasta & "\" & pasta & "\" & SBR & "_" & INSP_Avalible & ".xlsx", _
            ReadOnlyRecommended:=False, CreateBackup:=False
        
        End If

        
End Sub


Sub FechaTemplate(SBR, INSP_Avalible, pasta, diretorio, ConferePasta, qualpasta)

    Windows(SBR & "_" & INSP_Avalible & ".xlsx").Activate
    
    Call imprimir(pasta)
    
        Sheets("Planilha1").Select
        Range("A1").Select
        ActiveWorkbook.Save
        
        If qualpasta <> 6 Then
        ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _
            ConferePasta & "\" & pasta & "\" & SBR & "_" & INSP_Avalible _
            , Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _
            :=False, OpenAfterPublish:=False
        Else
        ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _
            diretorio & "\" & pasta & "\" & SBR & "_" & INSP_Avalible _
            , Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _
            :=False, OpenAfterPublish:=False
        End If
      
        ActiveWindow.Close
             
End Sub


Sub GeraTemplate()

Application.ScreenUpdating = False
Application.StatusBar = "Expelliarmus..."

Dim ws As Workbook
Dim arrItem() As String
Dim dados As String

diretorio = Application.InputBox(prompt:="Inserir diretório onde será impresso os templates")
'FilePath = ThisWorkbook.FullName
'FileOnly = ThisWorkbook.Name
'PathOnly = Left(FilePath, Len(FilePath) - Len(FileOnly))
'diretorio = ThisWorkbook.Path

nome_usuario = Application.InputBox(prompt:="Inserir nome para sair no template")
qualpasta = MsgBox("Os arquivos pertencem ao mesmo caderno?", vbYesNo, "Template Option")

If diretorio = False Or diretorio = "" Then
    Result = MsgBox("Não foi encontrado o local onde gerar os templates! Favor especificar diretório.", vbCritical, "Atenção!")
    Exit Sub
Else

'If qualpasta = 6 Then

    SBR = Application.InputBox(prompt:="Qual SBR?")
    
    Sheets("TEMPLATE").Select
    Columns("BH:BH").Select
    Selection.Replace What:="-XX-", Replacement:="-" & SBR & "-", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
        
'End If

Call MostraCTE

directory = diretorio

'------------

Sheets("TEMPLATE").Select
Range("A1").Select

Num_Prod = Range("A" & Rows.Count).End(xlUp).Row

Range("A1").Select

For CARGA = 1 To Num_Prod - 1

Call clearTemplates
' -----------------------------
    Sheets("TEMPLATE").Select

    ActiveCell.Offset(1, 0).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    IM = Cells(Lin, Col)

    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    PM = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    comp = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    COS_ = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    REV_ = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    TIPO = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    CTC = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    CTE_1 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    CTE_2 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    '------------------------------
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    p1 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MN1 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    TM1 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MAX1 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MIN1 = Cells(Lin, Col)
   
    ActiveCell.Offset(0, 1).Select
    
    '------------------------------
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    p2 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MN2 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    TM2 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MAX2 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MIN2 = Cells(Lin, Col)
    
    '------------------------------
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
   
    P3 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MN3 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    TM3 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MAX3 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MIN3 = Cells(Lin, Col)
   
    '------------------------------
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    P4 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MN4 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    TM4 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MAX4 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MIN4 = Cells(Lin, Col)
   
    '------------------------------
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    P5 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MN5 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    TM5 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MAX5 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MIN5 = Cells(Lin, Col)
   
    '------------------------------
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    P6 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MN6 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    TM6 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MAX6 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MIN6 = Cells(Lin, Col)
   
    '------------------------------
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    P7 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MN7 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    TM7 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MAX7 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MIN7 = Cells(Lin, Col)
   
    '------------------------------
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    P8 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MN8 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    TM8 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MAX8 = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    MIN8 = Cells(Lin, Col)

    ActiveCell.Offset(0, 1).Select
    
    '---------------------------------
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select

    head = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    h_braking_type = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    h_torque = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    h_Coeff_frict = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    h_Prec_class = Cells(Lin, Col)
    
    '---------------------------------
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    foot = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    f_braking_type = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    f_torque = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    f_Coeff_frict = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 1).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    f_Prec_class = Cells(Lin, Col)
    
    '---------------------------------
    ActiveCell.Offset(0, 1).Select

    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    CC = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 2).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    nota = Cells(Lin, Col)
    
    ActiveCell.Offset(0, 2).Select
    
    Lin = ActiveCell.Row
    Col = ActiveCell.Column
    Cells(Lin, Col).Select
    
    user_ = Cells(Lin, Col)
    
    ActiveCell.Offset(0, -63).Select
    
    If nome_usuario <> "" Then
        user_ = nome_usuario
    End If
    
    SBR = Right(Left(CC, 18), 2)
    
    If SBR = 11 Then
        SBR = "53A"
    ElseIf SBR = 12 Then
        SBR = "53B"
    ElseIf SBR = 13 Then
        SBR = "53C"
    ElseIf SBR = 14 Then
        SBR = "53D"
    End If

'---------------------------------------------------------
If TIPO = "MS02" Then

    Sheets("MS02").Select
    Application.StatusBar = "Accio... (MS02)"
    
    Range("AQ1").Select
    ActiveCell.FormulaR1C1 = CTC
    
    Range("A14").Select
    ActiveCell.FormulaR1C1 = SBR

    Range("W14").Select
    ActiveCell.FormulaR1C1 = COS_ & "_" & REV_
    
    Range("AD18").Select
    ActiveCell.FormulaR1C1 = CC
    
    Range("X31").Select
    ActiveCell.FormulaR1C1 = CTE_1

    Range("X34").Select
    ActiveCell.FormulaR1C1 = CTE_2

    Range("A69").Select
    ActiveCell.FormulaR1C1 = user_
    
    Range("A76").Select
    ActiveCell.FormulaR1C1 = SBR & "-" & IM
        
    IM_pasta = IM
    INSP_Avalible = CTC
    pasta = "MS02"
    
    '-----------------------------------------------------------
    ConferePasta = diretorio & "\" & IM_pasta
    
    Call CriaIndividualTemplate(ConferePasta, diretorio, INSP_Avalible, SBR, pasta, directory, IM_pasta, qualpasta)
    '-----------------------------------------------------------
    
    Windows("Macro_Template_MS.xlsm").Activate
    Sheets("MS02").Select
    Cells.Select
    Selection.Copy
    
    Windows(SBR & "_" & INSP_Avalible & ".xlsx").Activate
    Cells.Select
    ActiveSheet.Paste
    
    '-----------------------------------------------------------
    Call FechaTemplate(SBR, INSP_Avalible, pasta, diretorio, ConferePasta, qualpasta)
    '-----------------------------------------------------------
    
    '==========================================================================================
    
    Windows("Macro_Template_MS.xlsm").Activate

    Sheets("MS02_1").Select
    Application.StatusBar = "Accio... (MS02_1)"
    
    Range("AQ1").Select
    ActiveCell.FormulaR1C1 = CTC
    
    Range("A14").Select
    ActiveCell.FormulaR1C1 = SBR

    Range("W14").Select
    ActiveCell.FormulaR1C1 = COS_ & "_" & REV_
    
    Range("AQ12").Select
    ActiveCell.FormulaR1C1 = CC
    
    Range("X31").Select
    ActiveCell.FormulaR1C1 = nota

    Range("Y48").Select
    ActiveCell.FormulaR1C1 = CTE_1

    Range("A48").Select
    ActiveCell.FormulaR1C1 = SBR & "-" & IM
    
    '------------------ MN ----------------
    Range("M155").Select
    ActiveCell.FormulaR1C1 = MN1
    
    Range("U155").Select
    ActiveCell.FormulaR1C1 = MN2
    
    Range("AC155").Select
    ActiveCell.FormulaR1C1 = MN3
    
    Range("AK155").Select
    ActiveCell.FormulaR1C1 = MN4
    
    Range("M166").Select
    ActiveCell.FormulaR1C1 = MN5
    
    Range("U166").Select
    ActiveCell.FormulaR1C1 = MN6
    
    Range("AC166").Select
    ActiveCell.FormulaR1C1 = MN7
    
    Range("AK166").Select
    ActiveCell.FormulaR1C1 = MN8
    
    '------------------ position ----------------
    
    Range("M159").Select
    ActiveCell.FormulaR1C1 = p1
    
    Range("U159").Select
    ActiveCell.FormulaR1C1 = p2
    
    Range("AC159").Select
    ActiveCell.FormulaR1C1 = P3
    
    Range("AK159").Select
    ActiveCell.FormulaR1C1 = P4
    
    Range("M170").Select
    ActiveCell.FormulaR1C1 = P5
    
    Range("U170").Select
    ActiveCell.FormulaR1C1 = P6
    
    Range("AC170").Select
    ActiveCell.FormulaR1C1 = P7
    
    Range("AK170").Select
    ActiveCell.FormulaR1C1 = P8
    
    '------------------ mountaing ----------------

    If TM1 = "W" Then
        Range("P145").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM1 = "Z" Then
        Range("P143").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
        
    If TM2 = "W" Then
        Range("X145").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM2 = "Z" Then
        Range("X143").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM3 = "W" Then
        Range("AF145").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM3 = "Z" Then
        Range("AF143").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM4 = "W" Then
        Range("AN145").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM4 = "Z" Then
        Range("AN143").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    
    '------------------------------
    If TM5 = "W" Then
        Range("P184").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM5 = "Z" Then
        Range("P182").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM6 = "W" Then
        Range("X184").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM6 = "Z" Then
        Range("X182").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
   If TM7 = "W" Then
        Range("AF184").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM7 = "Z" Then
        Range("AF182").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM8 = "W" Then
        Range("AN184").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM8 = "Z" Then
        Range("AN182").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    '------------------ record sheet ----------------
    
    arrItem_head = Split(head, "/")
    arrItem_h_braking_type = Split(h_braking_type, "/")
    arrItem_h_torque = Split(h_torque, "/")
    arrItem_h_Coeff_frict = Split(h_Coeff_frict, "/")
    arrItem_h_Prec_class = Split(h_Prec_class, "/")
    
    'record 1
    If arrItem_head(0) <> "x" Then
        Range("I218").Select
        ActiveCell.FormulaR1C1 = arrItem_head(0)
        Range("Q218").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(0)
        Range("Y218").Select
        If arrItem_h_torque(0) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(0)
        End If
        Range("AG218").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(0)
        Range("AO218").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(0)
    End If
    
    'record 2
    If arrItem_head(1) <> "x" Then
        Range("I226").Select
        ActiveCell.FormulaR1C1 = arrItem_head(1)
        Range("Q226").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(1)
        Range("Y226").Select
        If arrItem_h_torque(1) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(1)
        End If
        Range("AG226").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(1)
        Range("AO226").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(1)
    End If
    
    'record 3
    If arrItem_head(2) <> "x" Then
        Range("I234").Select
        ActiveCell.FormulaR1C1 = arrItem_head(2)
        Range("Q234").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(2)
        Range("Y234").Select
        If arrItem_h_torque(2) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(2)
        End If
        Range("AG234").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(2)
        Range("AO234").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(2)
    End If
    
    'record 4
    If arrItem_head(3) <> "x" Then
        Range("I242").Select
        ActiveCell.FormulaR1C1 = arrItem_head(3)
        Range("Q242").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(3)
        Range("Y242").Select
        If arrItem_h_torque(3) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(3)
        End If
        Range("AG242").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(3)
        Range("AO242").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(3)
    End If

    'record 5
    If arrItem_head(4) <> "x" Then
        Range("I250").Select
        ActiveCell.FormulaR1C1 = arrItem_head(4)
        Range("Q250").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(4)
        Range("Y250").Select
        If arrItem_h_torque(4) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(4)
        End If
        Range("AG250").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(4)
        Range("AO250").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(4)
    End If
    
    'record 6
    If arrItem_head(5) <> "x" Then
        Range("I258").Select
        ActiveCell.FormulaR1C1 = arrItem_head(5)
        Range("Q258").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(5)
        Range("Y258").Select
        If arrItem_h_torque(5) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(5)
        End If
        Range("AG258").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(5)
        Range("AO258").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(5)
    End If
    
    'record 7
    If arrItem_head(6) <> "x" Then
        Range("I266").Select
        ActiveCell.FormulaR1C1 = arrItem_head(6)
        Range("Q266").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(6)
        Range("Y266").Select
        If arrItem_h_torque(6) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(6)
        End If
        Range("AG266").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(6)
        Range("AO266").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(6)
    End If
    
    'record 8
    If arrItem_head(7) <> "x" Then
        Range("I274").Select
        ActiveCell.FormulaR1C1 = arrItem_head(7)
        Range("Q274").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(7)
        Range("Y274").Select
        If arrItem_h_torque(7) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(7)
        End If
        Range("AG274").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(7)
        Range("AO274").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(7)
    End If

    IM_pasta = IM
    INSP_Avalible = CTE_1
    pasta = "MS02_1"
    
    '-----------------------------------------------------------
    ConferePasta = diretorio & "\" & IM_pasta
    Call CriaIndividualTemplate(ConferePasta, diretorio, INSP_Avalible, SBR, pasta, directory, IM_pasta, qualpasta)
    '-----------------------------------------------------------
    
    Windows("Macro_Template_MS.xlsm").Activate
    Sheets("MS02_1").Select
    Cells.Select
    Selection.Copy
    
    Windows(SBR & "_" & INSP_Avalible & ".xlsx").Activate
    Cells.Select
    ActiveSheet.Paste
    
    '-----------------------------------------------------------
    Call FechaTemplate(SBR, INSP_Avalible, pasta, diretorio, ConferePasta, qualpasta)
    '-----------------------------------------------------------
    '=======================================================================================================
    
    Windows("Macro_Template_MS.xlsm").Activate

    Sheets("MS02_2").Select
    Application.StatusBar = "Accio... (MS02_2)"
    
    Range("AI1").Select
    ActiveCell.FormulaR1C1 = CTC
    
    Range("A13").Select
    ActiveCell.FormulaR1C1 = SBR

    Range("T13").Select
    ActiveCell.FormulaR1C1 = COS_ & "_" & REV_
    
    Range("AQ13").Select
    ActiveCell.FormulaR1C1 = CC
    
    Range("L32").Select
    ActiveCell.FormulaR1C1 = nota

    Range("Y49").Select
    ActiveCell.FormulaR1C1 = CTE_2

    Range("A49").Select
    ActiveCell.FormulaR1C1 = SBR & "-" & IM
    
    
    '------------------ Dados ----------------
    Range("W225").Select
    ActiveCell.FormulaR1C1 = PM
    
    Range("AS225").Select
    ActiveCell.FormulaR1C1 = comp
    

    '------------------ MN ----------------
    Range("T258").Select
    ActiveCell.FormulaR1C1 = MN1
    
    Range("AA258").Select
    ActiveCell.FormulaR1C1 = MN2
    
    Range("AH258").Select
    ActiveCell.FormulaR1C1 = MN3
    
    Range("AO258").Select
    ActiveCell.FormulaR1C1 = MN4
    
    Range("T283").Select
    ActiveCell.FormulaR1C1 = MN5
    
    Range("AA283").Select
    ActiveCell.FormulaR1C1 = MN6
    
    Range("AH283").Select
    ActiveCell.FormulaR1C1 = MN7
    
    Range("AO283").Select
    ActiveCell.FormulaR1C1 = MN8
    
    '------------------ position ----------------
    
    Range("T262").Select
    ActiveCell.FormulaR1C1 = p1
    
    Range("AA262").Select
    ActiveCell.FormulaR1C1 = p2
    
    Range("AH262").Select
    ActiveCell.FormulaR1C1 = P3
    
    Range("AO262").Select
    ActiveCell.FormulaR1C1 = P4
    
    Range("T287").Select
    ActiveCell.FormulaR1C1 = P5
    
    Range("AA287").Select
    ActiveCell.FormulaR1C1 = P6
    
    Range("AH287").Select
    ActiveCell.FormulaR1C1 = P7
    
    Range("AO287").Select
    ActiveCell.FormulaR1C1 = P8
    
    '------------------ mountaing ----------------

    If TM1 = "W" Then
        Range("T253").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM1 = "Z" Then
        Range("W249").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
        
    If TM2 = "W" Then
        Range("AA253").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM2 = "Z" Then
        Range("AD249").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM3 = "W" Then
        Range("AK253").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM3 = "Z" Then
        Range("AK249").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM4 = "W" Then
        Range("AR253").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM4 = "Z" Then
        Range("AR249").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    '------------------------------
    If TM5 = "W" Then
        Range("W278").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM5 = "Z" Then
        Range("W274").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM6 = "W" Then
        Range("AD278").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM6 = "Z" Then
        Range("AD274").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM7 = "W" Then
        Range("AK278").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM7 = "Z" Then
        Range("AK274").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM8 = "W" Then
        Range("AR278").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM8 = "Z" Then
        Range("AR274").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    '------------------ max & min ----------------
    
    Range("T265").Select
    If MIN1 <> "" Then
        ActiveCell.FormulaR1C1 = MIN1 & "/" & MAX1
    End If
    Range("AA265").Select
    If MIN2 <> "" Then
        ActiveCell.FormulaR1C1 = MIN2 & "/" & MAX2
    End If
    Range("AH265").Select
    If MIN3 <> "" Then
        ActiveCell.FormulaR1C1 = MIN3 & "/" & MAX3
    End If
    Range("AO265").Select
    If MIN4 <> "" Then
        ActiveCell.FormulaR1C1 = MIN4 & "/" & MAX4
    End If
    
    Range("T290").Select
    If MIN5 <> "" Then
        ActiveCell.FormulaR1C1 = MIN5 & "/" & MAX5
    End If
    Range("AA290").Select
    If MIN6 <> "" Then
        ActiveCell.FormulaR1C1 = MIN6 & "/" & MAX6
    End If
    Range("AH290").Select
    If MIN7 <> "" Then
        ActiveCell.FormulaR1C1 = MIN7 & "/" & MAX7
    End If
    Range("AO290").Select
    If MIN8 <> "" Then
        ActiveCell.FormulaR1C1 = MIN8 & "/" & MAX8
    End If
    
    IM_pasta = IM
    INSP_Avalible = CTE_2
    pasta = "MS02_2"
    

    '-----------------------------------------------------------
    ConferePasta = diretorio & "\" & IM_pasta
    Call CriaIndividualTemplate(ConferePasta, diretorio, INSP_Avalible, SBR, pasta, directory, IM_pasta, qualpasta)
    '-----------------------------------------------------------
    
    Windows("Macro_Template_MS.xlsm").Activate
    Sheets("MS02_2").Select
    Cells.Select
    Selection.Copy
    
    Windows(SBR & "_" & INSP_Avalible & ".xlsx").Activate
    Cells.Select
    ActiveSheet.Paste
    
    '-----------------------------------------------------------
    Call FechaTemplate(SBR, INSP_Avalible, pasta, diretorio, ConferePasta, qualpasta)
    '-----------------------------------------------------------
End If
    
'================================================ MS01 ===================================================
   
If TIPO = "MS01" Then

    Sheets("MS01").Select
    Application.StatusBar = "Accio... (MS01)"
    
    Range("AQ1").Select
    ActiveCell.FormulaR1C1 = CTC
    
    Range("A14").Select
    ActiveCell.FormulaR1C1 = SBR

    Range("W14").Select
    ActiveCell.FormulaR1C1 = COS_ & "_" & REV_
    
    Range("AD18").Select
    ActiveCell.FormulaR1C1 = CC
    
    Range("X31").Select
    ActiveCell.FormulaR1C1 = CTE_1

    Range("X34").Select
    ActiveCell.FormulaR1C1 = CTE_2

    Range("A69").Select
    ActiveCell.FormulaR1C1 = user_
    
    Range("A76").Select
    ActiveCell.FormulaR1C1 = SBR & "-" & IM
        
    IM_pasta = IM
    INSP_Avalible = CTC
    pasta = "MS01"
    
    '-----------------------------------------------------------
    ConferePasta = diretorio & "\" & IM_pasta
    Call CriaIndividualTemplate(ConferePasta, diretorio, INSP_Avalible, SBR, pasta, directory, IM_pasta, qualpasta)
    '-----------------------------------------------------------
    
    Windows("Macro_Template_MS.xlsm").Activate
    Sheets("MS01").Select
    Cells.Select
    Selection.Copy
    
    Windows(SBR & "_" & INSP_Avalible & ".xlsx").Activate
    Cells.Select
    ActiveSheet.Paste
    
    '-----------------------------------------------------------
    Call FechaTemplate(SBR, INSP_Avalible, pasta, diretorio, ConferePasta, qualpasta)
    '-----------------------------------------------------------
    
    '==========================================================================================
    
    Windows("Macro_Template_MS.xlsm").Activate

    Sheets("MS01_2").Select
    Application.StatusBar = "Accio... (MS01_2)"
    
    Range("AQ1").Select
    ActiveCell.FormulaR1C1 = CTC
    
    Range("A14").Select
    ActiveCell.FormulaR1C1 = SBR

    Range("W14").Select
    ActiveCell.FormulaR1C1 = COS_ & "_" & REV_
    
    Range("AQ13").Select
    ActiveCell.FormulaR1C1 = CC
    
    Range("L32").Select
    ActiveCell.FormulaR1C1 = nota

    Range("Y49").Select
    ActiveCell.FormulaR1C1 = CTE_2

    Range("A49").Select
    ActiveCell.FormulaR1C1 = SBR & "-" & IM
    
    '------------------ MN ----------------
    Range("M155").Select
    ActiveCell.FormulaR1C1 = MN1
    
    Range("U155").Select
    ActiveCell.FormulaR1C1 = MN2
    
    Range("AC155").Select
    ActiveCell.FormulaR1C1 = MN3
    
    Range("AK155").Select
    ActiveCell.FormulaR1C1 = MN4
    
    Range("M166").Select
    ActiveCell.FormulaR1C1 = MN5
    
    Range("U166").Select
    ActiveCell.FormulaR1C1 = MN6
    
    Range("AC166").Select
    ActiveCell.FormulaR1C1 = MN7
    
    Range("AK166").Select
    ActiveCell.FormulaR1C1 = MN8
    
    '------------------ position ----------------
    
    Range("M159").Select
    ActiveCell.FormulaR1C1 = p1
    
    Range("U159").Select
    ActiveCell.FormulaR1C1 = p2
    
    Range("AC159").Select
    ActiveCell.FormulaR1C1 = P3
    
    Range("AK159").Select
    ActiveCell.FormulaR1C1 = P4
    
    Range("M170").Select
    ActiveCell.FormulaR1C1 = P5
    
    Range("U170").Select
    ActiveCell.FormulaR1C1 = P6
    
    Range("AC170").Select
    ActiveCell.FormulaR1C1 = P7
    
    Range("AK170").Select
    ActiveCell.FormulaR1C1 = P8
    
    '------------------ mountaing ----------------

    If TM1 = "W" Then
        Range("P145").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM1 = "Z" Then
        Range("P143").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
        
    If TM2 = "W" Then
        Range("X145").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM2 = "Z" Then
        Range("X143").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM3 = "W" Then
        Range("AF145").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM3 = "Z" Then
        Range("AF143").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM4 = "W" Then
        Range("AN145").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM4 = "Z" Then
        Range("AN143").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    
    '------------------------------
    If TM5 = "W" Then
        Range("P184").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM5 = "Z" Then
        Range("P182").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM6 = "W" Then
        Range("X184").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM6 = "Z" Then
        Range("X182").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
   If TM7 = "W" Then
        Range("AF184").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM7 = "Z" Then
        Range("AF182").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM8 = "W" Then
        Range("AN184").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM8 = "Z" Then
        Range("AN182").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    '------------------ record sheet ----------------
    
    arrItem_head = Split(head, "/")
    arrItem_h_braking_type = Split(h_braking_type, "/")
    arrItem_h_torque = Split(h_torque, "/")
    arrItem_h_Coeff_frict = Split(h_Coeff_frict, "/")
    arrItem_h_Prec_class = Split(h_Prec_class, "/")
    
    arrItem_foot = Split(foot, "/")
    arrItem_f_braking_type = Split(f_braking_type, "/")
    arrItem_f_torque = Split(f_torque, "/")
    arrItem_f_Coeff_frict = Split(f_Coeff_frict, "/")
    arrItem_f_Prec_class = Split(f_Prec_class, "/")
    
    'record 1
    If arrItem_head(0) <> "x" Then
        Range("I219").Select
        ActiveCell.FormulaR1C1 = arrItem_head(0)
        Range("Q219").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(0)
        Range("Y219").Select
        If arrItem_h_torque(0) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(0)
        End If
        Range("AG219").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(0)
        Range("AO219").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(0)
    End If
    
    If arrItem_foot(0) <> "x" Then
        Range("I223").Select
        ActiveCell.FormulaR1C1 = arrItem_foot(0)
        Range("Q223").Select
        ActiveCell.FormulaR1C1 = arrItem_f_braking_type(0)
        Range("Y223").Select
        If arrItem_f_torque(0) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_f_torque(0)
        End If
        Range("AG223").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Coeff_frict(0)
        Range("AO223").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Prec_class(0)
    End If
    
    'record 2
    If arrItem_head(1) <> "x" Then
        Range("I227").Select
        ActiveCell.FormulaR1C1 = arrItem_head(1)
        Range("Q227").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(1)
        Range("Y227").Select
        If arrItem_h_torque(1) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(1)
        End If
        Range("AG227").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(1)
        Range("AO227").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(1)
    End If
    
    If arrItem_foot(1) <> "x" Then
        Range("I231").Select
        ActiveCell.FormulaR1C1 = arrItem_foot(1)
        Range("Q231").Select
        ActiveCell.FormulaR1C1 = arrItem_f_braking_type(1)
        Range("Y231").Select
        If arrItem_h_torque(1) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_f_torque(1)
        End If
        Range("AG231").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Coeff_frict(1)
        Range("AO231").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Prec_class(1)
    End If
    
    'record 3
    If arrItem_head(2) <> "x" Then
        Range("I235").Select
        ActiveCell.FormulaR1C1 = arrItem_head(2)
        Range("Q235").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(2)
        Range("Y235").Select
        If arrItem_h_torque(2) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(2)
        End If
        Range("AG235").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(2)
        Range("AO235").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(2)
    End If
    
    If arrItem_foot(2) <> "x" Then
        Range("I239").Select
        ActiveCell.FormulaR1C1 = arrItem_foot(2)
        Range("Q239").Select
        ActiveCell.FormulaR1C1 = arrItem_f_braking_type(2)
        Range("Y239").Select
        If arrItem_h_torque(2) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_f_torque(2)
        End If
        Range("AG239").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Coeff_frict(2)
        Range("AO239").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Prec_class(2)
    End If
    
    'record 4
    If arrItem_head(3) <> "x" Then
        Range("I243").Select
        ActiveCell.FormulaR1C1 = arrItem_head(3)
        Range("Q243").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(3)
        Range("Y243").Select
        If arrItem_h_torque(3) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(3)
        End If
        Range("AG243").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(3)
        Range("AO243").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(3)
    End If
    If arrItem_foot(3) <> "x" Then
        Range("I247").Select
        ActiveCell.FormulaR1C1 = arrItem_foot(3)
        Range("Q247").Select
        ActiveCell.FormulaR1C1 = arrItem_f_braking_type(3)
        Range("Y247").Select
        If arrItem_h_torque(3) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_f_torque(3)
        End If
        Range("AG247").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Coeff_frict(3)
        Range("AO247").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Prec_class(3)
    End If
    
    'record 5
    If arrItem_head(4) <> "x" Then
        Range("I251").Select
        ActiveCell.FormulaR1C1 = arrItem_head(4)
        Range("Q251").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(4)
        Range("Y251").Select
        If arrItem_h_torque(4) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(4)
        End If
        Range("AG251").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(4)
        Range("AO251").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(4)
    End If
    If arrItem_foot(4) <> "x" Then
        Range("I255").Select
        ActiveCell.FormulaR1C1 = arrItem_foot(4)
        Range("Q255").Select
        ActiveCell.FormulaR1C1 = arrItem_f_braking_type(4)
        Range("Y255").Select
        If arrItem_h_torque(4) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_f_torque(4)
        End If
        Range("AG255").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Coeff_frict(4)
        Range("AO255").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Prec_class(4)
    End If
    
    'record 6
    If arrItem_head(5) <> "x" Then
        Range("I259").Select
        ActiveCell.FormulaR1C1 = arrItem_head(5)
        Range("Q259").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(5)
        Range("Y259").Select
        If arrItem_h_torque(5) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(5)
        End If
        Range("AG259").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(5)
        Range("AO259").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(5)
    End If
    If arrItem_foot(5) <> "x" Then
        Range("I263").Select
        ActiveCell.FormulaR1C1 = arrItem_foot(5)
        Range("Q263").Select
        ActiveCell.FormulaR1C1 = arrItem_f_braking_type(5)
        Range("Y263").Select
        If arrItem_h_torque(5) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_f_torque(5)
        End If
        Range("AG263").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Coeff_frict(5)
        Range("AO263").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Prec_class(5)
    End If
    
    'record 7
    If arrItem_head(6) <> "x" Then
        Range("I267").Select
        ActiveCell.FormulaR1C1 = arrItem_head(6)
        Range("Q267").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(6)
        Range("Y267").Select
        If arrItem_h_torque(6) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(6)
        End If
        Range("AG267").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(6)
        Range("AO267").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(6)
    End If
    If arrItem_foot(6) <> "x" Then
        Range("I271").Select
        ActiveCell.FormulaR1C1 = arrItem_foot(6)
        Range("Q271").Select
        ActiveCell.FormulaR1C1 = arrItem_f_braking_type(6)
        Range("Y271").Select
        If arrItem_h_torque(6) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_f_torque(6)
        End If
        Range("AG271").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Coeff_frict(6)
        Range("AO271").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Prec_class(6)
    End If
    
    'record 8
    If arrItem_head(7) <> "x" Then
        Range("I275").Select
        ActiveCell.FormulaR1C1 = arrItem_head(7)
        Range("Q275").Select
        ActiveCell.FormulaR1C1 = arrItem_h_braking_type(7)
        Range("Y275").Select
        If arrItem_h_torque(7) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_h_torque(7)
        End If
        Range("AG275").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Coeff_frict(7)
        Range("AO275").Select
        ActiveCell.FormulaR1C1 = arrItem_h_Prec_class(7)
    End If

    If arrItem_foot(7) <> "x" Then
        Range("I279").Select
        ActiveCell.FormulaR1C1 = arrItem_foot(7)
        Range("Q279").Select
        ActiveCell.FormulaR1C1 = arrItem_f_braking_type(7)
        Range("Y279").Select
        If arrItem_h_torque(7) = "A" Then
            ActiveCell.FormulaR1C1 = "Aperto a mão mais 1/4 de volta (ver nota)"
        Else
            ActiveCell.FormulaR1C1 = arrItem_f_torque(7)
        End If
        Range("AG279").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Coeff_frict(7)
        Range("AO279").Select
        ActiveCell.FormulaR1C1 = arrItem_f_Prec_class(7)
    End If

    IM_pasta = IM
    INSP_Avalible = CTE_2
    pasta = "MS01_2"
    
    '-----------------------------------------------------------
    ConferePasta = diretorio & "\" & IM_pasta
    Call CriaIndividualTemplate(ConferePasta, diretorio, INSP_Avalible, SBR, pasta, directory, IM_pasta, qualpasta)
    '-----------------------------------------------------------
    
    Windows("Macro_Template_MS.xlsm").Activate
    Sheets("MS01_2").Select
    Cells.Select
    Selection.Copy
    
    Windows(SBR & "_" & INSP_Avalible & ".xlsx").Activate
    Cells.Select
    ActiveSheet.Paste
    
    '-----------------------------------------------------------
    Call FechaTemplate(SBR, INSP_Avalible, pasta, diretorio, ConferePasta, qualpasta)
    '-----------------------------------------------------------
    '=======================================================================================================
    
    Windows("Macro_Template_MS.xlsm").Activate

    Sheets("MS01_1").Select
    Application.StatusBar = "Accio... (MS02_1)"
    
    Range("AI1").Select
    ActiveCell.FormulaR1C1 = CTC
    
    Range("A13").Select
    ActiveCell.FormulaR1C1 = SBR

    Range("T13").Select
    ActiveCell.FormulaR1C1 = COS_ & "_" & REV_
    
    Range("AQ13").Select
    ActiveCell.FormulaR1C1 = CC
    
    Range("L32").Select
    ActiveCell.FormulaR1C1 = nota

    Range("Y49").Select
    ActiveCell.FormulaR1C1 = CTE_1

    Range("A49").Select
    ActiveCell.FormulaR1C1 = SBR & "-" & IM
    
    
    '------------------ Dados ----------------
    Range("W225").Select
    ActiveCell.FormulaR1C1 = PM
    
    Range("AS225").Select
    ActiveCell.FormulaR1C1 = comp
    

    '------------------ MN ----------------
    Range("T256").Select
    ActiveCell.FormulaR1C1 = MN1
    
    Range("AA256").Select
    ActiveCell.FormulaR1C1 = MN2
    
    Range("AH256").Select
    ActiveCell.FormulaR1C1 = MN3
    
    Range("AO256").Select
    ActiveCell.FormulaR1C1 = MN4
    
    Range("T289").Select
    ActiveCell.FormulaR1C1 = MN5
    
    Range("AA289").Select
    ActiveCell.FormulaR1C1 = MN6
    
    Range("AH289").Select
    ActiveCell.FormulaR1C1 = MN7
    
    Range("AO289").Select
    ActiveCell.FormulaR1C1 = MN8
    
    '------------------ position ----------------
    
    Range("T262").Select
    ActiveCell.FormulaR1C1 = p1
    
    Range("AA262").Select
    ActiveCell.FormulaR1C1 = p2
    
    Range("AH262").Select
    ActiveCell.FormulaR1C1 = P3
    
    Range("AO262").Select
    ActiveCell.FormulaR1C1 = P4
    
    Range("T293").Select
    ActiveCell.FormulaR1C1 = P5
    
    Range("AA293").Select
    ActiveCell.FormulaR1C1 = P6
    
    Range("AH293").Select
    ActiveCell.FormulaR1C1 = P7
    
    Range("AO293").Select
    ActiveCell.FormulaR1C1 = P8
    
    '------------------ mountaing ----------------

    If TM1 = "W" Then
        Range("T253").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM1 = "Z" Then
        Range("W249").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
        
    If TM2 = "W" Then
        Range("AA253").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM2 = "Z" Then
        Range("AD249").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM3 = "W" Then
        Range("AK253").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM3 = "Z" Then
        Range("AK249").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM4 = "W" Then
        Range("AR253").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM4 = "Z" Then
        Range("AR249").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    '------------------------------
    If TM5 = "W" Then
        Range("W284").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM5 = "Z" Then
        Range("W280").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM6 = "W" Then
        Range("AD284").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM6 = "Z" Then
        Range("AD280").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM7 = "W" Then
        Range("AK284").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM7 = "Z" Then
        Range("AK280").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    If TM8 = "W" Then
        Range("AR284").Select
        ActiveCell.FormulaR1C1 = "X"
    ElseIf TM8 = "Z" Then
        Range("AR280").Select
        ActiveCell.FormulaR1C1 = "X"
    End If
    
    '------------------ max & min ----------------
    
    arrItem_max1 = Split(MAX1, "/")
    arrItem_max2 = Split(MAX2, "/")
    arrItem_max3 = Split(MAX3, "/")
    arrItem_max4 = Split(MAX4, "/")
    arrItem_max5 = Split(MAX5, "/")
    arrItem_max6 = Split(MAX6, "/")
    arrItem_max7 = Split(MAX7, "/")
    arrItem_max8 = Split(MAX8, "/")
    
    
    Range("T269").Select
    If MIN1 <> "" Then
        ActiveCell.FormulaR1C1 = arrItem_max1(0)
        Range("T272").Select
        ActiveCell.FormulaR1C1 = MIN1
        Range("T263").Select
        If arrItem_max1(1) <> "x" Then
            ActiveCell.FormulaR1C1 = arrItem_max1(1)
        End If
    End If
    Range("AA269").Select
    If MIN2 <> "" Then
        ActiveCell.FormulaR1C1 = arrItem_max2(0)
        Range("AA272").Select
        ActiveCell.FormulaR1C1 = MIN2
        Range("AA263").Select
        If arrItem_max2(1) <> "x" Then
            ActiveCell.FormulaR1C1 = arrItem_max2(1)
        End If
    End If
    Range("AH269").Select
    If MIN3 <> "" Then
        ActiveCell.FormulaR1C1 = arrItem_max3(0)
        Range("AH272").Select
        ActiveCell.FormulaR1C1 = MIN3
        Range("AH263").Select
        If arrItem_max3(1) <> "x" Then
            ActiveCell.FormulaR1C1 = arrItem_max3(1)
        End If
    End If
    Range("AO269").Select
    If MIN4 <> "" Then
        ActiveCell.FormulaR1C1 = arrItem_max4(0)
        Range("AO272").Select
        ActiveCell.FormulaR1C1 = MIN4
        Range("AO263").Select
        If arrItem_max4(1) <> "x" Then
            ActiveCell.FormulaR1C1 = arrItem_max4(1)
        End If
    End If
    
    Range("T302").Select
    If MIN5 <> "" Then
        ActiveCell.FormulaR1C1 = arrItem_max5(0)
        Range("T305").Select
        ActiveCell.FormulaR1C1 = MIN5
        Range("T296").Select
        If arrItem_max5(1) <> "x" Then
            ActiveCell.FormulaR1C1 = arrItem_max5(1)
        End If
    End If
    Range("AA302").Select
    If MIN6 <> "" Then
        ActiveCell.FormulaR1C1 = arrItem_max6(0)
        Range("AA305").Select
        ActiveCell.FormulaR1C1 = MIN6
        Range("AA296").Select
        If arrItem_max6(1) <> "x" Then
            ActiveCell.FormulaR1C1 = arrItem_max6(1)
        End If
    End If
    Range("AH302").Select
    If MIN7 <> "" Then
        ActiveCell.FormulaR1C1 = arrItem_max7(0)
        Range("AH305").Select
        ActiveCell.FormulaR1C1 = MIN7
        Range("AH296").Select
        If arrItem_max7(1) <> "x" Then
            ActiveCell.FormulaR1C1 = arrItem_max7(1)
        End If
    End If
    Range("AO302").Select
    If MIN8 <> "" Then
        ActiveCell.FormulaR1C1 = arrItem_max8(0)
        Range("AO305").Select
        ActiveCell.FormulaR1C1 = MIN8
        Range("AO296").Select
        If arrItem_max8(1) <> "x" Then
            ActiveCell.FormulaR1C1 = arrItem_max8(1)
        End If
    End If
    
    IM_pasta = IM
    INSP_Avalible = CTE_1
    pasta = "MS01_1"
    

    '-----------------------------------------------------------
    ConferePasta = diretorio & "\" & IM_pasta
    Call CriaIndividualTemplate(ConferePasta, diretorio, INSP_Avalible, SBR, pasta, directory, IM_pasta, qualpasta)
    '-----------------------------------------------------------
    
    Windows("Macro_Template_MS.xlsm").Activate
    Sheets("MS01_1").Select
    Cells.Select
    Selection.Copy
    
    Windows(SBR & "_" & INSP_Avalible & ".xlsx").Activate
    Cells.Select
    ActiveSheet.Paste
    
    '-----------------------------------------------------------
    Call FechaTemplate(SBR, INSP_Avalible, pasta, diretorio, ConferePasta, qualpasta)
    '-----------------------------------------------------------
    
End If
      
      
Next CARGA
 
Call EscondeCTE

'UserForm1.Hide

MsgBox "Tarefa Realizada Com Sucesso!"

End If


If nome_usuario = "" Then
    MsgBox "Não foi identificado nome de usuário. Verifique se está correto"
Else
    MsgBox "Templates foram gerados com o nome: " & nome_usuario & ", para o CC: " & CC
End If

Sheets("TEMPLATE").Select
Range("A1").Select

Application.ScreenUpdating = True

End Sub

Private Sub CommandButton6_Click()

Call Clear

End Sub


Private Sub Label7_Click()

MsgBox "ATENÇÃO! Antes de tranferir arquivos certifique-se que a PLANILHA_IMPORTACAO_CTE e PLANILHA_IMPORTACAO_PRODUTO, ferente ao seu caderno, estão abertas."

End Sub

Private Sub TextBox1_Change()

End Sub

